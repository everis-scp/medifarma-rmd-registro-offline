/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../utils/TableUtils","../library","sap/ui/base/Object","sap/ui/Device","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery"],function(T,l,B,D,K,q){"use strict";var C=T.CELLTYPE;var S=l.SelectionMode;var M={CTRL:1,SHIFT:2,ALT:4};var H=5;var a="1rem";function p(i,P){i.setMarked("sapUiTableSkipItemNavigation",P!==false);}var b=B.extend("sap.ui.table.extensions.KeyboardDelegate",{constructor:function(i){B.call(this);},destroy:function(){B.prototype.destroy.apply(this,arguments);},getInterface:function(){return this;}});function n(i,F){if(!e(i,F)){return;}var G=T.getCellInfo(T.getCell(i,F.target));if(G.isOfType(C.ANYCOLUMNHEADER)){_(i,G,F);}else if(G.isOfType(C.ANYCONTENTCELL)){c(i,G,F);}}function _(i,F,G){var I=T.getHeaderRowCount(i);if(T.isNoDataVisible(i)){var J=T.getFocusedItemInfo(i);if(J.row-I<=1){p(G);}}else if(F.isOfType(C.COLUMNROWHEADER)&&I>1){p(G);T.focusItem(i,I*(T.getVisibleColumnCount(i)+1),G);}}function c(i,F,G){var I=i._getKeyboardExtension();var J=I.isInActionMode();var L=b._isKeyCombination(G,null,M.CTRL);var N=L||J;var P=T.getParentCell(i,G.target);if(!N&&P){P.trigger("focus");return;}p(G);if(T.isLastScrollableRow(i,F.cell)){var O=s(i,G);if(O){G.preventDefault();return;}}if(F.rowIndex===i.getRows().length-1){if(!J&&P){P.trigger("focus");}else{var Q=i.getCreationRow();if(!Q||!Q._takeOverKeyboardHandling(G)){I.setActionMode(false);}}return;}z(i,F.type,F.rowIndex+1,F.columnIndex,N);G.preventDefault();}function d(i,F){var G=T.getCellInfo(T.getCell(i,F.target));if(!G.isOfType(C.ANYCONTENTCELL)||!e(i,F)){return;}var I=b._isKeyCombination(F,null,M.CTRL);var J=i._getKeyboardExtension();var L=J.isInActionMode();var N=I||L;var P=T.getParentCell(i,F.target);if(!N&&P){P.trigger("focus");return;}p(F);if(T.isFirstScrollableRow(i,G.cell)){var O=g(i,F);if(O){F.preventDefault();return;}}if(G.rowIndex===0){p(F,G.isOfType(C.ROWACTION)||N);if(!L&&P){P.trigger("focus");}else{J.setActionMode(false);}return;}z(i,G.type,G.rowIndex-1,G.columnIndex,N);F.preventDefault();}function e(i,F){var G=b._isKeyCombination(F,null,M.CTRL);return!F.isMarked()&&(G||!(F.target instanceof window.HTMLInputElement)&&!(F.target instanceof window.HTMLTextAreaElement));}function f(i,F){if(F.isMarked()){return;}var G=T.getCellInfo(T.getCell(i,F.target));var I=sap.ui.getCore().getConfiguration().getRTL();if(!G.isOfType(C.COLUMNHEADER)||!I){return;}var J=T.getFocusedItemInfo(i);var L=J.cellInRow-(T.hasRowHeader(i)?1:0);var N=T.getVisibleColumnCount(i);if(T.hasRowActions(i)&&L===N-1){p(F);}}function s(i,F,P,G){var I=i._getFirstRenderedRowIndex()===i._getMaxFirstRenderedRowIndex();if(I){return null;}h(i,F,true,P,G);return true;}function g(i,F,P,G){var I=i._getFirstRenderedRowIndex()===0;if(I){return false;}h(i,F,false,P,G);return true;}function h(i,F,G,P,I){var J=T.getCellInfo(T.getCell(i,F.target));var L=i._getKeyboardExtension().isInActionMode();var N=b._isKeyCombination(F,null,M.CTRL);var O=N||L;var Q=L&&J.isOfType(C.DATACELL);if(Q){i._getKeyboardExtension()._setSilentFocus(i.getDomRef("focusDummy"));setTimeout(function(){i._getScrollExtension().scrollVertically(G===true,P);},0);}else{i._getScrollExtension().scrollVertically(G===true,P);}if(O||I){i.attachEventOnce("rowsUpdated",function(){if(I){I();}else{z(i,J.type,J.rowIndex,J.columnIndex,true);}});}}function j(i,F){var R=i._getRowCounts();var G=s(i,F,false,function(){k(i,R.fixedTop+R.scrollable-1);});if(G){return;}if(R.fixedBottom>0){k(i,R.fixedTop+R.scrollable);}else{i._getKeyboardExtension().setActionMode(false);}}function k(i,R){var F=i.getRows()[R];var G=F.isGroupHeader()||T.isRowSelectorSelectionAllowed(i);if(G){z(i,C.ROWHEADER,R);}else{var I=b._getFirstInteractiveElement(F);if(I){b._focusElement(i,I[0]);}else{z(i,C.DATACELL,R,0,false,true);if(F.getIndex()===i._getTotalRowCount()-1){i._getKeyboardExtension().setActionMode(false);}}}}function m(i,F){var R=i._getRowCounts();var G=g(i,F,false,function(){o(i,R.fixedTop);});if(G){return;}if(R.fixedTop>0){o(i,R.fixedTop-1);}else{i._getKeyboardExtension().setActionMode(false);}}function o(i,R){var F=i.getRows()[R];var G=F.isGroupHeader()||T.isRowSelectorSelectionAllowed(i);var I=b._getLastInteractiveElement(F);if(I){b._focusElement(i,I[0]);}else if(G){z(i,C.ROWHEADER,R);}else{z(i,C.DATACELL,R,0,false,true);if(F.getIndex()===0){i._getKeyboardExtension().setActionMode(false);}}}function r(i,F){var G=T.getFocusedItemInfo(i);var L=i._getKeyboardExtension()._getLastFocusedCellInfo();T.focusItem(i,G.cellInRow+(G.columnCount*L.row),F);}function t(i,F){var G=T.getFocusedItemInfo(i);T.focusItem(i,G.cellInRow,F);}function u(i,F){i._getKeyboardExtension()._setSilentFocus(i.$().find("."+F));}b._isKeyCombination=function(i,F,G){if(G==null){G=0;}var I=typeof F==="string"?String.fromCharCode(i.charCode):i.keyCode;var J=0;J|=(D.os.macintosh?i.metaKey:i.ctrlKey)&&F!==K.CONTROL?M.CTRL:0;J|=i.shiftKey&&F!==K.SHIFT?M.SHIFT:0;J|=i.altKey&&F!==K.ALT?M.ALT:0;var V=F==null||I===F;var L=G===J;return V&&L;};function v(i,F){var $=T.getCell(i,F);var G=T.getCellInfo($);return i.getRows()[G.rowIndex];}function w(i,F){var G=T.getCellInfo(F.target);if(G.isOfType(C.COLUMNROWHEADER)){i._getSelectionPlugin().onHeaderSelectorPress();}else if(b._allowsToggleExpandedState(i,F.target)){v(i,F.target).toggleExpandedState();}else if(G.isOfType(C.ROWHEADER)){J();}else if(G.isOfType(C.DATACELL|C.ROWACTION)){var I=!i.hasListeners("cellClick");if(!i._findAndfireCellEvent(i.fireCellClick,F)){if(T.isRowSelectionAllowed(i)){J();I=false;}}if(I){var $=T.getInteractiveElements(F.target);if($){i._getKeyboardExtension().setActionMode(true);}}}function J(){var L=null;if(i._legacyMultiSelection){L=function(R){i._legacyMultiSelection(R,F);return true;};}T.toggleRowSelection(i,F.target,null,L);}}function x(i,N){var F=i.getParent();var V=F._getVisibleColumns();var I=V.indexOf(i);var G;if(N&&I<V.length-1){G=F.indexOfColumn(V[I+1])+1;}else if(!N&&I>0){G=F.indexOfColumn(V[I-1]);}if(G!=null){T.Column.moveColumnTo(i,G);}}function y(F,G){var V=F.getColumns().filter(function(G){return G.getVisible()||G.getGrouped();});for(var i=0;i<V.length;i++){var I=V[i];if(I===G){return i;}}return-1;}b._focusElement=function(i,F,G){if(!i||!F){return;}if(G==null){G=false;}T.deselectElementText(document.activeElement);if(G){i._getKeyboardExtension()._setSilentFocus(F);}else{F.focus();}T.selectElementText(F);};function z(i,F,R,G,I,J){if(!i||F==null||R==null||R<0||R>=i.getRows().length){return;}var L=i.getRows()[R];var N;if(F===C.ROWHEADER){i._getKeyboardExtension()._setFocus(i.getDomRef("rowsel"+R));return;}else if(F===C.ROWACTION){N=i.getDomRef("rowact"+R);}else if(F===C.DATACELL&&(G!=null&&G>=0)){var O=i.getColumns()[G];var P=y(i,O);if(P>=0){N=L.getDomRef("col"+P);}}if(!N){return;}if(I){var $=T.getInteractiveElements(N);if($){b._focusElement(i,$[0]);return;}}if(J){i._getKeyboardExtension()._bStayInActionMode=true;}N.focus();}function A(i){return i.classList.contains("sapUiTableTreeIconNodeOpen")||i.classList.contains("sapUiTableTreeIconNodeClosed");}b._allowsToggleExpandedState=function(i,F){return T.Grouping.isInGroupHeaderRow(F)||(T.Grouping.isInTreeMode(i)&&F.classList.contains("sapUiTableCellFirst")&&(F.querySelector(".sapUiTableTreeIconNodeOpen")||F.querySelector(".sapUiTableTreeIconNodeClosed")))||A(F);};b._isElementInteractive=function(i){if(!i){return false;}return q(i).is(T.INTERACTIVE_ELEMENT_SELECTORS);};b._getFirstInteractiveElement=function(R){var i=T.getFirstInteractiveElement(R,true);if(!i){return null;}return q(i);};b._getLastInteractiveElement=function(R){if(!R){return null;}var F=R.getParent();var G=R.getCells();var $;var I;if(T.hasRowActions(F)){G.push(R.getRowAction());}for(var i=G.length-1;i>=0;i--){$=T.getParentCell(F,G[i].getDomRef());I=T.getInteractiveElements($);if(I){return I.last();}}return null;};b._getPreviousInteractiveElement=function(F,G){if(!F||!G){return null;}var $=q(G);if(!this._isElementInteractive($)){return null;}var I=T.getParentCell(F,G);var J;var L;var N;var O;var P;var Q;var R;J=T.getInteractiveElements(I);if(J[0]!==$[0]){return J.eq(J.index(G)-1);}L=T.getCellInfo(I);O=F.getRows()[L.rowIndex].getCells();if(L.isOfType(C.ROWACTION)){R=O.length-1;}else{P=F.getColumns()[L.columnIndex];Q=y(F,P);R=Q-1;}for(var i=R;i>=0;i--){N=O[i].getDomRef();I=T.getParentCell(F,N);J=T.getInteractiveElements(I);if(J){return J.last();}}return null;};b._getNextInteractiveElement=function(F,G){if(!F||!G){return null;}var $=q(G);if(!this._isElementInteractive($)){return null;}var I=T.getParentCell(F,G);var J;var L;var N;var O;var P;var R;var Q;J=T.getInteractiveElements(I);if(J.get(-1)!==$[0]){return J.eq(J.index(G)+1);}L=T.getCellInfo(I);if(L.isOfType(C.ROWACTION)){return null;}R=F.getRows()[L.rowIndex];O=R.getCells();P=F.getColumns()[L.columnIndex];Q=y(F,P);for(var i=Q+1;i<O.length;i++){N=O[i].getDomRef();I=T.getParentCell(F,N);J=T.getInteractiveElements(I);if(J){return J.first();}}if(T.hasRowActions(F)){I=T.getParentCell(F,R.getRowAction().getDomRef());J=T.getInteractiveElements(I);if(J.get(-1)!==$[0]){return J.eq(J.index(G)+1);}}return null;};function E(i){var F=T.getRowIndexOfFocusedCell(i);var G=i.getRows()[F].getIndex();var I=i._getSelectionPlugin();i._oRangeSelection={startIndex:G,selected:I.isIndexSelected(G)};}b.prototype.enterActionMode=function(){var i=this._getKeyboardExtension();var F=document.activeElement;var I=T.getInteractiveElements(F);var $=T.getParentCell(this,F);var G=T.getCellInfo($);if(G.isOfType(C.ANYCOLUMNHEADER)){return false;}if(I){i._suspendItemNavigation();F.tabIndex=-1;b._focusElement(this,I[0],true);return true;}else if($){this._getKeyboardExtension()._suspendItemNavigation();return true;}return false;};b.prototype.leaveActionMode=function(i){i=i==null?true:i;var F=this._getKeyboardExtension();var G=document.activeElement;var $=T.getParentCell(this,G);F._resumeItemNavigation();if(i){if($){b._focusElement(this,$[0],true);}else{var I=this._getItemNavigation();if(I){var J=I.aItemDomRefs;var L=J.indexOf(G);if(L>-1){I.setFocusedIndex(L);}}F._setSilentFocus(G);}}};b.prototype.onfocusin=function(i){if(i.isMarked("sapUiTableIgnoreFocusIn")){return;}var $=q(i.target);if($.hasClass("sapUiTableOuterBefore")||$.hasClass("sapUiTableOuterAfter")||(i.target!=this.getDomRef("overlay")&&this.getShowOverlay())){this.$("overlay").trigger("focus");}else if($.hasClass("sapUiTableCtrlBefore")){var N=T.isNoDataVisible(this);if(!N||N&&this.getColumnHeaderVisible()){t(this,i);}else{this._getKeyboardExtension()._setSilentFocus(this.$("noDataCnt"));}}else if($.hasClass("sapUiTableCtrlAfter")){if(!T.isNoDataVisible(this)){r(this,i);}}var F=T.getCellInfo(i.target);var I=F.isOfType(C.ROWHEADER)&&T.Grouping.isInGroupHeaderRow(i.target);var G=F.isOfType(C.ROWHEADER)&&!I&&T.isRowSelectorSelectionAllowed(this);var J=F.isOfType(C.DATACELL)&&this._getKeyboardExtension()._bStayInActionMode;var P=T.getCellInfo(T.getParentCell(this,i.target)).isOfType(C.ANYCONTENTCELL);var L=b._isElementInteractive(i.target);var O=this._getKeyboardExtension().isInActionMode();var Q=(O&&(I||G||J)||(L&&P));if(J){this._getKeyboardExtension()._bStayInActionMode=false;}this._getKeyboardExtension().setActionMode(Q,false);};b.prototype.onkeydown=function(i){var F=this._getKeyboardExtension();var G=T.getCellInfo(i.target);var I=this.getSelectionMode();var J=this._getSelectionPlugin();if(b._isKeyCombination(i,K.F2)){var L=F.isInActionMode();var $=T.getCell(this,i.target);var N=T.getParentCell(this,i.target)!=null;G=T.getCellInfo($);if(!L&&N){$.trigger("focus");}else if(G.isOfType(C.ANYCOLUMNHEADER)){var O=T.getInteractiveElements($);if(O){O[0].focus();}}else{F.setActionMode(!L);}return;}if(b._isKeyCombination(i,K.F4)&&b._allowsToggleExpandedState(this,i.target)){v(this,i.target).toggleExpandedState();return;}if(b._isKeyCombination(i,K.SPACE)&&A(i.target)){i.preventDefault();return;}if(this._getKeyboardExtension().isInActionMode()||!G.isOfType(C.ANY)){return;}if(b._isKeyCombination(i,K.SPACE)){i.preventDefault();}if(b._isKeyCombination(i,K.SHIFT)&&I===S.MultiToggle&&(G.isOfType(C.ROWHEADER)&&T.isRowSelectorSelectionAllowed(this)||(G.isOfType(C.DATACELL|C.ROWACTION)))){E(this);}else if(b._isKeyCombination(i,K.A,M.CTRL)){i.preventDefault();if(G.isOfType(C.ANYCONTENTCELL|C.COLUMNROWHEADER)&&I===S.MultiToggle){J.onKeyboardShortcut("toggle");}}else if(b._isKeyCombination(i,K.A,M.CTRL+M.SHIFT)){if(G.isOfType(C.ANYCONTENTCELL|C.COLUMNROWHEADER)){J.onKeyboardShortcut("clear");}}else if(b._isKeyCombination(i,K.F4)){if(G.isOfType(C.DATACELL)){F.setActionMode(true);}}};b.prototype.onkeypress=function(i){var F=this._getKeyboardExtension();var G=T.getCellInfo(i.target);if(b._isKeyCombination(i,"+")){if(b._allowsToggleExpandedState(this,i.target)){v(this,i.target).expand();}else if(G.isOfType(C.DATACELL|C.ROWACTION)){F.setActionMode(true);}}else if(b._isKeyCombination(i,"-")){if(b._allowsToggleExpandedState(this,i.target)){v(this,i.target).collapse();}else if(G.isOfType(C.DATACELL|C.ROWACTION)){F.setActionMode(true);}}};b.prototype.oncontextmenu=function(i){if(i.isMarked("handledByPointerExtension")){return;}var F=T.getCellInfo(document.activeElement);if(F.isOfType(C.ANY)){i.preventDefault();T.Menu.openContextMenu(this,i.target,i);}};b.prototype.onkeyup=function(i){var F=T.getCellInfo(i.target);if(b._isKeyCombination(i,K.SHIFT)){delete this._oRangeSelection;}if(F.isOfType(C.COLUMNHEADER)){if(b._isKeyCombination(i,K.SPACE)||b._isKeyCombination(i,K.ENTER)){T.Menu.openContextMenu(this,i.target);}}else if(b._isKeyCombination(i,K.SPACE)){w(this,i);}else if(b._isKeyCombination(i,K.SPACE,M.SHIFT)){T.toggleRowSelection(this,this.getRows()[F.rowIndex].getIndex());E(this);}else if(this._legacyMultiSelection&&!F.isOfType(C.COLUMNROWHEADER)&&(b._isKeyCombination(i,K.SPACE,M.CTRL)||b._isKeyCombination(i,K.ENTER,M.CTRL))){w(this,i);}};b.prototype.onsaptabnext=function(F){var G=this._getKeyboardExtension();var I=T.getCellInfo(F.target);var $;if(G.isInActionMode()){var J;$=T.getCell(this,F.target);I=T.getCellInfo($);if(!I.isOfType(C.ANYCONTENTCELL)){return;}var R=this.getRows()[I.rowIndex];var L=b._getLastInteractiveElement(R);var N=L===null||L[0]===F.target;if(N){var O=R.getIndex();var P=T.isLastScrollableRow(this,$);var Q=this._getTotalRowCount()-1===O;var U=T.isRowSelectorSelectionAllowed(this);F.preventDefault();if(Q){G.setActionMode(false);}else if(P){j(this,F);}else{var V=I.rowIndex;if(U){z(this,C.ROWHEADER,V+1);}else{var W=this.getRows().length;var X=false;for(var i=I.rowIndex+1;i<W;i++){V=i;R=this.getRows()[V];J=b._getFirstInteractiveElement(R);X=R.isGroupHeader();if(J||X){break;}}if(J){b._focusElement(this,J[0]);}else if(X){z(this,C.ROWHEADER,V);}else{j(this,F);}}}}else if(I.isOfType(C.ROWHEADER)){F.preventDefault();J=b._getFirstInteractiveElement(R);b._focusElement(this,J[0]);}else{F.preventDefault();J=b._getNextInteractiveElement(this,F.target);b._focusElement(this,J[0]);}}else if(I.isOfType(C.ANYCOLUMNHEADER)){if(T.isNoDataVisible(this)){this.$("noDataCnt").trigger("focus");F.preventDefault();}else if(this.getRows().length>0){r(this,F);F.preventDefault();}}else if(I.isOfType(C.ANYCONTENTCELL)){u(this,"sapUiTableCtrlAfter");}else if(F.target===this.getDomRef("overlay")){G._setSilentFocus(this.$().find(".sapUiTableOuterAfter"));}else if(!I.isOfType(C.ANY)){$=T.getParentCell(this,F.target);if($){F.preventDefault();$.trigger("focus");}}};b.prototype.onsaptabprevious=function(F){var G=this._getKeyboardExtension();var I=T.getCellInfo(F.target);var $;if(G.isInActionMode()){var J;$=T.getCell(this,F.target);I=T.getCellInfo($);if(!I.isOfType(C.ANYCONTENTCELL)){return;}var R=this.getRows()[I.rowIndex];var L=R.getIndex();var N=b._getFirstInteractiveElement(R);var O=N!==null&&N[0]===F.target;var P=T.isRowSelectorSelectionAllowed(this);var Q=P||R.isGroupHeader();if(O&&Q){F.preventDefault();z(this,C.ROWHEADER,I.rowIndex);}else if((O&&!Q)||I.isOfType(C.ROWHEADER)||N===null){var U=T.isFirstScrollableRow(this,$);var V=L===0;F.preventDefault();if(V){G.setActionMode(false);}else if(U){m(this,F);}else{var W=I.rowIndex;var X=false;for(var i=I.rowIndex-1;i>=0;i--){W=i;R=this.getRows()[W];J=b._getLastInteractiveElement(R);X=R.isGroupHeader();if(J||Q||X){break;}}if(J){b._focusElement(this,J[0]);}else if(X||Q){z(this,C.ROWHEADER,W);}else{m(this,F);}}}else{F.preventDefault();J=b._getPreviousInteractiveElement(this,F.target);b._focusElement(this,J[0]);}}else if(I.isOfType(C.ANYCONTENTCELL)||F.target===this.getDomRef("noDataCnt")){if(this.getColumnHeaderVisible()&&!I.isOfType(C.ROWACTION)){t(this,F);F.preventDefault();}else{u(this,"sapUiTableCtrlBefore");}}else if(F.target===this.getDomRef("overlay")){this._getKeyboardExtension()._setSilentFocus(this.$().find(".sapUiTableOuterBefore"));}else if(!I.isOfType(C.ANY)){$=T.getParentCell(this,F.target);if($){F.preventDefault();$.trigger("focus");}}};b.prototype.onsapdown=function(i){n(this,i);};b.prototype.onsapdownmodifiers=function(i){if(b._isKeyCombination(i,null,M.CTRL)){n(this,i);return;}var F=this._getKeyboardExtension();if(b._isKeyCombination(i,null,M.ALT)&&b._allowsToggleExpandedState(this,i.target)){p(i);v(this,i.target).expand();return;}if(F.isInActionMode()){return;}var G=T.getCellInfo(i.target);if(b._isKeyCombination(i,null,M.SHIFT)){i.preventDefault();if(G.isOfType(C.ANYCONTENTCELL)){if(!this._oRangeSelection){p(i);return;}var I=T.getRowIndexOfFocusedCell(this);var J=this.getRows()[I].getIndex();if(J===this._getTotalRowCount()-1){return;}if(T.isLastScrollableRow(this,i.target)){var L=s(this,i);if(L){p(i);}}if(this._oRangeSelection.startIndex<=J){J++;if(this._oRangeSelection.selected){T.toggleRowSelection(this,J,true);}else{T.toggleRowSelection(this,J,false);}}else{T.toggleRowSelection(this,J,false);}}else{p(i);}}if(b._isKeyCombination(i,null,M.ALT)){if(G.isOfType(C.DATACELL)){F.setActionMode(true);}p(i);}};b.prototype.onsapup=function(i){d(this,i);};b.prototype.onsapupmodifiers=function(i){if(b._isKeyCombination(i,null,M.CTRL)){d(this,i);return;}if(b._isKeyCombination(i,null,M.ALT)&&b._allowsToggleExpandedState(this,i.target)){p(i);v(this,i.target).collapse();return;}var F=this._getKeyboardExtension();if(F.isInActionMode()){return;}var G=T.getCellInfo(i.target);if(b._isKeyCombination(i,null,M.SHIFT)){i.preventDefault();if(G.isOfType(C.ANYCONTENTCELL)){if(!this._oRangeSelection){p(i);return;}var I=T.getRowIndexOfFocusedCell(this);var J=this.getRows()[I].getIndex();if(J===0){p(i);return;}if(T.isFirstScrollableRow(this,i.target)){var L=g(this,i);if(L){p(i);}}if(this._oRangeSelection.startIndex>=J){J--;if(this._oRangeSelection.selected){T.toggleRowSelection(this,J,true);}else{T.toggleRowSelection(this,J,false);}}else{T.toggleRowSelection(this,J,false);}}else{p(i);}}if(b._isKeyCombination(i,null,M.ALT)){if(G.isOfType(C.DATACELL)){F.setActionMode(true);}p(i);}};b.prototype.onsapleft=function(i){f(this,i);};b.prototype.onsapleftmodifiers=function(F){if(this._getKeyboardExtension().isInActionMode()){return;}var G=T.getCellInfo(F.target);var I=sap.ui.getCore().getConfiguration().getRTL();if(b._isKeyCombination(F,null,M.SHIFT)){F.preventDefault();if(G.isOfType(C.DATACELL)){if(!this._oRangeSelection){p(F);return;}var J=T.getFocusedItemInfo(this);var L=T.hasRowHeader(this)&&J.cellInRow===1;if(L&&!T.isRowSelectorSelectionAllowed(this)){p(F);}}else if(G.isOfType(C.ROWACTION)){if(!this._oRangeSelection){p(F);}}else if(G.isOfType(C.ROWHEADER)&&I){if(!T.isRowSelectionAllowed(this)){p(F);}}else if(G.isOfType(C.COLUMNROWHEADER)&&I){p(F);}else if(G.isOfType(C.COLUMNHEADER)){var R=-T.convertCSSSizeToPixel(a);var N=0;if(I){R=R*-1;}for(var i=G.columnIndex;i<G.columnIndex+G.columnSpan;i++){N+=T.Column.getColumnWidth(this,i);}T.Column.resizeColumn(this,G.columnIndex,N+R,true,G.columnSpan);p(F);}}else if(b._isKeyCombination(F,null,M.CTRL)){if(G.isOfType(C.COLUMNHEADER)){F.preventDefault();F.stopImmediatePropagation();var O=this.getColumns()[G.columnIndex];x(O,I);}}};b.prototype.onsaprightmodifiers=function(F){if(this._getKeyboardExtension().isInActionMode()){return;}var G=T.getCellInfo(F.target);var I=sap.ui.getCore().getConfiguration().getRTL();if(b._isKeyCombination(F,null,M.SHIFT)){F.preventDefault();if(G.isOfType(C.DATACELL)){if(!this._oRangeSelection){p(F);}}else if(G.isOfType(C.ROWHEADER)){if(!T.isRowSelectionAllowed(this)){p(F);}}else if(G.isOfType(C.ROWACTION)&&I){if(!this._oRangeSelection){p(F);}}else if(G.isOfType(C.COLUMNHEADER)){var R=T.convertCSSSizeToPixel(a);var J=0;if(I){R=R*-1;}for(var i=G.columnIndex;i<G.columnIndex+G.columnSpan;i++){J+=T.Column.getColumnWidth(this,i);}T.Column.resizeColumn(this,G.columnIndex,J+R,true,G.columnSpan);p(F);}else if(G.isOfType(C.COLUMNROWHEADER)){p(F);}}else if(b._isKeyCombination(F,null,M.CTRL)){if(G.isOfType(C.COLUMNHEADER)){F.preventDefault();F.stopImmediatePropagation();var L=this.getColumns()[G.columnIndex];x(L,!I);}}};b.prototype.onsaphome=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(T.Grouping.isInGroupHeaderRow(i.target)){p(i);i.preventDefault();return;}var F=T.getCellInfo(i.target);if(F.isOfType(C.ANY)){i.preventDefault();}if(F.isOfType(C.DATACELL|C.ROWACTION|C.COLUMNHEADER)){var G=T.getFocusedItemInfo(this);var I=G.cell;var J=G.cellInRow;var L=this.getComputedFixedColumnCount();var N=T.hasRowHeader(this);var R=N?1:0;if(T.hasFixedColumns(this)&&J>L+R){p(i);T.focusItem(this,I-J+L+R,null);}else if(N&&J>1){p(i);T.focusItem(this,I-J+R,null);}}};b.prototype.onsapend=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(T.Grouping.isInGroupHeaderRow(i.target)){i.preventDefault();p(i);return;}var F=T.getCellInfo(i.target);if(F.isOfType(C.ANY)){i.preventDefault();var G=T.getFocusedItemInfo(this);var I=G.cell;var J=G.columnCount;var L=this.getComputedFixedColumnCount();var N=G.cellInRow;var O=T.hasRowHeader(this);var R=O?1:0;var P=false;if(F.isOfType(C.COLUMNHEADER)&&T.hasFixedColumns(this)){var Q=parseInt(F.cell.attr("colspan")||1);if(Q>1&&N+Q-R===L){P=true;}}if(O&&N===0){p(i);T.focusItem(this,I+1,null);}else if(T.hasFixedColumns(this)&&N<L-1+R&&!P){p(i);T.focusItem(this,I+L-N,null);}else if(T.hasRowActions(this)&&F.isOfType(C.DATACELL)&&N<J-2){p(i);T.focusItem(this,I-N+J-2,null);}}};b.prototype.onsaphomemodifiers=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(i,null,M.CTRL)){i.preventDefault();var F=T.getCellInfo(i.target);if(F.isOfType(C.ANYCONTENTCELL|C.COLUMNHEADER)){p(i);var G=T.getFocusedItemInfo(this);var I=G.row;if(I>0){var J=G.cell;var L=G.columnCount;var N=T.getHeaderRowCount(this);var R=this._getRowCounts();if(I<N+R.fixedTop){if(F.isOfType(C.ROWACTION)){T.focusItem(this,J-L*(I-N),i);}else{T.focusItem(this,J-L*I,i);}}else if(I>=N+R.fixedTop&&I<N+T.getNonEmptyRowCount(this)-R.fixedBottom){this._getScrollExtension().scrollVerticallyMax(false);if(R.fixedTop>0||F.isOfType(C.ROWACTION)){T.focusItem(this,J-L*(I-N),i);}else{T.focusItem(this,J-L*I,i);}}else{this._getScrollExtension().scrollVerticallyMax(false);T.focusItem(this,J-L*(I-N-R.fixedTop),i);}}}}};b.prototype.onsapendmodifiers=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(i,null,M.CTRL)){i.preventDefault();var F=T.getCellInfo(i.target);if(F.isOfType(C.ANY)){var G=T.getFocusedItemInfo(this);var I=G.row;var J=T.getHeaderRowCount(this);var N=T.getNonEmptyRowCount(this);var R=this._getRowCounts();p(i);if(R.fixedBottom===0||I<J+N-1||(T.isNoDataVisible(this)&&I<J-1)){var L=G.cell;var O=G.columnCount;if(T.isNoDataVisible(this)){T.focusItem(this,L+O*(J-I-1),i);}else if(I<J){if(R.fixedTop>0){T.focusItem(this,L+O*(J+R.fixedTop-I-1),i);}else{this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,L+O*(J+N-R.fixedBottom-I-1),i);}}else if(I>=J&&I<J+R.fixedTop){this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,L+O*(J+N-R.fixedBottom-I-1),i);}else if(I>=J+R.fixedTop&&I<J+N-R.fixedBottom){this._getScrollExtension().scrollVerticallyMax(true);T.focusItem(this,L+O*(J+N-I-1),i);}else{T.focusItem(this,L+O*(J+N-I-1),i);}}}}};b.prototype.onsappageup=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}i.preventDefault();var F=T.getCellInfo(i.target);if(F.isOfType(C.ANYCONTENTCELL|C.COLUMNHEADER)){var G=T.getFocusedItemInfo(this);var I=G.row;var J=T.getHeaderRowCount(this);var R=this._getRowCounts();if(R.fixedTop===0&&I>=J||R.fixedTop>0&&I>J){p(i);var L=G.cell;var N=G.columnCount;if(I<J+R.fixedTop){T.focusItem(this,L-N*(I-J),i);}else if(I===J+R.fixedTop){var P=T.getNonEmptyRowCount(this)-R.fixedTop-R.fixedBottom;var O=this.getFirstVisibleRow();g(this,i,true);if(O<P){if(R.fixedTop>0||F.isOfType(C.ROWACTION)){T.focusItem(this,L-N*(I-J),i);}else{T.focusItem(this,L-N*J,i);}}}else if(I>J+R.fixedTop&&I<J+T.getNonEmptyRowCount(this)){T.focusItem(this,L-N*(I-J-R.fixedTop),i);}else{T.focusItem(this,L-N*(I-J-T.getNonEmptyRowCount(this)+1),i);}}if(F.isOfType(C.ROWACTION)&&I===J&&R.fixedTop>0){p(i);}}};b.prototype.onsappagedown=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}i.preventDefault();var F=T.getCellInfo(i.target);if(F.isOfType(C.ANY)){var G=T.getFocusedItemInfo(this);var I=G.row;var J=T.getHeaderRowCount(this);var N=T.getNonEmptyRowCount(this);var R=this._getRowCounts();p(i);if((T.isNoDataVisible(this)&&I<J-1)||R.fixedBottom===0||I<J+N-1){var L=G.cell;var O=G.columnCount;if(I<J-1&&!F.isOfType(C.COLUMNROWHEADER)){T.focusItem(this,L+O*(J-I-1),i);}else if(I<J){if(!T.isNoDataVisible(this)){T.focusItem(this,L+O*(J-I),i);}}else if(I>=J&&I<J+N-R.fixedBottom-1){T.focusItem(this,L+O*(J+N-R.fixedBottom-I-1),i);}else if(I===J+N-R.fixedBottom-1){var P=T.getNonEmptyRowCount(this)-R.fixedTop-R.fixedBottom;var Q=this._getTotalRowCount()-R.fixedBottom-this.getFirstVisibleRow()-P*2;s(this,i,true);if(Q<P&&R.fixedBottom>0){T.focusItem(this,L+O*(J+N-I-1),i);}}else{T.focusItem(this,L+O*(J+N-I-1),i);}}}};b.prototype.onsappageupmodifiers=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(i,null,M.ALT)){var F=T.getCellInfo(i.target);var G=T.getFocusedItemInfo(this);if(F.isOfType(C.DATACELL|C.COLUMNHEADER)){var I=G.cell;var J=G.cellInRow;var L=T.hasRowHeader(this);var R=L?1:0;var P=H;p(i);if(L&&(T.Grouping.isInGroupHeaderRow(i.target)||J===1)){T.focusItem(this,I-J,null);}else if(J-R<P){T.focusItem(this,I-J+R,null);}else{T.focusItem(this,I-P,null);}}else if(F.isOfType(C.ROWACTION)){T.focusItem(this,G.cell-1,null);}}};b.prototype.onsappagedownmodifiers=function(i){if(this._getKeyboardExtension().isInActionMode()){return;}if(b._isKeyCombination(i,null,M.ALT)){var F=T.getCellInfo(i.target);if(F.isOfType(C.DATACELL|C.ROWHEADER|C.ANYCOLUMNHEADER)){var G=T.getFocusedItemInfo(this);var I=G.cellInRow;var J=T.hasRowHeader(this);var R=J?1:0;var V=T.getVisibleColumnCount(this);var L=parseInt(F.cell.attr("colspan")||1);p(i);if(I+L-R<V){var N=G.cell;var P=H;if(J&&I===0){T.focusItem(this,N+1,null);}else if(L>P){T.focusItem(this,N+L,null);}else if(I+L-R+P>V){T.focusItem(this,N+V-I-1+R,null);}else if(!T.Grouping.isInGroupHeaderRow(i.target)){T.focusItem(this,N+P,null);}}else if(F.isOfType(C.DATACELL)&&T.hasRowActions(this)&&I===G.columnCount-2){T.focusItem(this,G.cell+1,null);}}}};b.prototype.onsapenter=function(i){w(this,i);};return b;});
