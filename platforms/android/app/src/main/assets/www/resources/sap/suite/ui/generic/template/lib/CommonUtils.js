sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Context","sap/ui/model/Filter","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/metadataAnalyser","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/ui/model/analytics/odata4analytics","sap/base/util/extend","sap/base/util/deepExtend","sap/suite/ui/generic/template/genericUtilities/FeError","sap/suite/ui/generic/template/js/StableIdHelper"],function(B,E,C,a,F,R,L,M,S,N,c,m,t,b,o,d,f,g,h){"use strict";var s="lib.CommonUtils";var l=sap.ui.getCore();var n=new b(s).getLogger();function p(q,r,u){var v;var w=Object.create(null);var O=Object.create(null);function P(e){var i;if(c.isSmartTable(e)){i=e.getCustomToolbar();}else if(c.isSmartChart(e)){i=e.getToolbar();}if(i){var j=V(i);if(j&&j.annotatedActionIds){O[e.getId()]=JSON.parse(atob(j.annotatedActionIds));}if(j&&j.deleteButtonId){O[e.getId()].push({ID:j.deleteButtonId,RecordType:"CRUDActionDelete"});}if(j&&j.multiEditButtonId){O[e.getId()].push({ID:j.multiEditButtonId,RecordType:"CRUDActionMultiEdit"});}}}function G(e){if(!O[e.getId()]){P(e);}return O[e.getId()];}function x(e){var i,j,k,P1;i=e.getEntitySet();j=q.getOwnerComponent().getModel().getMetaModel();k=j.getODataEntitySet(i);P1=j.getODataEntityType(k.entityType);return P1;}function y(e,i,j){var k=e instanceof E?e.getSource():e;var P1=k.getId();var Q1=w[P1];if(!Q1){if(j){return null;}Q1={control:k,infoObject:Object.create(null),categories:[]};(i||Function.prototype)(Q1.infoObject,Q1.categories,k);w[P1]=Q1;}return Q1.infoObject;}function z(e,i){for(var j in w){var k=w[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function A(e){r.oApplication.attachControlToParent(e,q.getView());}function D(e,i,j){var k="";var P1=q.getView();var Q1=e.find(function(R1){var S1;var T1=j&&function(U1){j(R1,U1,S1);S1=U1;};if(c.isElementVisibleOnView(R1,P1,T1)){if(i){var U1=l.byId(R1);if(c.isSmartTable(U1)||c.isMTable(U1)||c.isUiTable(U1)){k=k||R1;return false;}}return true;}});return Q1||k;}function H(e,i,j,k){return r.oApplication.getDialogFragmentForView(q.getView(),e,i,j,k);}function I(e,i,j,k,P1){return r.oApplication.getDialogFragmentForViewAsync(q.getView(),e,i,j,k,P1);}var J;function K(k,e,i){var j=q.getOwnerComponent();J=J||j.getModel("i18n").getResourceBundle();return J.getText(k,e,i);}function Q(k,e,i,j){var P1,Q1,R1,S1;var T1=q.getOwnerComponent();var U1=e.indexOf("::"+T1.getEntitySet()+"--")+2;P1=e.substring(U1,e.lastIndexOf("::"));P1=P1.replace(/--/g,"|").replace(/::/g,"|");R1=i||k;Q1=P1&&P1!='|'?k+"|"+P1:R1;S1=K(Q1,j,true);if(!S1&&Q1!=R1){S1=K(R1,j);}return S1;}function T(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function U(e,j,k){var P1=[];if(c.isSmartTable(e)){e=e.getTable();}else if(c.isSmartChart(e)){e.getChartAsync().then(function(T1){e=T1;if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var U1=false;j=j||e.getSelectionBehavior();k=k||T(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){U1=true;}var V1=k.dataPoints;var W1=[];for(var i=0;i<V1.length;i++){if(U1){if(V1[i].context){P1.push(V1[i].context);}}else{W1.push(V1[i].dimensions);}}if(!U1){P1[0]=W1;}}}});}if(e instanceof L){P1=e.getSelectedContexts();}else if(c.isUiTable(e)){var Q1=e.getPlugins().filter(function(T1){return T1.isA("sap.ui.table.plugins.SelectionPlugin");})[0];var R1=Q1?Q1.getSelectedIndices():e.getSelectedIndices();if(R1){var S1;for(var i=0;i<R1.length;i++){S1=e.getContextByIndex(R1[i]);if(S1){P1.push(S1);}}}}return P1;}function V(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function W(e){var j,k,P1;var Q1=h1(e);if(!c.isSmartTable(Q1)&&!c.isSmartChart(Q1)){Q1=Q1.getParent();}var R1=U(Q1);var S1=Q1.getModel();k=e1(Q1);c1(k,R1,S1,Q1);j=G(Q1);for(var i=0;i<j.length;i++){P1=j[i];X(P1,S1,R1,Q1);}}function X(e,i,j,k){var P1;if(e.RecordType==="CRUDActionDelete"){var Q1=_(i,j,k);u.getTemplatePrivateModel().setProperty("/listReport/deleteEnabled",Q1);P1=Promise.resolve(Q1);}else if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var R1=i.getMetaModel();P1=$(i,R1,j,e.RecordType,e.Action,k);}else if(e.RecordType==="CRUDActionMultiEdit"){var S1=b1(j,k);u.getTemplatePrivateModel().setProperty("/listReport/multiEditEnabled",S1.length>0);}var T1=q.getView().byId(e.ID);if(T1&&/generic\/controlProperties/.test(T1.getBindingPath("enabled"))){P1.then(Z.bind(null,e.ID,"enabled"));}}function Y(e){var i;var j=h1(e);var k=U(j);var P1=e.getModel();i=f1();c1(i,k,P1,j);}function Z(i,e,j){var k=u.getTemplatePrivateModel();var P1=k.getProperty("/generic/controlProperties/"+i);if(!P1){P1={};P1[e]=j;k.setProperty("/generic/controlProperties/"+i,P1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function $(e,i,k,P1,Q1,R1){var S1,T1,U1,V1;var W1=false;if(P1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){S1=i.getODataFunctionImport(Q1);U1=S1&&S1["sap:action-for"];if(U1&&U1!==""&&U1!==" "){if(k.length>0){V1=S1["sap:applicable-path"];if(V1&&V1!==""&&V1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}T1=e.getObject(k[j].getPath());if(T1&&T1[V1]){W1=true;break;}}}else{W1=true;}}}else{W1=true;}}else if(P1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0){W1=true;}else if(c.isSmartChart(R1)){return R1.getChartAsync().then(function(){return R1.getDrillStackFilters().length>0;});}}return Promise.resolve(W1);}function _(e,i,j){if(i.length===0){return false;}var k=a1(j);var P1=k&&k.Deletable&&k.Deletable.Path;return i.some(function(Q1){var R1=e.getObject(Q1.getPath()+"/DraftAdministrativeData");var S1=!(R1&&R1.InProcessByUser&&!R1.DraftIsProcessedByMe);return S1&&!(P1&&!e.getProperty(P1,Q1));});}function a1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function b1(e,i){if(e.length===0){return[];}var j=[];var k=i.getModel();var P1=k.getMetaModel();var Q1=P1.getODataEntitySet(i.getEntitySet());var R1=Q1["Org.OData.Capabilities.V1.UpdateRestrictions"]&&Q1["Org.OData.Capabilities.V1.UpdateRestrictions"].Updatable;if(R1){if(R1.Path){j=e.filter(function(S1){return!!k.getProperty(R1.Path,S1);});}else if(R1.Bool!=="false"){j=e;}}return j;}function c1(e,i,j,k){var P1=g1(k);var Q1=u.getTemplatePrivateModel();var R1=Q1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(P1){var S1=q.byId("template::IconTabBar");var T1="";if(S1){T1=S1.getSelectedKey();}d1(R1,P1,e,i,j,T1,k);}Q1.setProperty("/generic/listCommons/breakoutActionsEnabled",R1);}function d1(e,i,j,k,P1,Q1,R1){var S1;for(var T1 in i){S1=true;var U1=i[T1].id+((Q1&&!i[T1].determining)?"-"+Q1:"");if(R1&&R1.getId().indexOf("AnalyticalListPage")>-1){S1=!!e[U1].enabled;}if(i[T1].requiresSelection){if(k.length>0){if(R1&&c.isSmartChart(R1)){if(i[T1].filter==="chart"){S1=true;}}else if(R1&&c.isSmartTable(R1)){if(i[T1].filter!=="chart"){S1=true;}}if(i[T1].applicablePath!==undefined&&i[T1].applicablePath!==""){S1=false;for(var V1=0;V1<k.length;V1++){var W1="";var X1=i[T1].applicablePath.split("/");if(X1.length>1){for(var Y1=0;Y1<X1.length-1;Y1++){W1+="/"+X1[Y1];}}var Z1=P1.getObject(k[V1].getPath()+W1);var $1=X1[X1.length-1];if(Z1[$1]===true){S1=true;break;}}}}else if(c.isSmartChart(R1)){if((R1.getId().indexOf("AnalyticalListPage")>-1?i[T1].filter==="chart":true)){if(R1.getDrillStackFilters().length>0){S1=true;}else{S1=false;}}}else{if(i[T1].filter!=="chart"){S1=false;}}}e[U1]={enabled:S1};}}function e1(e){var i=[];var j=g1(e);for(var k in j){i.push(j[k].id);}return i;}function f1(){var e=[];var i=g1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function g1(e){var i=u.getControllerExtensions();var j=V(e).sectionId;if(!j){return i&&i["Actions"];}else{return i&&i.Sections&&i.Sections[j]&&i.Sections[j].Actions;}}function h1(e){var i=e;while(i){if(i instanceof R||c.isUiTable(i)||c.isSmartTable(i)||c.isSmartChart(i)||c.isSmartList(i)){return i;}i=i.getParent&&i.getParent();}return null;}function i1(e){if(c.isUiTable(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function j1(e){return e.getAggregation("items")[1].getBindingInfo("items");}function k1(e){if(c.isSmartList(e)){return j1(e);}else if(c.isSmartTable(e)){e=e.getTable();return i1(e);}else{return i1(e);}}function l1(e,i,j){var k=k1(e);if(k&&k.binding){if(i){k.binding.refresh(i);}else{k.binding.refresh();}if(!j&&q.getView().getModel("ui").getProperty("/editable")){u.messagesRefresh();}}else if(e&&e.rebindTable){e.rebindTable();}}function m1(e){var i=j1(e);if(i&&i.binding){i.binding.refresh();}}function n1(e,i){var j=q.getOwnerComponent();var k=j.getModel();var P1,Q1;var R1=!r.oApplication.checkEtags();if(R1){Q1=k1(e);if(Q1){P1=Q1.path;var S1=e.getEntitySet();var T1=k.getMetaModel();var U1=T1.getODataEntitySet(S1);if(q.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&o1(k,U1)){k.invalidateEntityType(U1.entityType);}else{k.invalidate(p1.bind(null,P1));}var V1=j.getId();var W1=Object.create(null);W1[V1]=true;r.oApplication.refreshAllComponents(W1);return true;}}return false;}function o1(e,i){var j=new o.Model(o.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var P1=k&&k.getParameterization();return!!P1;}function p1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function q1(e,i){var j;if(u.isDraftEnabled()){j=r.oDraftController.isActiveEntity(e)?1:6;}else{var k=q.getOwnerComponent();j=k.getModel("ui").getProperty("/editable")?6:1;}u.navigateAccordingToContext(e,j,i);}function r1(e){if(e instanceof N){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(K("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:K("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:K("ST_GENERIC_ERROR_TITLE")});}}}function s1(e,i){E1(function(){v=r.oApplication.getNavigationHandler();var j={semanticObject:e.semanticObject,action:e.action};var k=v.mixAttributesAndSelectionVariant(e.parameters);if(typeof q.adaptNavigationParameterExtension==="function"){q.adaptNavigationParameterExtension(k,j);}O1(e);v.navigate(e.semanticObject,e.action,k.toJSONString(),null,r1);},Function.prototype,i,(u.isDraftEnabled()&&"NavigateExternal")||"LeavePage");}function t1(e){var P1=[],Q1,R1,S1;var T1=q.getOwnerComponent();var U1=T1.getModel().getMetaModel();if(!e){return{};}var V1=T1.getAppComponent().getConfig().pages[0];if(!V1){return{};}var W1=function(i){S1=U1.getODataEntitySet(i.entitySet).entityType;R1=U1.getODataEntityType(S1);Q1={};Q1={entitySet:i.entitySet,aKeys:U1.getODataEntityType(S1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,Y1=Q1.aKeys.length;j<Y1;j++){var k=0,Z1=R1.property.length;for(k;k<Z1;k++){if(Q1.aKeys[j].name===R1.property[k].name){Q1.aKeys[j].type=R1.property[k].type;break;}}}};var X1=function(e,V1){if(!V1.pages){return P1;}for(var i=0,j=V1.pages.length;i<j;i++){if(!V1.pages[i]){break;}if(e===V1.pages[i].entitySet){W1(V1.pages[i]);P1.splice(0,0,Q1);break;}P1=X1(e,V1.pages[i]);if(P1.length>0){W1(V1.pages[i]);P1.splice(0,0,Q1);}}return P1;};return X1(e,V1);}function u1(k,e){var P1,Q1,i,R1;for(i=0,R1=k.length;i<R1;i++){if(k[i].navigationProperty){Q1+="/"+k[i].navigationProperty;}else{Q1="/"+k[i].entitySet;}for(var j=0,S1=k[i].aKeys.length;j<S1;j++){if(j===0){Q1+="(";P1="";}else{P1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData.DraftUUID+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+false;}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){Q1+=P1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(S1-1)){Q1+=")";}}}return Q1;}function v1(e,k,q,P1){var Q1,R1,S1,T1,U1,V1,W1;var X1={semanticObject:"",action:""};var Y1=e.getParameters();v=r.oApplication.getNavigationHandler();Q1=v.mixAttributesAndSelectionVariant({},k);for(T1 in Y1.semanticAttributesOfSemanticObjects){for(S1 in Y1.semanticAttributesOfSemanticObjects[T1]){if(!Q1.getSelectOption(S1)){Q1.addParameter(S1,"");}}U1=Q1.getPropertyNames();X1.semanticObject=T1;V1=Q1.getSelectOptionsPropertyNames();W1=Q1.getParameterNames();for(var i=0,Z1=U1.length;i<Z1;i++){if(V1.indexOf(U1[i])<0&&W1.indexOf(U1[i])<0){delete Y1.semanticAttributesOfSemanticObjects[T1][U1[i]];Q1.removeSelectOption(U1[i]);}}if(T1===Y1.semanticObject){var $1=Y1.semanticAttributesOfSemanticObjects[""];for(var j=0,Z1=W1.length;j<Z1;j++){Q1.removeParameter(W1[j]);if(!(W1[j]in $1)){var _1=Y1.semanticAttributesOfSemanticObjects[Y1.semanticObject][W1[j]];_1=(typeof _1==="undefined"||_1===null)?"":String(_1);Q1.addParameter(W1[j],_1);}}Q1=v.mixAttributesAndSelectionVariant(Y1.semanticAttributesOfSemanticObjects[T1],Q1.toJSONString());Q1=w1(Q1,e.getSource(),P1);q.adaptNavigationParameterExtension(Q1,X1);R1=Q1.toJSONString();}}delete Y1.semanticAttributes;v.processBeforeSmartLinkPopoverOpens(Y1,R1);}function w1(e,i,j){var k;var P1=[];var Q1=q.getOwnerComponent().getEntitySet();if(!c.isSemanticObjectController(i)&&!c.isSmartTable(i)){var R1=h1(i)&&h1(i).getParent();if(c.isSmartTable(R1)){i=R1;k=i.getEntitySet();}else{k=Q1;}}else{k=i.getEntitySet();}P1.push(k);var S1=j&&j.oMultipleViewsHandler&&j.oMultipleViewsHandler.getMode&&j.oMultipleViewsHandler.getMode()==="multi";if((k!==Q1)&&!S1){P1.push(Q1);}P1.forEach(function(T1){if(i){var U1=i.getModel().getMetaModel();var V1=U1.getODataEntityType(U1.getODataEntitySet(T1).entityType);e.getPropertyNames().forEach(function(W1){var X1=U1.getODataProperty(V1,W1);if(X1&&((X1["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]&&X1["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"].Bool!=="false")||(X1["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]&&X1["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"].Bool!=="false"))){e.removeSelectOption(W1);}});}});return e;}function x1(e,j){var k=function(T1){for(var i=0;i<T1.length;i++){j(T1[i].name);}};var P1=q.getView().getModel().getMetaModel();var Q1=P1.getODataEntitySet(e,false);var R1=P1.getODataEntityType(Q1.entityType,false);k(R1.key.propertyRef);var S1=r.oDraftController.getDraftContext();if(S1.isDraftEnabled(e)){k(S1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function y1(i,j,k,P1){if(P1&&k&&k.getAnalyticBindingPath&&k.getConsiderAnalyticalParameters()){try{var Q1=k.getAnalyticBindingPath();var R1=i.getEntitySet();var S1=i.getModel();var T1=S1.getMetaModel();var U1=T1.getODataEntitySet(R1);var V1=q.getOwnerComponent();var W1=V1.getAppComponent();var X1=m.getParametersByEntitySet(W1.getModel(),R1);if(j){var Y1=j(U1,X1);Q1=Y1||Q1;}if(Q1){P1(Q1);}}catch(e){n.warning("Mandatory parameters have no values");}}}function z1(e,j,k){for(var i=0;i<j.length;i++){var P1=j[i];var Q1=P1.lastIndexOf("/");var R1;if(Q1<0){if(r.oApplication.getNavigationProperty(e,P1)){R1=P1;}else{continue;}}else{R1=P1.substring(0,Q1);}if(k.indexOf(R1)===-1){k.push(R1);}}}function A1(e,i,j){var k=e.getParameter("bindingParams"),P1=e.getSource().getId();k.parameters=k.parameters||{};k.parameters.transitionMessagesOnly=u.getNoStateMessagesForTables();var Q1=function(X1,Y1,P1){if(i&&i[X1]){var Z1=true;var $1=function(){var _1=arguments[0];if(!(_1 instanceof C)){throw new g(s,"Please provide a valid ControllerExtension in order to execute extension "+X1);}if(!Z1){throw new g(s,"Extension "+X1+" must be executed synchronously");}var a2=Array.prototype.slice.call(arguments,1);Y1.apply(null,a2);};i[X1]($1,P1);Z1=false;}};var R1=function(X1){if(!P1||q.byId(P1)===e.getSource()){k.filters.push(X1);}};if(i.addTemplateSpecificFilters){i.addTemplateSpecificFilters(k.filters);}Q1("addExtensionFilters",R1,P1);var S1=e.getSource();if(q.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){y1(S1,i.resolveParamaterizedEntitySet,j,i.setBindingPath);}var T1=S1.getEntitySet();var U1=k.parameters.select&&k.parameters.select.split(",")||[];var V1=k.parameters.expand&&k.parameters.expand.split(",")||[];var W1=function(X1,P1){if(X1&&(!P1||q.byId(P1)===e.getSource())){var Y1=X1.split(',');Y1.forEach(function(Z1){if(Z1&&U1.indexOf(Z1)===-1){U1.push(Z1);}});}};if(i.isMandatoryFiltersRequired){x1(T1,W1);}Q1("ensureExtensionFields",W1,P1);(i.addNecessaryFields||Function.prototype)(U1,W1,T1);z1(T1,U1,V1);if(V1.length>0){k.parameters.expand=V1.join(",");}if(U1.length>0){k.parameters.select=U1.join(",");}}function B1(e,i,j){if(!e){return K("DRAFT_OBJECT");}else if(i){return K(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function C1(){return new Promise(function(e){var i;I("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var j=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(j.length>0&&(j[0]===null||j[0]===undefined||j[0]==="")){if(j.length>3&&(j[3]===null||j[3]===undefined||j[3]==="")){return(j.length>2&&(j[1]===null||j[1]===undefined||j[1]===""))?"":j[2];}else{return K(k,j[3]);}}else{return K(k,j[0]);}},closeDraftAdminPopover:function(){i.close();},formatDraftLockText:B1},"admin").then(function(j){i=j;e(i);});});}function D1(e,i,j,k){return r.oDataLossHandler.performIfNoDataLoss(e,i,k,true,true);}function E1(e,i,j,k,P1){if(u.isDraftEnabled()){return r.oPageLeaveHandler.performAfterDiscardOrKeepDraft(e,i,k,P1,false);}else{return r.oDataLossHandler.performIfNoDataLoss(e,i,k,P1,false);}}function F1(e,i){i=f({busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var j,k;var P1=new Promise(function(T1,U1){j=T1;k=U1;});var Q1=i.busy.set?function(){r.oApplication.getBusyHelper().setBusy(P1,false,{actionLabel:i.sActionLabel});return e();}:e;var R1=i.mConsiderObjectsAsDeleted?function(T1){r.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return Q1();}:Q1;var S1=function(){var T1;if(u.isDraftEnabled()){T1=R1();}else{T1=(i.dataloss.popup?E1(R1,k,null,(i.dataloss.navigation?"LeavePage":"Proceed"),true):R1());}if(T1 instanceof Promise){T1.then(j,k);}else{j(T1);}};r.oApplication.performAfterSideEffectExecution(S1,i.busy.check&&k);return P1;}function G1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function H1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function I1(e){var j;var k=u.getTemplatePrivateModel();var P1=q.getOwnerComponent();var Q1,R1,S1,T1,U1,V1=[],W1=[],i,X1,Y1,Z1,$1,_1,a2;var b2,c2;Q1=P1.getAppComponent();R1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");S1=k.getProperty("/generic/supportedIntents/");if(c.isSmartChart(e)){j=e.getToolbar();}else if(c.isSmartTable(e)){j=e.getCustomToolbar();}T1=j.getContent();U1=T1.length;for(i=0;i<U1;i++){X1=V(T1[i]);if(X1.hasOwnProperty("SemanticObject")&&X1.hasOwnProperty("Action")){Y1=X1.SemanticObject;Z1=X1.Action;$1={semanticObject:Y1,action:Z1,ui5Component:Q1};V1.push([$1]);_1=d({},$1);_1.bLinkIsSupported=false;W1.push(_1);}}if(V1.length>0&&R1){a2=R1.getLinks(V1);a2.done(function(d2){S1=k.getProperty("/generic/supportedIntents/");b2=d2.length;for(i=0;i<b2;i++){if(d2[i][0].length>0){W1[i].bLinkIsSupported=true;}Y1=W1[i].semanticObject;Z1=W1[i].action;c2=k.getProperty("/generic/supportedIntents/"+Y1);if(!c2){S1[Y1]={};S1[Y1][Z1]={"visible":W1[i].bLinkIsSupported};}else if(!c2[Z1]){c2[Z1]={"visible":W1[i].bLinkIsSupported};}else{c2[Z1]["visible"]=W1[i].bLinkIsSupported;}}k.updateBindings();});}}function J1(e,i,j){var k=i&&q.byId(i);var P1=(i&&!k)?Promise.reject():new Promise(function(Q1,R1){r.oApplication.performAfterSideEffectExecution(function(){var S1=r.oApplication.getBusyHelper();if(S1.isBusy()){R1();return;}if(k&&(!k.getVisible()||(k.getEnabled&&!k.getEnabled()))){R1();return;}var P1=k?e(k,j):e();if(P1 instanceof Promise){P1.then(Q1,R1);S1.setBusy(P1);}else{Q1(P1);}});});P1.catch(Function.prototype);return P1;}function K1(e,i){var j=typeof i==="string"?JSON.parse(i):i;var k=j&&j.SortOrder;if(e.oSmartTable){L1(e.oSmartTable,k);}if(e.oSmartChart){L1(e.oSmartChart,k);}}function L1(e,i){var j=e.getUiState();var k=j.getPresentationVariant();if(!k.SortOrder&&e.isA("sap.ui.comp.smarttable.SmartTable")){var P1=e.getCustomData().find(function(V1){return V1.getKey()==="TemplateSortOrder";});var Q1=P1&&P1&&P1.getValue();if(Q1){k.SortOrder=[];var R1=Q1.split(", ");R1.forEach(function(V1){var W1=V1.split(" ");if(W1.length>1){k.SortOrder.push({Property:W1[0],Descending:W1[1]==="true"});}});}}var S1=function(V1){var W1=e.getModel().getMetaModel();var X1=W1.getODataEntitySet(e&&e.getEntitySet());var Y1=W1.getODataEntityType(X1.entityType);var Z1=Y1.property;return Z1.some(function($1){return $1.name===V1.Property;});};var T1=i.filter(function(V1){return S1(V1);});var U1=T1.concat(k.SortOrder);U1=U1.filter(function(V1){return V1!==undefined;});k.SortOrder=U1;j.setPresentationVariant(k);e.setUiState(j);}function M1(e,i,j,k,P1){var Q1,R1={};if(!i){Q1=[];}else if(Array.isArray(i)){Q1=i;}else{Q1=[i];}if(j){R1.urlParameters=j;}if(k&&k.bInvocationGroupingChangeSet){R1.operationGrouping="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet";}R1.triggerChanges=u.isDraftEnabled();u.executeBeforeInvokeActionFromExtensionAPI(P1);var S1=r.oApplicationController.invokeActions(e,Q1,R1);if(k&&k.bSetBusy){u.getBusyHelper().setBusy(S1);}S1.then(u.executeAfterInvokeActionFromExtensionAPI.bind(null,P1));return S1;}function N1(e){var i=r.oApplication.getChevronNavigationRefreshBehaviour(e);if(i!==Object.create(null)){r.oViewDependencyHelper.setRefreshBehaviour(i);}}function O1(e){var i=r.oApplication.getComponentRefreshBehaviour(e);r.oViewDependencyHelper.setRefreshBehaviour(i);}var c1=t.testable(c1,"fillEnabledMapForBreakoutActions");var e1=t.testable(e1,"getBreakoutActionIds");var h1=t.testable(h1,"getOwnerControl");var U=t.testable(U,"getSelectedContexts");var G=t.testable(G,"fnGetToolbarCutomData");var w1=t.testable(w1,"removePropertiesFromNavigationContext");return{getPositionableControlId:D,getMetaModelEntityType:x,getText:K,getContextText:Q,getNavigationKeyProperties:t1,mergeNavigationKeyPropertiesWithValues:u1,executeGlobalSideEffect:function(){if(u.isDraftEnabled()){var e=q.getView();var i=q.getOwnerComponent();var j=i.getAppComponent();var k=j.getForceGlobalRefresh();var P1=i.getModel("ui");e.attachBrowserEvent("keydown",function(Q1){var R1=Q1.target.type==="search";var S1=Q1.target.type==="textarea";var T1=Q1.target.id.indexOf("rowAction")>-1;var U1=Q1.target.id.indexOf("ColumnListItem")>-1;if(Q1.keyCode===13&&Q1.ctrlKey!==true&&P1.getProperty("/editable")&&!R1&&!S1&&!T1&&!U1){r.oApplication.addSideEffectPromise(new Promise(function(V1,W1){var X1;if(Q1.target.type==="text"){var Y1=Q1.target.parentElement;while(Y1){X1=e.byId(Y1.id);if(X1&&X1.getMetadata().getElementName()==="sap.ui.comp.smartform.SmartForm"){break;}Y1=Y1.parentElement;}}var Z1=X1?X1.check():Promise.resolve();Z1.then(function(){setTimeout(function(){var $1=r.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,k);$1.then(function(){V1();setTimeout(function(){var _1=document.getElementById(Q1.target.id);if(_1){_1.focus();}});},W1);});});}));}});}},setEnabledToolbarButtons:W,setEnabledFooterButtons:Y,fillEnabledMapForBreakoutActions:c1,getBreakoutActions:g1,getSelectedContexts:U,getSelectionPoints:T,getDeleteRestrictions:a1,getSmartTableDefaultVariant:G1,getSmartChartDefaultVariant:H1,setPrivateModelControlProperty:Z,removePropertiesFromNavigationContext:w1,navigateFromListItem:q1,navigateExternal:s1,semanticObjectLinkNavigation:v1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},getCustomDataText:function(e){return new Promise(function(j,k){e.getCustomData().forEach(function(P1){var Q1=P1.getKey();if(Q1==="text"){var R1=P1.getBinding("value");var S1=!R1&&P1.getBindingInfo("value");if(!R1&&!S1){j(P1.getValue());return;}var T1=function(U1){j(U1.getSource().getExternalValue());return;};if(R1){R1.attachChangeOnce(T1);}else{S1.events={change:T1};for(var i=0;i<S1.parts.length;i++){S1.parts[i].targetType="string";}}}});});},onBeforeRebindTableOrChart:A1,formatDraftLockText:B1,showDraftPopover:function(e,i){C1().then(function(j){var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}});},getContentDensityClass:function(){return r.oApplication.getContentDensityClass();},attachControlToView:A,getDialogFragment:H,getDialogFragmentAsync:I,fnProcessDataLossOrDraftDiscardConfirmation:E1,processDataLossTechnicalErrorConfirmation:D1,securedExecution:F1,getOwnerControl:h1,getTableOrListBindingInfo:k1,refreshSmartTable:l1,refreshModel:n1,refreshSmartList:m1,getElementCustomData:V,getSmartListBindingInfo:j1,triggerAction:function(e,i,j,k,P1){E1(function(){r.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:""}).then(function(Q1){if(Q1&&Q1.length>0){var R1=Q1[0];if(R1.response&&R1.response.context&&(!R1.actionContext||R1.actionContext&&R1.response.context.getPath()!==R1.actionContext.getPath())){r.oApplication.getBusyHelper().getUnbusy().then(r.oViewDependencyHelper.setMeToDirty.bind(null,q.getOwnerComponent(),i));}}});},Function.prototype,P1,"Proceed");},checkToolbarIntentsSupported:I1,executeIfControlReady:J1,getControlInformation:y,executeForAllInformationObjects:z,setControlSortOrder:K1,invokeActionsForExtensionAPI:M1,filterUpdatableContexts:b1,setExternalChevronRefreshBehaviour:N1,setComponentRefreshBehaviour:O1};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,i,j){d(this,p(e,i,j));}});});
