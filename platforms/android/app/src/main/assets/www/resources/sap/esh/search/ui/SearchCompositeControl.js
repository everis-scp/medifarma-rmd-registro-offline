/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["./error/errors","./error/ErrorHandler","sap/esh/search/ui/i18n","sap/esh/search/ui/controls/SearchFieldGroup","sap/esh/search/ui/SearchShellHelperAndModuleLoader","sap/esh/search/ui/SearchModel","sap/esh/search/ui/container/ComponentService","sap/esh/search/ui/controls/SearchLayout","sap/esh/search/ui/controls/SearchLayoutResponsive","sap/esh/search/ui/controls/SearchResultListContainer","sap/esh/search/ui/controls/SearchResultList","sap/esh/search/ui/controls/SearchResultTable","sap/esh/search/ui/controls/SearchResultGrid","sap/esh/search/ui/controls/SearchSpreadsheet","sap/esh/search/ui/controls/SearchNoResultScreen","sap/esh/search/ui/SearchHelper","sap/esh/search/ui/controls/SearchText","sap/esh/search/ui/controls/SearchLink","sap/esh/search/ui/controls/SearchCountBreadcrumbs","sap/esh/search/ui/controls/SearchResultMap","sap/esh/search/ui/controls/SearchResultListItem","sap/esh/search/ui/controls/CustomSearchResultListItem","sap/esh/search/ui/controls/SearchTileHighlighter","sap/esh/search/ui/controls/SearchFilterBar","sap/esh/search/ui/controls/SearchFacetFilter","sap/esh/search/ui/controls/DivContainer","sap/ui/core/Control","sap/ui/core/InvisibleText","sap/ui/core/Icon","sap/ui/core/IconPool","sap/ui/core/delegate/ItemNavigation","sap/ui/layout/VerticalLayout","sap/ui/model/BindingMode","sap/m/Button","sap/m/ButtonType","sap/m/PlacementType","sap/m/ToolbarDesign","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/ToggleButton","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/OverflowToolbarPriority","sap/m/OverflowToolbar","sap/m/ToolbarSeparator","sap/m/Label","sap/m/Text","sap/m/Column","sap/m/ColumnListItem","sap/m/CustomListItem","sap/m/TablePersoController","sap/m/ListMode","sap/m/ListType","sap/m/PopinDisplay","sap/m/ActionSheet","sap/m/FlexBox","sap/m/FlexJustifyContent","sap/m/GenericTile","sap/m/TileContent","sap/m/BusyDialog","sap/m/ViewSettingsDialog","sap/m/ViewSettingsItem","sap/m/PopinLayout","sap/m/Page","sap/m/MessagePopover","sap/m/MessageItem","sap/m/HBox","sap/m/VerticalPlacementType","sap/f/GridContainer","sap/f/GridContainerSettings","sap/f/GridContainerItemLayoutData","sap/esh/search/ui/controls/SearchTilesContainer","sap/m/TablePersoController","sap/ui/vbm/AnalyticMap","sap/ui/vbm/Spot",],function(e,E,a,S,b,c,C,d,f,g,h,j,k,m,n,o,p,q,r,s,t,u,v,w,x,D,y,I,z,A,B,V,F,G,H,P,T,J,K,L,M,O,N,Q,R,U,W,X,Y,Z,_,a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,m1,n1,o1,p1,q1,r1,s1,t1,u1){("use strict");return y.extend("sap.esh.search.ui.SearchCompositeControl",{metadata:{library:"sap.esh",properties:{cssClass:"string",searchTerm:{type:"string",group:"Misc",defaultValue:"*",},searchOnStart:{type:"boolean",group:"Behavior",defaultValue:true,},},aggregations:{content:{singularName:"content",multiple:true,},},},eshCompCounter:0,subscribeDone_SearchFinished:false,constructor:function(i,l){var l1=this;this.errorHandler=new E({model:null,});try{if(typeof i==="string"&&i.length>0&&typeof l.id!=="undefined"){if(i!==l.id){var v1=new Error("Constructor of component 'sap.esh.search.ui.SearchCompositeControl' has failed\n\n"+"sId and mSettings.id are not the same. It is sufficient to set either 'id' (sId) or 'settings.id' (mSettings.id).");var w1=new e.ESHUIConstructionError(v1);l1.errorHandler.onError(w1);}}if(typeof i!=="string"&&i!==undefined&&l===undefined){l=i;i=l&&l.id;}else if(typeof l==="undefined"){l={};}if(typeof i==="string"&&i.length>0){l.id=i;}if(!i||i.length===0){i="eshComp"+"GenId_"+this.eshCompCounter++;l.id=i;}l1.options=l;var x1=l1.getMetadata().getProperties();l1.metadataOptions={};for(var y1 in x1){if(l1.options[y1]!=="undefined"){l1.metadataOptions[y1]=l1.options[y1];}}l1.metadataOptions=jQuery.extend({},{content:[],},l1.metadataOptions);y.prototype.constructor.apply(l1,[i,l1.metadataOptions]);l1.addStyleClass("sapUshellSearchInputHelpPage");this.oFocusHandler=new o.SearchFocusHandler(this);var z1=l1.options.model&&l1.options.model.config.isUshell;if(!z1){C.init();}try{var A1=l1.options.model||l1.getModel("searchModel");if(!A1){A1=new c({configuration:l1.options,});l1.setModel(A1,"searchModel");}A1.isSearchCompositeControl=true;A1.focusHandler=this.oFocusHandler;l1.setModel(A1);l1.setModel(sap.esh.search.ui.resources.i18nModel,"i18n");l1.createContent();}catch(v1){var w1=new e.ESHUIConstructionError(v1);l1.errorHandler.onError(w1);}l1.getModel().searchUrlParser.parse().then(function(){l1.getModel().initBusinessObjSearch().then(function(){var B1=l1.getModel().getSearchBoxTerm();if(B1===""){B1=l1.getSearchTerm();l1.getModel().setSearchBoxTerm(B1,false);}if(l1.getSearchOnStart()){l1.getModel()._firePerspectiveQuery();}});});}catch(v1){l1.errorHandler.onError(v1);}},exit:function(){var i=this;if(this.oErrorPopover){this.oErrorPopover.destroy();}i.oModel.unsubscribe("ESHSearchFinished",i.onAllSearchFinished,i);},renderer:function(l,l1){l.write("<div");l.writeControlData(l1);l.addClass(l1.getCssClass());l.writeClasses();l.write('style="width: 100%; height: 100%;"');l.write(">");var v1=l1.getContent();for(var i=0;i<v1.length;i++){l.renderControl(v1[i]);}l.write("</div>");},createContent:function(){var i=this;i.oSearchFieldGroup=new S(this.getId()+"-searchInputHelpPageSearchFieldGroup");i.oSearchFieldGroup.setCancelButtonActive(false);i.oSearchFieldGroup.addStyleClass("sapUshellSearchInputHelpPageSearchFieldGroup");i.oSearchFieldGroup.input.setShowValueHelp(false);i.getModel().setProperty("/inputHelp",i.oSearchFieldGroup.input);if(!i.subscribeDone_SearchFinished&&i.getModel&&i.getModel()&&i.getModel().subscribe){i.getModel().subscribe("ESHSearchFinished",i.onAllSearchFinished,i);i.subscribeDone_SearchFinished=true;}if(i.getModel&&i.getModel()){i.getModel().subscribe("ESHSearchFinished",function(){i.oSearchFieldGroup.input.setValue(i.getModel().getSearchBoxTerm());},i);}i.oSearchBar=new M("",{visible:{parts:["/count","/facetVisibility"],formatter:function(l1,v1){if(v1){return l1!==0||i.getModel().config.searchBarDoNotHideForNoResults;}return l1!==0||i.getModel().config.searchBarDoNotHideForNoResults;},},contentLeft:[i.assembleFilterButton(),i.assembleDataSourceTapStrips()],contentRight:i.assembleSearchToolbar(),});i.oSearchBar.addStyleClass("sapUshellSearchBar");i.oFilterBar=new w("");if(i.getModel().config.layoutWithoutPage){i.oSearchPage=i.createSearchFloorplan(i.getId());}else{var l=new n1(this.getId()+"-searchPage",{customHeader:this.oSearchBar,subHeader:this.oFilterBar,content:[i.createSearchContainer(i.getId())],enableScrolling:true,showFooter:{parts:["/errors/length"],formatter:function(l1){return l1>0;},},showHeader:true,showSubHeader:{parts:["/facetVisibility","/uiFilter/rootCondition"],formatter:function(l1,v1){if((!l1||i.getModel().config.searchFilterBarShowWithFacets)&&v1&&v1.hasFilters()){return true;}return false;},},});l.setFooter(i.createFooter(i.getId()));l.addStyleClass("sapUshellSearchInputHelpPageSearchPage");i.oSearchPage=l;}i.addContent(i.oSearchFieldGroup);i.addContent(i.oSearchPage);},onAfterRendering:function(){var i=this;if(!i.subscribeDone_SearchFinished&&i.getModel&&i.getModel()&&i.getModel().subscribe){i.getModel().subscribe("ESHSearchFinished",i.onAllSearchFinished,i);i.subscribeDone_SearchFinished=true;}},assembleFilterButton:function(){var i=this;var l=new L(this.getId()+"-searchBarFilterButton",{icon:A.getIconURI("filter"),tooltip:{parts:["/facetVisibility"],formatter:function(l1){return l1?sap.esh.search.ui.resources.i18n.getText("hideFacetBtn_tooltip"):sap.esh.search.ui.resources.i18n.getText("showFacetBtn_tooltip");},},pressed:"{/facetVisibility}",press:function(){if(l.getPressed()){i.searchLayout.setAnimateFacetTransition(true);i.getModel().setFacetVisibility(true);i.searchLayout.setAnimateFacetTransition(false);}else{i.searchLayout.setAnimateFacetTransition(true);i.getModel().setFacetVisibility(false);i.searchLayout.setAnimateFacetTransition(false);}},visible:{parts:["/businessObjSearchEnabled","/count"],formatter:function(l1,v1){if(v1===0){return false;}return!sap.ui.Device.system.phone&&l1;},},});l.addStyleClass("searchBarFilterButton");return l;},assembleCountLabel:function(){var l=new r();return l;},assembleCountHiddenElement:function(){var i=new I("",{text:{parts:["/count","/nlqSuccess","/nlqDescription"],formatter:function(l,l1,v1){if(l1){return v1;}if(typeof l!=="number"){return"";}return sap.esh.search.ui.resources.i18n.getText("results_count_for_screenreaders",[l.toString()]);},},});return i;},assembleSearchToolbar:function(){var i=this;var l=new G((i.getId()?i.getId()+"-":"")+"dataExportButton",{icon:"sap-icon://download",tooltip:"{i18n>exportData}",type:H.Transparent,visible:{parts:["/displaySwitchVisibility","/count"],formatter:function(C1,D1){return C1&&D1!==0;},},press:function(){if(i.searchSpreadsheet===undefined){i.searchSpreadsheet=new m("ushell-search-spreadsheet");}i.searchSpreadsheet.onExport();},}).addStyleClass("sapUshellSearchTableDataExportButton");var l1=i.assembleDisplaySwitchTapStrips();var v1=new G("",{icon:"sap-icon://sort",tooltip:"{i18n>sortTable}",type:H.Transparent,visible:{parts:["/displaySwitchVisibility","/count","/tableSortableColumns"],formatter:function(C1,D1,E1){return C1&&D1!==0&&E1.length>1;},},press:function(){i.tableSortDialog.open();},});v1.addStyleClass("sapUshellSearchTableSortButton");l1.addEventDelegate({onAfterRendering:function(C1){var D1=C1.srcControl;var E1=2;if(!i.getModel().config.gridView){E1--;}if(i.getModel().config.hideListView){E1--;}if(D1.getItems().length===E1&&i.determineIfMaps(i)){D1.addItem(new K("",{icon:"sap-icon://map",tooltip:sap.esh.search.ui.resources.i18n.getText("displayMap"),key:"map",}));}else if(D1.getItems().length===E1+1&&!i.determineIfMaps(i)){D1.removeItem(D1.getItems()[E1]);if(i.getModel().getProperty("/resultToDisplay")==="searchResultMap"){i.getModel().setProperty("/resultToDisplay","searchResultList");}}},});l1.addStyleClass("sapUshellSearchResultDisplaySwitch");var w1=new R("",{visible:{parts:["/displaySwitchVisibility","/count"],formatter:function(C1,D1){return C1&&D1!==0;},},});var x1=new G((i.getId()?i.getId()+"-":"")+"tablePersonalizeButton",{icon:"sap-icon://action-settings",tooltip:"{i18n>personalizeTable}",type:H.Transparent,enabled:{parts:["/resultToDisplay"],formatter:function(C1){return C1==="searchResultTable";},},visible:{parts:["/displaySwitchVisibility","/count","/tableSortableColumns"],formatter:function(C1,D1,E1){return C1&&D1!==0&&E1.length>1;},},press:function(){i.oTablePersoController.openDialog();},});x1.addStyleClass("sapUshellSearchTablePersonalizeButton");var y1=[];var z1=this.getModel().config.isUshell;if(z1){var A1=this.assembleShareButton();y1=[l,v1,x1,A1,w1,l1,];}else{y1=[l,v1,x1,w1,l1,];}var B1=i.getModel().config.getCustomToolbar();if(B1.length>0){B1.push(new R("",{visible:{parts:["/displaySwitchVisibility","/count"],formatter:function(C1,D1){return C1&&D1!==0;},},}));}y1=B1.concat(y1);return y1;},assembleShareButton:function(){var i=this;var l=new sap.ushell.ui.footerbar.AddBookmarkButton("",{beforePressHandler:function(){var x1={url:document.URL,title:i.getModel().getDocumentTitle(),icon:A.getIconURI("search"),};l.setAppData(x1);},});l.setWidth("auto");var l1=new G();l1.setIcon("sap-icon://email");l1.setText(sap.esh.search.ui.resources.i18n.getText("eMailFld"));l1.attachPress(function(){sap.m.URLHelper.triggerEmail(null,i.getModel().getDocumentTitle(),document.URL);});l1.setWidth("auto");var v1=new d1("",{placement:P.Bottom,buttons:[l,l1],});var w1=new G("",{icon:"sap-icon://action",tooltip:sap.esh.search.ui.resources.i18n.getText("shareBtn"),press:function(){v1.openBy(w1);},});return w1;},assembleDataSourceTapStrips:function(){var l=this;var l1=new Q("",{design:T.Transparent,visible:{parts:["/facetVisibility","/count","/businessObjSearchEnabled"],formatter:function(i,w1,x1){return!i&&w1>0&&x1;},},});l1.data("sap-ui-fastnavgroup","false",true);l1.addStyleClass("searchTabStrips");l.tabBar=l1;var v1=new I("",{text:"Data Sources",}).toStatic();l1.addDependent(v1);l1.addAriaLabelledBy(v1);l1.bindAggregation("content",{path:"/tabStrips/strips",factory:function(w1,x1){var y1=new L("",{text:"{labelPlural}",type:{parts:["/tabStrips/selected"],formatter:function(i){return H.Transparent;},},pressed:{parts:["/tabStrips/selected"],formatter:function(i){var A1=this.getBindingContext().getObject();return A1===i;},},press:function(){if(l.getModel().config.searchScopeWithoutAll){return;}y1.setType(H.Transparent);if(y1.getBindingContext().getObject()===l.getModel().getProperty("/tabStrips/selected")){y1.setPressed(true);return;}var A1=(l.tabBar.getContent());for(var i=0;i<A1.length;i++){if(A1[i].getId()!==this.getId()){A1[i].setType(H.Transparent);if(A1[i].getPressed()===true){A1[i].setPressed(false);}}}l.getModel().setDataSource(y1.getBindingContext().getObject());},});var z1=new I("",{text:x1.getProperty("labelPlural")+", "+sap.esh.search.ui.resources.i18n.getText("dataSource"),}).toStatic();y1.addAriaLabelledBy(z1);y1.addDependent(z1);return y1;},});l1._setupItemNavigation=function(){if(!this.theItemNavigation){this.theItemNavigation=new B();this.addDelegate(this.theItemNavigation);}this.theItemNavigation.setCycling(false);this.theItemNavigation.setRootDomRef(this.getDomRef());var w1=[];var x1=this.getContent();for(var i=0;i<x1.length;i++){if(!$(x1[i].getDomRef()).attr("tabindex")){var y1="-1";if(x1[i].getPressed&&x1[i].getPressed()){y1="0";}$(x1[i].getDomRef()).attr("tabindex",y1);}w1.push(x1[i].getDomRef());}var z1=l1.getAggregation("_overflowButton");if(z1&&z1.getDomRef){var A1=z1.getDomRef();w1.push(A1);$(A1).attr("tabindex","-1");}this.theItemNavigation.setItemDomRefs(w1);};return l1;},determineIfMaps:function(l){var l1=false;if(l.getModel()){if(l.getModel().config.maps===true){l1=true;}else if(l.getModel().config.maps===false){l1=false;}else{var v1=l.getModel().getDataSource();if(typeof v1!=="undefined"&&v1.attributesMetadata){var w1=v1.attributesMetadata;for(var i=0;i<w1.length;i++){var x1=w1[i].type;if(x1==="GeoJson"){l1=true;break;}}}}}return l1;},assembleDisplaySwitchTapStrips:function(){var i=this;var l=[new K("",{icon:"sap-icon://list",tooltip:sap.esh.search.ui.resources.i18n.getText("displayList"),key:"list",visible:"{=!${/config/hideListView}}",}),new K("",{icon:"sap-icon://table-view",tooltip:sap.esh.search.ui.resources.i18n.getText("displayTable"),key:"table",}),new K("",{icon:"sap-icon://grid",tooltip:sap.esh.search.ui.resources.i18n.getText("displayGrid"),key:"grid",visible:"{/config/gridView}",}),];if(i.determineIfMaps(i)){l.push(new K("",{icon:"sap-icon://map",tooltip:sap.esh.search.ui.resources.i18n.getText("displayMap"),key:"map",}));}if(i.getModel().config.defaultResultViewType==="searchResultTable"){var l1=l[0];l.splice(3,0,l1);l.splice(0,1);}var v1=new J(this.getId()+"-ResultViewType",{selectedKey:{parts:["/resultToDisplay"],formatter:function(w1){var x1="list";if(w1==="searchResultTable"){x1="table";}else if(w1==="searchResultGrid"){x1="grid";}else if(w1==="searchResultList"){x1="list";}else if(w1==="searchResultMap"){x1="map";}return x1;},},items:l,visible:{parts:["/displaySwitchVisibility","/count"],formatter:function(w1,x1){return w1&&x1!==0;},},selectionChange:function(w1){var x1=w1.getParameter("item").getKey();var y1=i.getModel();switch(x1){case"list":y1.setResultToDisplay("searchResultList");i.showMoreFooter.setVisible(i.isShowMoreFooterVisible());i.searchResultMap.setVisible(false);break;case"table":y1.setResultToDisplay("searchResultTable");i.showMoreFooter.setVisible(i.isShowMoreFooterVisible());i.searchResultMap.setVisible(false);break;case"grid":y1.setResultToDisplay("searchResultGrid");i.showMoreFooter.setVisible(i.isShowMoreFooterVisible());i.searchResultMap.setVisible(false);break;case"map":y1.setResultToDisplay("searchResultMap");i.showMoreFooter.setVisible(i.isShowMoreFooterVisible());break;default:y1.setResultToDisplay("searchResultList");i.showMoreFooter.setVisible(i.isShowMoreFooterVisible());}y1.enableOrDisableMultiSelection();y1._firePerspectiveQuery();}.bind(this),});v1.addStyleClass("sapUshellSearchDisplaySwitchTapStrips");return v1;},isShowMoreFooterVisible:function(){var i=this.getModel();return i.getProperty("/boCount")>i.getProperty("/boResults").length;},assembleCenterArea:function(i){var l=this;l.tableSortDialog=l.assembleSearchResultSortDialog();var l1=l.assembleSearchResultList();l.searchResultTable=l.assembleSearchResultTable(i);l.searchResultTable.addDelegate({onBeforeRendering:function(){l.updateTableLayout();},onAfterRendering:function(){var v1=$(l.searchResultTable.getDomRef()).find("table > thead > tr:first");if(v1){v1.attr("aria-labelledby",l.totalCountHiddenElement.getId());}},});l.searchResultGrid=l.assembleSearchResultGrid();l.searchResultMap=l.assembleSearchResultMap();l.searchResultMap.setVisible(false);l.appSearchResult=l.assembleAppSearch();l.showMoreFooter=l.assembleShowMoreFooter();return[l.tableSortDialog,l1,l.searchResultTable,l.searchResultGrid,l.searchResultMap,l.appSearchResult,l.showMoreFooter,l.totalCountHiddenElement,];},assembleSearchResultSortDialog:function(){var l=this;var l1=new j1("",{sortDescending:{parts:["/orderBy"],formatter:function(i){return jQuery.isEmptyObject(i)||i.sortOrder==="DESC";},},confirm:function(i){var v1=[];v1=i.getParameters();if(v1.sortItem){var w1=l.getModel();if(v1.sortItem.getKey()==="searchSortableColumnKeyDefault"){w1.resetOrderBy();l1.setSortDescending(true);}else{w1.setOrderBy({orderBy:v1.sortItem.getBindingContext().getObject().attributeId,sortOrder:v1.sortDescending===true?"DESC":"ASC",});}}},cancel:function(){var v1=l.getModel().getOrderBy().sortOrder;var w1=l.getModel().getOrderBy().orderBy;if(v1===undefined||w1===undefined){l1.setSortDescending(true);l1.setSelectedSortItem("searchSortableColumnKeyDefault");return;}if(v1.toLowerCase()==="asc"){l1.setSortDescending(false);}else{l1.setSortDescending(true);}var x1="searchSortableColumnKeyDefault";for(var i=0;i<l1.getSortItems().length;i++){var y1=l1.getSortItems()[i];if(y1.getBindingContext().getObject().attributeId===w1){x1=y1.getKey();break;}}l1.setSelectedSortItem(x1);},resetFilters:function(){var v1=l.getModel().getProperty("/tableSortableColumns");for(var i=0;i<v1.length;++i){var w1=v1[i];if(w1.key==="searchSortableColumnKeyDefault"){w1.selected=true;}else{w1.selected=false;}}l.getModel().setProperty("/tableSortableColumns",v1);},});l1.bindAggregation("sortItems",{path:"/tableSortableColumns",factory:function(){return new k1("",{key:"{key}",text:"{name}",selected:"{selected}",});},});return l1;},assembleSearchResultGrid:function(){var i;if(this.getModel().config.customGridView){i=this.getModel().config.customGridView();}else{var l=new t1("",{rowSize:"11rem",columnSize:"11rem",gap:"0.5rem",});i=new k(this.getId()+"-ushell-search-result-grid",{layout:l,snapToRow:true,});}i.bindProperty("visible",{parts:["/resultToDisplay","/count"],formatter:function(l1,v1){return l1==="searchResultGrid"&&v1!==0;},});i.addStyleClass("sapUshellSearchGrid");return i;},assembleSearchResultTable:function(i){var l=this;var l1=new j(i+"-ushell-search-result-table",{mode:{parts:["/multiSelectionEnabled"],formatter:function(v1){return v1===true?a1.MultiSelect:a1.None;},},noDataText:"{i18n>noCloumnsSelected}",visible:{parts:["/resultToDisplay","/count"],formatter:function(v1,w1){return v1==="searchResultTable"&&w1!==0;},},popinLayout:m1.GridLarge,rememberSelections:false,selectionChange:function(){l.getModel().updateMultiSelectionSelected();},});l1.bindAggregation("columns","/tableColumns",function(v1,w1){var x1=w1.getObject();var y1=new X(i+"-"+x1.key,{header:new U("",{text:"{name}",tooltip:"{name}",}),visible:{parts:["index","attributeId"],formatter:function(z1,A1){if(l.getModel().config.extendTableColumn){return(z1<7||A1===l.getModel().config.extendTableColumn.column.attributeId);}return z1<6;},},width:"{width}",});return y1;});l1.bindAggregation("items","/tableResults",function(v1,w1){return l.assembleTableItems(w1);});l1.addEventDelegate({onAfterRendering:function(){l.updatePersoServiceAndController();var v1=$(this.getDomRef());v1.find("table tbody tr").each(function(){var w1=$(this);var x1=sap.ui.getCore().byId(w1.attr("id"));if(x1){var y1=x1.getAriaLabelledBy();if($.inArray(l.totalCountHiddenElement.getId(),y1)===-1){x1.addAriaLabelledBy(l.totalCountHiddenElement);}}return false;});}.bind(l1),});return l1;},assembleTableItems:function(i){var l=this;var l1=i.getObject();if(l1.type==="footer"){return new Z("",{visible:false,});}return l.assembleTableMainItems(l1,i.getPath());},assembleTableMainItems:function(l,l1){var v1=this;var w1=l1+"/cells";var x1=new Y("",{selected:"{selected}",}).addStyleClass("sapUshellSearchTable");x1.bindAggregation("cells",{path:w1,factory:function(w1,y1){if(y1.getObject().isTitle){var z1="";var A1=void 0;var B1=y1.getObject().titleNavigation;if(B1){z1=B1.getHref();A1=B1.getTarget();}var C1=!!(z1&&z1.length>0);var D1=new q({text:"{value}",tooltip:"{value}",enabled:C1,press:function(){var B1=y1.getObject().titleNavigation;if(B1){B1.performNavigation({trackingOnly:true,});}},});D1.setHref(z1);D1.setTooltip(D1.getText());var E1=y1.getObject().titleIconUrl;if(E1){var F1=new z("",{src:E1,});D1.setAggregation("icon",F1);}D1.addStyleClass("sapUshellSearchResultListItem-MightOverflow");D1.addStyleClass("sapUshellSearchTableTitleLink");if(A1){D1.setTarget(A1);}var G1=D1;var H1=y1.getObject().titleInfoIconUrl;if(H1){var I1=new z("",{src:H1,tooltip:sap.esh.search.ui.resources.i18n.getText("collectionShared"),}).addStyleClass("sapUshellSearchTableTitleInfoIcon");G1=new q1("",{items:[D1,I1],});}return G1;}else if(y1.getObject().isRelatedApps){var J1=y1.getObject().navigationObjects;var K1=[];var L1={};var M1=function(Q1,N1){N1.performNavigation();};for(var i=0;i<J1.length;i++){var N1=J1[i];L1=new G("",{text:N1.getText(),tooltip:N1.getText(),});L1.attachPress(N1,M1);K1.push(L1);}return new G("",{icon:"sap-icon://action",press:function(){var Q1=new d1("",{buttons:K1,placement:P.Auto,});Q1.openBy(this);},});}else if(y1.getObject().isExtendTableColumnCell){return v1.getModel().config.extendTableColumn.bindingFunction(y1.getObject());}var O1=new p({text:"{value}",isForwardEllipsis4Whyfound:true,}).addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(y1.getObject().icon){var P1=new z("",{src:y1.getObject().icon,});O1.setAggregation("icon",P1);}return O1;},});return x1;},assembleSearchResultMap:function(){var i=new s({visible:{parts:["/resultToDisplay","/count"],formatter:function(l,l1){return l==="searchResultMap"&&l1!==0;},},});return i;},assembleShowMoreFooter:function(){var i=this;var l=new G("",{text:"{i18n>showMore}",type:H.Transparent,press:function(){var v1=i.getModel();v1.setProperty("/focusIndex",v1.getTop());var w1=v1.getTop()+v1.pageSize;v1.setTop(w1);v1.eventLogger.logEvent({type:v1.eventLogger.SHOW_MORE,});},});l.addStyleClass("sapUshellResultListMoreFooter");var l1=new e1("",{visible:{parts:["/boCount","/boResults"],formatter:function(v1,w1){return w1.length<v1;},},justifyContent:f1.Center,});l1.addStyleClass("sapUshellResultListMoreFooterContainer");l1.addItem(l);return l1;},assembleSearchResultList:function(){var i=this;i.resultList=new h({mode:a1.None,width:"auto",showNoData:false,visible:{parts:["/resultToDisplay","/count"],formatter:function(l,l1){return l==="searchResultList"&&l1!==0;},},});i.resultList.bindAggregation("items","/results",function(l,l1){return i.assembleListItem(l1);});return i.resultList;},assembleAppSearch:function(){var i=this;var l=new t1("",{rowSize:"5.5rem",columnSize:"5.5rem",gap:"0.25rem",});var l1=sap.ushell.Container.getService("VisualizationInstantiation");var v1=new s1("",{layout:l,snapToRow:true,visible:{parts:["/resultToDisplay","/count"],formatter:function(y1,z1){return y1==="appSearchResult"&&z1!==0;},},items:{path:"/appResults",factory:function(id,y1){if(i.getModel().getResultToDisplay()==="appSearchResult"){var z1=y1.getObject();var A1=z1.visualization;var B1=l1.instantiateVisualization(A1);B1.attachPress(function(){i.getModel().eventLogger.logEvent({type:i.getModel().eventLogger.TILE_NAVIGATE,tileTitle:A1.title,targetUrl:A1.targetURL,});});B1.addEventDelegate({onAfterRendering:i.highlightTile,});B1.setActive(false,true);B1.setLayoutData(new u1(B1.getLayout()));return B1;}return new W("",{text:"",});},},});v1.addStyleClass("sapUshellSearchGridContainer");var w1=new G("",{text:"{i18n>showMore}",type:H.Transparent,visible:{parts:["/resultToDisplay","/appCount","/appResults"],formatter:function(y1,z1,A1){return y1==="appSearchResult"&&A1.length<z1;},},press:function(){var y1=i.getModel();var z1=y1.getTop()+y1.pageSize;y1.setProperty("/focusIndex",y1.getTop());y1.setTop(z1);y1.eventLogger.logEvent({type:y1.eventLogger.SHOW_MORE,});},});w1.addStyleClass("sapUshellResultListMoreFooter");var x1=new V("",{width:"100%",visible:{parts:["/resultToDisplay","/count"],formatter:function(y1,z1){return y1==="appSearchResult"&&z1!==0;},},content:[v1,w1],});x1.addStyleClass("sapUshellResultApps");return x1;},highlightTile:function(i){var l=i.srcControl.getAggregation("content");if(l){var l1=l.findAggregatedObjects(true,function(x1){return x1.isA("sap.m.GenericTile")||x1.isA("sap.f.Card");});if(l1.length===0&&l.getComponentInstance){l1=l.getComponentInstance().findAggregatedObjects(true,function(x1){return x1.isA("sap.m.GenericTile")||x1.isA("sap.f.Card");});}if(l1.length>0){var v1=l1[0];var w1=new v();w1.setHighlightTerms(i.srcControl.getModel().getProperty("/uiFilter/searchTerm"));w1.highlight(v1);}}},assembleAppContainerResultListItem:function(){var l1=this;var l=new t1("",{rowSize:"5.5rem",columnSize:"5.5rem",gap:"0.25rem",});var v1=sap.ushell.Container.getService("VisualizationInstantiation");var w1=new s1("",{layout:l,snapToRow:true,items:{path:"/appResults",factory:function(i,y1){if(l1.getModel().getResultToDisplay()!=="appSearchResult"){var z1=y1.getObject();var A1=z1.visualization;var B1=v1.instantiateVisualization(A1);B1.attachPress(function(){l1.getModel().eventLogger.logEvent({type:l1.getModel().eventLogger.TILE_NAVIGATE,tileTitle:A1.title,targetUrl:A1.targetURL,});});B1.addEventDelegate({onAfterRendering:l1.highlightTile,});B1.setActive(false,true);B1.setLayoutData(new u1(B1.getLayout()));return B1;}return new W(i,{text:"",});},},});w1.addStyleClass("sapUshellSearchGridContainer");w1.addEventDelegate({onAfterRendering:function(){var l1=this;if(l1.getDomRef().clientWidth===0){return;}var y1=l1.getDomRef().clientWidth-176;var z1=Math.floor(y1/184);var A1=l1.getItems();var B1=l1.getModel().getProperty("/appCount");var C1=l1.getModel().getProperty("/boCount");if(A1.length>z1+1){var D1=0,i=0;for(;i<A1.length;i++){D1=D1+A1[i].getDomRef().clientWidth+8;if(D1>y1){break;}}var E1=l1.getModel().getProperty("/appResults");l1.getModel().setProperty("/appResults",E1.slice(0,i));}else{var F1=A1[A1.length-1];if(B1>z1&&!F1.hasStyleClass("sapUshellSearchResultListItemAppsShowMore")){var G1=new g1("",{tileContent:new h1("",{content:new W("",{text:sap.ushell.resources.i18n.getText("showMoreApps"),}),}),press:function(){var H1=l1.getModel();H1.setDataSource(H1.appDataSource);},});G1.addStyleClass("sapUshellSearchResultListItemAppsShowMore");l1.addItem(G1);l1.getModel().setProperty("/resultToDisplay","appSearchResult");l1.getModel().setProperty("/resultToDisplay","searchResultList");l1.getModel().setProperty("/boCount",0);l1.getModel().setProperty("/boCount",C1);}}},},w1);var x1=new Z("",{content:w1,});x1.addStyleClass("sapUshellSearchResultListItem");x1.addStyleClass("sapUshellSearchResultListItemApps");x1.addEventDelegate({onAfterRendering:function(){var i=$(x1.getDomRef());i.removeAttr("tabindex");i.removeAttr("role");i.attr("aria-hidden","true");},},x1);return x1;},assembleResultListItem:function(i){var l=this;var l1=this.getModel().config.getDataSourceConfig(i.dataSource);var v1={dataSource:i.dataSource,title:"{title}",titleDescription:"{titleDescription}",titleNavigation:"{titleNavigation}",type:"{dataSourceName}",imageUrl:"{imageUrl}",imageFormat:"{imageFormat}",imageNavigation:"{imageNavigation}",geoJson:"{geoJson}",attributes:"{itemattributes}",navigationObjects:"{navigationObjects}",selected:"{selected}",expanded:"{expanded}",positionInList:"{positionInList}",resultSetId:"{resultSetId}",layoutCache:"{layoutCache}",titleIconUrl:"{titleIconUrl}",titleInfoIconUrl:"{titleInfoIconUrl}",};var w1;if(l1.searchResultListItemControl){w1=new l1.searchResultListItemControl(v1);}else if(l1.searchResultListItemContentControl){v1.content=new l1.searchResultListItemContentControl();w1=new u(v1);}else{w1=new t(v1);}if(w1.setTotalCountHiddenElement){w1.setTotalCountHiddenElement(l.totalCountHiddenElement);}var x1=new Z("",{content:w1,type:b1.Inactive,});x1.addStyleClass("sapUshellSearchResultListItem");if(w1.setParentListItem){w1.setParentListItem(x1);}return x1;},assembleListItem:function(i){var l=this;var l1=i.getObject();if(l1.type==="title"){return l.assembleTitleItem(l1);}else if(l1.type==="footer"){return new Z();}else if(l1.type==="appcontainer"){return l.assembleAppContainerResultListItem();}return l.assembleResultListItem(l1);},onAllSearchStarted:function(){},onAllSearchFinished:function(){var i=this;i.reorgTabBarSequence();i.oFocusHandler.setFocus();var l=sap.ui.getCore().byId("viewPortContainer");if(l&&l.switchState){l.switchState("Center");}},updatePersoServiceAndController:function(){var i=this;var l=i.getModel();var l1=l.getDataSource().id;var v1="search-result-table-state-"+l1;var w1=i.getId()+"-ushell-search-result-table";var x1=(sap.ui.getCore().byId(w1));if(!i.oTablePersoController){var y1=l.getPersonalizationStorageInstance();var z1=l.config.isUshell?"sap.ushell.renderers.fiori2.search.container":"";i.oTablePersoController=new _("",{table:x1,persoService:y1.getPersonalizer(v1),componentName:z1,}).activate();i.oTablePersoController.refresh();}if((i.oTablePersoController&&i.oTablePersoController.getPersoService().getKey()!==v1)||i.sTableMode!=x1.getMode()){i.oTablePersoController.setPersoService(l.getPersonalizationStorageInstance().getPersonalizer(v1));i.oTablePersoController.refresh();i.sTableMode=x1.getMode();}},updateTableLayout:function(){var l=this;if(l.searchResultTable&&l.oTablePersoController){var l1=l.getModel().getDataSource().id;var v1="search-result-table-state-"+l1;l.oTablePersoController.getPersoService(v1).getPersData().then(function(w1){if(w1&&w1.aColumns){var x1=w1.aColumns;var y1=this.searchResultTable.getColumns();var z1=0;for(var i=0;i<x1.length;i++){var A1=x1[i].id.split("table-searchColumnKey").pop();var B1=y1[parseInt(A1,10)];if(B1){B1.setDemandPopin(false);if(x1[i].visible){z1++;B1.setDemandPopin(true);B1.setPopinDisplay(c1.Inline);var C1=12*z1;B1.setMinScreenWidth(C1+"rem");}}}if(z1<=3){this.searchResultTable.setFixedLayout(false);}else{this.searchResultTable.setFixedLayout(true);}}}.bind(this));}},createSearchFloorplan:function(i){var l=this;l.oFilterBar.bindProperty("visible",{parts:["/facetVisibility","/uiFilter/rootCondition"],formatter:function(w1,x1){var y1=false;if((!w1||l.getModel().config.searchFilterBarShowWithFacets)&&x1&&x1.hasFilters()){y1=true;}l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanWithMessageToolbarFacetPanelOpen");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanWithMessageToolbar");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplan");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanFacetPanelOpen");if(l.getModel().getProperty("/errors/length")>0){if(y1){l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanWithMessageToolbarFacetPanelOpen");}else{l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanWithMessageToolbar");}y1=true;}else{if(y1){l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanFacetPanelOpen");}else{l.searchContainer.addStyleClass("sapElisaSearchPageFloorplan");}}return y1;},});var l1=l.createFooter(l.getId());l1.bindProperty("visible",{parts:["/errors/length"],formatter:function(w1){var x1=false;l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanWithMessageToolbarFacetPanelOpen");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanWithMessageToolbar");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplan");l.searchContainer.removeStyleClass("sapElisaSearchPageFloorplanFacetPanelOpen");if(w1>0){if(l.getModel().getFacetVisibility()){l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanWithMessageToolbarFacetPanelOpen");}else{l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanWithMessageToolbar");}x1=true;}else{if(l.getModel().getFacetVisibility()){l.searchContainer.addStyleClass("sapElisaSearchPageFloorplanFacetPanelOpen");}else{l.searchContainer.addStyleClass("sapElisaSearchPageFloorplan");}}return x1;},});var v1=new D(i+"-searchPage",{content:[l.oSearchBar,l.oFilterBar,l.createSearchContainer(i),l1,],cssClass:"sapElisaSearchPageFloorplan",});return v1;},createSearchContainer:function(i){var l=this;l.model=l.getModel();l.totalCountHiddenElement=l.assembleCountHiddenElement();l.centerArea=l.assembleCenterArea(i);var l1=new g({id:i+"-searchContainerResultsView",centerArea:l.centerArea,totalCountBar:l.assembleCountLabel(),noResultScreen:new n({searchBoxTerm:{parts:["/queryFilter/searchTerm"],formatter:function(x1){return x1;},},visible:{parts:["/count","/isBusy","/firstSearchWasExecuted"],formatter:function(x1,y1,z1){return x1===0&&!y1&&z1;},},toolbar:[new G({text:sap.esh.search.ui.resources.i18n.getText("noResultsPageBackButton"),visible:"{/config/displayNoResultsPageBackButton}",press:function(){window.history.back();},}).addStyleClass("sapUiTinyMarginEnd"),new G({text:sap.esh.search.ui.resources.i18n.getText("noResultsPageSearchAllButton"),visible:"{/config/displayNoResultsPageSearchAllButton}",press:function(){var x1=l.getModel();x1.resetTop();x1.setSearchBoxTerm("*",false);x1.resetDataSource(false);x1.resetFilterConditions(true);},}),],}),totalCountHiddenElement:l.totalCountHiddenElement,});if(l.getModel().config.layoutUseResponsiveSplitter){var v1=new f(l.getId()+"-searchLayout",{resultListContainer:l1,busyIndicator:new i1(),isBusy:"{/isBusy}",busyDelay:"{/busyDelay}",showFacets:{parts:["/count","/facetVisibility","/uiFilter/rootCondition","/isBusy","/config",],formatter:function(x1,y1,z1,A1,B1){var C1=true;if(!y1){C1=false;}var D1=z1&&z1.conditions&&z1.conditions.length>0;if(x1===0&&!B1.displayFacetPanelInCaseOfNoResults&&!D1&&!A1){C1=false;}return C1;},},facetPanelWidthInPercent:l.getModel().config.facetPanelWidthInPercent,facets:new x({id:l.getId()+"-SearchFacetFilter",}),});v1.addStyleClass("sapUshellSearchLayout");l.searchLayout=v1;}else{var w1=new d(this.getId()+"-searchLayout",{resultListContainer:l1,busyIndicator:new i1(),isBusy:"{/isBusy}",busyDelay:"{/busyDelay}",showFacets:{parts:["/count","/facetVisibility","/uiFilter/rootCondition","/isBusy","/config",],formatter:function(x1,y1,z1,A1,B1){if(!y1){return false;}var C1=z1&&z1.conditions&&z1.conditions.length>0;if(x1===0&&!B1.displayFacetPanelInCaseOfNoResults&&!C1&&!A1){return false;}return true;},},vertical:false,facets:new x({id:l.getId()+"-SearchFacetFilter",}),});w1.addStyleClass("sapUshellSearchLayout");l.searchLayout=w1;}l.searchContainer=new D({content:[l.searchLayout],cssClass:"sapUshellSearchContainer",});return l.searchContainer;},createFooter:function(i){var l=this;l.oModel=l.getModel();if(jQuery.device.is.phone){return;}var l1=new o1(i+"-FooterMessagePopover",{placement:r1.Top,});this.oErrorPopover=l1;l1.setModel(l.oModel);l.oModel.setProperty("/messagePopoverControlId",l1.getId());l1.bindAggregation("items",{path:"/errors",factory:function(){var y1=new p1("",{title:"{title}",description:"{description}",});return y1;},});var v1=new G(this.getId()+"-searchErrorButton",{icon:A.getIconURI("alert"),text:{parts:["/errors/length"],formatter:function(y1){return y1;},},visible:{parts:["/errors/length"],formatter:function(y1){return y1>0;},mode:F.OneWay,},type:H.Emphasized,tooltip:sap.esh.search.ui.resources.i18n.getText("errorBtn"),press:function(){if(l1.isOpen()){l1.close();}else{l1.setVisible(true);l1.openBy(v1);}},});v1.addDelegate({onAfterRendering:function(){if(!l.oModel.getProperty("/isErrorPopovered")){v1.firePress();l.oModel.setProperty("/isErrorPopovered",true);}},});v1.setLayoutData(new O("",{priority:N.NeverOverflow,}));var w1=[v1];var x1=new Q("",{content:w1,});return x1;},reorgTabBarSequence:function(){if(!this.tabBar){return;}var l=new O("",{priority:N.High,});var l1=new O("",{priority:N.NeverOverflow,});var v1=this.tabBar.getContent();for(var i=0;i<v1.length;i++){if(this.getModel().getProperty("/tabStrips/selected")===v1[i].getBindingContext().getObject()){v1[i].setLayoutData(l1);}else{v1[i].setLayoutData(l);}}},onRegionClick:function(){},onRegionContextMenu:function(){},setAppView:function(i){var l=this;l.oAppView=i;if(l.oTilesContainer){l.oTilesContainer.setAppView(i);}},getControllerName:function(){return"sap.esh.search.ui.container.Search";},});});
