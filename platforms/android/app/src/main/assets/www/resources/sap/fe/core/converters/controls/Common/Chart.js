/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["../../ManifestSettings","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/annotations/DataField","../../helpers/ID","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/templating/DataModelPathHelper","../../helpers/Aggregation"],function(M,A,D,I,C,K,a,b){"use strict";var _={};var c=b.AggregationHelper;var g=a.getTargetObjectPath;var d=K.KeyHelper;var e=C.insertCustomElements;var F=I.FilterBarID;var f=I.ChartID;var h=D.isDataFieldForActionAbstract;var j=A.getActionsFromManifest;var T=M.TemplateType;var k=M.ActionType;var V=M.VisualizationType;function l(n,i){return s(n)||r(n,i)||p(n,i)||m();}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function p(o,i){if(!o)return;if(typeof o==="string")return q(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(o,i);}function q(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,x=new Array(o);i<o;i++){x[i]=n[i];}return x;}function r(n,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(n)))return;var o=[];var x=true;var y=false;var z=undefined;try{for(var B=n[Symbol.iterator](),E;!(x=(E=B.next()).done);x=true){o.push(E.value);if(i&&o.length===i)break;}}catch(G){y=true;z=G;}finally{try{if(!x&&B["return"]!=null)B["return"]();}finally{if(y)throw z;}}return o;}function s(i){if(Array.isArray(i))return i;}function t(i,n,o){var x=[];if(i){var y=i.Actions||[];y.forEach(function(z){var B,E,G;var H;if(h(z)&&!(((B=z.annotations)===null||B===void 0?void 0:(E=B.UI)===null||E===void 0?void 0:(G=E.Hidden)===null||G===void 0?void 0:G.valueOf())===true)&&!z.Inline&&!z.Determining){var J=d.generateKeyFromDataField(z);switch(z.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":H={type:k.DataFieldForAction,annotationPath:o.getEntitySetBasedAnnotationPath(z.fullyQualifiedName),key:J};break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":H={type:k.DataFieldForIntentBasedNavigation,annotationPath:o.getEntitySetBasedAnnotationPath(z.fullyQualifiedName),key:J};break;}}if(H){x.push(H);}});}return x;}function u(i,n,o){var x=t(i,n,o);return e(x,j(o.getManifestControlConfiguration(n).actions,o,x),{enableOnSelect:"overwrite",enabled:"overwrite"});}_.getChartActions=u;function v(i,n){var o;var x=n.getManifestWrapper();var y=n.getManifestControlConfiguration(i);var z=["Page","Control"].indexOf(x.getVariantManagement())>-1;var B=true;var P=[];if((y===null||y===void 0?void 0:(o=y.chartSettings)===null||o===void 0?void 0:o.personalization)!==undefined){B=y.chartSettings.personalization;}if(z&&B){if(B===true){return"Sort,Type,Item";}else if(typeof B==="object"){if(B.type){P.push("Type");}if(B.item){P.push("Item");}if(B.sort){P.push("Sort");}return P.join(",");}}return undefined;}_.getP13nMode=v;function w(i,n,o,x){var y,z,B;var E=new c(o.getEntityType(),o);if(!x&&!E.isAnalyticsSupported()){throw new Error("ApplySupported is not added to the annotations");}var G=u(i,n,o);var H=n.split("@"),J=l(H,1),L=J[0];if(L.lastIndexOf("/")===L.length-1){L=L.substr(0,L.length-1);}var N=(y=o.getDataModelObjectPath().targetEntityType.annotations)===null||y===void 0?void 0:(z=y.UI)===null||z===void 0?void 0:(B=z.HeaderInfo)===null||B===void 0?void 0:B.TypeNamePlural;var O=o.getDataModelObjectPath();var P=L.length===0;var Q=O.targetEntitySet?O.targetEntitySet.name:O.startingEntitySet.name;var R=P?F(o.getContextPath()):undefined;var S={"legendGroup":{"layout":{"position":"bottom"}}};return{type:V.Chart,id:f(P?Q:L,V.Chart),collection:g(o.getDataModelObjectPath()),entityName:Q,p13nMode:v(n,o),navigationPath:L,annotationPath:o.getAbsoluteAnnotationPath(n),filterId:R,vizProperties:JSON.stringify(S),actions:G,title:N,autoBindOnInit:o.getTemplateType()===T.ObjectPage};}_.createChartVisualization=w;return _;},false);
