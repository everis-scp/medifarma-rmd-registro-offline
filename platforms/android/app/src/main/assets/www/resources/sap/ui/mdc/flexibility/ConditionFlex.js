/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/util/merge','sap/ui/mdc/condition/FilterOperatorUtil'],function(m,F){"use strict";var d=function(C){var o=C&&C.getEngine?C.getEngine().getController(C,"Filter"):null;return o?o.getFilterControl():null;};var a=function(C,o,b,p,i){var f=d(b);if(f&&f.applyConditionsAfterChangesApplied){f.applyConditionsAfterChangesApplied();}return new Promise(function(e,g){var h,j=null,M=p.modifier;Promise.resolve().then(M.getProperty.bind(M,b,"filterConditions")).then(function(k){h=m({},k);if(h){for(var s in h){if(s===o.name){j=h[s];break;}}}if(!j){h[o.name]=[];j=h[o.name];}var n=F.indexOfCondition(o.condition,j);if(n<0){j.push(o.condition);M.setProperty(b,"filterConditions",h);if(!i){C.setRevertData({name:o.name,condition:o.condition});}if(f&&f.addCondition){return f.addCondition(o.name,o.condition);}}}).then(e).catch(function(E){g(E);});});};var r=function(C,o,b,p,i){var f=d(b);if(f&&f.applyConditionsAfterChangesApplied){f.applyConditionsAfterChangesApplied();}return new Promise(function(e,g){var h,j,n=-1,M=p.modifier;Promise.resolve().then(M.getProperty.bind(M,b,"filterConditions")).then(function(k){h=m({},k);if(h){for(var s in h){if(s===o.name){j=h[s];break;}}}if(j&&(j.length>0)){n=F.indexOfCondition(o.condition,j);if(n>=0){j.splice(n,1);M.setProperty(b,"filterConditions",h);if(!i){C.setRevertData({name:o.name,condition:o.condition});}if(f&&f.removeCondition){return f.removeCondition(o.name,o.condition);}}}}).then(e).catch(function(E){g(E);});});};var c={};c.addCondition={"changeHandler":{applyChange:function(C,o,p){return a(C,C.getContent(),o,p,false);},completeChangeContent:function(C,b,p){},revertChange:function(C,o,p){return r(C,C.getRevertData(),o,p,true).then(function(){C.resetRevertData();});}},"layers":{"USER":true}};c.removeCondition={"changeHandler":{applyChange:function(C,o,p){return r(C,C.getContent(),o,p,false);},completeChangeContent:function(C,b,p){},revertChange:function(C,o,p){return a(C,C.getRevertData(),o,p,true).then(function(){C.resetRevertData();});}},"layers":{"USER":true}};return c;});
