/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/m/ToolbarSeparator","sap/ui/base/ManagedObjectObserver","sap/ui/mdc/actiontoolbar/ActionToolbarActionRenderer","sap/ui/mdc/enum/ActionToolbarActionAlignment"],function(C,T,M,A,a){"use strict";var b=C.extend("sap.ui.mdc.actiontoolbar.ActionToolbarAction",{metadata:{library:"sap.ui.mdc",interfaces:["sap.m.IOverflowToolbarContent"],properties:{layoutInformation:{type:"object",defaultValue:{aggregationName:"end",alignment:a.Begin}}},defaultAggregation:"action",aggregations:{action:{type:"sap.ui.core.Control",multiple:false}},associations:{separators:{type:"sap.m.ToolbarSeparator",multiple:true}},renderer:A}});b.prototype.init=function(){this._bSeparatorBeforeIsVisible=false;this._bSeparatorAfterIsVisible=false;this._oSeparatorBefore=new T({visible:this._bSeparatorBeforeIsVisible});this._oSeparatorAfter=new T({visible:this._bSeparatorAfterIsVisible});this.addAssociation("separators",this._oSeparatorBefore);this.addAssociation("separators",this._oSeparatorAfter);this._oObserver=new M(this._observeChanges.bind(this));this._oObserver.observe(this,{parent:true,properties:["visible"]});};b.prototype.exit=function(){if(this._oSeparatorBefore){this._oSeparatorBefore.destroy();this._oSeparatorBefore=undefined;}if(this._oSeparatorAfter){this._oSeparatorAfter.destroy();this._oSeparatorAfter=undefined;}this._bSeparatorBeforeIsVisible=undefined;this._bSeparatorAfterIsVisible=undefined;};b.prototype.updateSeparators=function(){var s=this.getLayoutInformation().alignment;var c=this.getLayoutInformation().aggregationName;var o=this.getParent();var d=o.getAggregation(c);var e=d.filter(function(i){return!i.isA("sap.ui.mdc.actiontoolbar.ActionToolbarAction")&&i!==this&&i!==this._oSeparatorBefore&&i!==this._oSeparatorAfter;}.bind(this));var f=e.filter(function(i){return d.indexOf(i)>d.indexOf(this)&&i.getVisible();}.bind(this));var g=e.filter(function(i){return d.indexOf(i)<d.indexOf(this)&&i.getVisible();}.bind(this));var S=s===a.End&&!o._aggregationContainsActionSeparatorBefore(c)&&g.length>0;var h=s===a.Begin&&!o._aggregationContainsActionSeparatorAfter(c)&&f.length>0;this._oSeparatorBefore.setVisible(this.getAction()&&this.getAction().getVisible()&&S);this._oSeparatorAfter.setVisible(this.getAction()&&this.getAction().getVisible()&&h);};b.prototype.getSeparatorBefore=function(){return this._oSeparatorBefore;};b.prototype.getSeparatorAfter=function(){return this._oSeparatorAfter;};b.prototype._observeChanges=function(c){if(c.type==="parent"&&c.mutation==="unset"){this.destroy();}if(c.name==="property"&&c.name==="visible"){this.updateSeparators();}};b.prototype._onBeforeEnterOverflow=function(){this._bSeparatorBeforeIsVisible=this._oSeparatorBefore.getVisible();this._bSeparatorAfterIsVisible=this._oSeparatorAfter.getVisible();this._oSeparatorBefore.setVisible(false);this._oSeparatorAfter.setVisible(false);};b.prototype._onAfterExitOverflow=function(){this._oSeparatorBefore.setVisible(this._bSeparatorBeforeIsVisible);this._oSeparatorAfter.setVisible(this._bSeparatorAfterIsVisible);};b.prototype.getOverflowToolbarConfig=function(){var c={canOverflow:true};c.onBeforeEnterOverflow=this._onBeforeEnterOverflow.bind(this);c.onAfterExitOverflow=this._onAfterExitOverflow.bind(this);return c;};return b;});
