/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/esh/search/ui/controls/SearchText","sap/esh/search/ui/controls/SearchLink","sap/esh/search/ui/controls/twitter/SearchTweet","sap/esh/search/ui/SearchHelper","sap/esh/search/ui/controls/SearchRelatedObjectsToolbar","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Text","sap/m/CheckBox","sap/m/ListType","sap/ui/core/Icon","sap/ui/core/IconPool","sap/ui/core/InvisibleText",],function(S,a,b,c,e,B,f,L,T,C,g,I,h,j){"use strict";var n="\u2013";return sap.ui.core.Control.extend("sap.esh.search.ui.controls.SearchResultListItem",{metadata:{properties:{dataSource:"object",itemId:"string",title:"string",titleDescription:"string",titleNavigation:"object",titleIconUrl:"string",titleInfoIconUrl:"string",geoJson:"object",type:"string",imageUrl:"string",imageFormat:"string",imageNavigation:"object",attributes:{type:"object",multiple:true,},navigationObjects:{type:"object",multiple:true,},selected:"boolean",expanded:"boolean",parentListItem:"object",additionalParameters:"object",positionInList:"int",resultSetId:"string",layoutCache:"object",totalCountHiddenElement:"object",},aggregations:{_titleLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden",},_titleLinkDescription:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_titleDelimiter:{type:"sap.m.Text",multiple:false,visibility:"hidden",},_typeText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_typeLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden",},_typeLinkAriaDescription:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_multiLineDescriptionText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_multiLineDescriptionTweet:{type:"sap.esh.search.ui.controls.twitter.SearchTweet",multiple:false,visibility:"hidden",},_selectionCheckBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden",},_expandButton:{type:"sap.m.Button",multiple:false,visibility:"hidden",},_attributeLabels:{type:"sap.m.Label",multiple:true,visibility:"hidden",},_attributeValues:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden",},_attributeValuesWithoutWhyfoundHiddenTexts:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden",},_relatedObjectActionsToolbar:{type:"sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",multiple:false,visibility:"hidden",},_titleLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_attributesLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_expandStateLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},},},init:function(){var t=this;if(sap.ui.core.Control.prototype.init){sap.ui.core.Control.prototype.init.apply(this,arguments);}t.setAggregation("_titleLink",new a({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow").attachPress(function(E){var p=t._getPhoneSize();var w=$(window).width();if(w<=p){E.preventDefault();E.cancelBubble();t._performTitleNavigation();}else{t._performTitleNavigation({trackingOnly:true,});}}));t.setAggregation("_titleLinkDescription",new S({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));var d=new T({text:"|",});d.addEventDelegate({onAfterRendering:function(){$(this.getDomRef()).attr("aria-hidden","true");}.bind(d),});t.setAggregation("_titleDelimiter",d.addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDelimiter").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));t.setAggregation("_typeText",new S().addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategory").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));t.setAggregation("_typeLinkAriaDescription",new j({text:sap.esh.search.ui.resources.i18n.getText("result_list_item_type_link_description"),}));t.setAggregation("_typeLink",new a({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategoryLink").addStyleClass("sapUshellSearchResultListItem-MightOverflow").addAriaDescribedBy(t.getAggregation("_typeLinkAriaDescription")));t.setAggregation("_multiLineDescriptionText",new S({maxLines:5,}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));t.setAggregation("_multiLineDescriptionTweet",new b({}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));t.setAggregation("_selectionCheckBox",new C({select:function(E){t.setProperty("selected",E.getParameters().selected,true);t.getModel().updateMultiSelectionSelected();},}));t.setAggregation("_expandButton",new B({type:f.Transparent,press:function(){t.toggleDetails();},}));t.setAggregation("_relatedObjectActionsToolbar",new e().addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar"));t.setAggregation("_titleLabeledByText",new j());t.setAggregation("_attributesLabeledByText",new j());t.setAggregation("_expandStateLabeledByText",new j());},renderer:function(r,o){o._renderer(r);},_renderer:function(r){this._registerItemPressHandler();this._resetPrecalculatedValues();this._renderContainer(r);this._renderAccessibilityInformation(r);},_renderContainer:function(r){var t=this;r.write("<div");r.writeControlData(t);r.addClass("sapUshellSearchResultListItem-Container");if(t.getImageUrl()){r.addClass("sapUshellSearchResultListItem-WithImage");}if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){r.addClass("sapUshellSearchResultListItem-Document");}r.writeClasses();r.write(">");t._renderContentContainer(r);t._renderExpandButtonContainer(r);r.write("</div>");},_renderContentContainer:function(r){r.write('<div class="sapUshellSearchResultListItem-Content">');this._renderTitleContainer(r);this._renderAttributesContainer(r);r.write("</div>");},_renderExpandButtonContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-ExpandButtonContainer">');r.write('<div class="sapUshellSearchResultListItem-ExpandButton">');var i,d;var k=t.getProperty("expanded");if(k){i=h.getIconURI("slim-arrow-up");d=sap.esh.search.ui.resources.i18n.getText("hideDetailBtn_tooltip");}else{i=h.getIconURI("slim-arrow-down");d=sap.esh.search.ui.resources.i18n.getText("showDetailBtn_tooltip");}var l=t.getAggregation("_expandButton");l.setIcon(i);l.setTooltip(d);l.addEventDelegate({onAfterRendering:function(){t.setAriaExpandedState();},});r.renderControl(l);r.write("</div>");r.write("</div>");},_renderTitleContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-TitleAndImageContainer">');r.write('<div class="sapUshellSearchResultListItem-TitleContainer">');t._renderCheckbox(r);var d="";var i;var k=t.getAggregation("_titleLink");var l=t.getTitle();if(!l||l.trim().length===0){l=n;}else{var m=t.getTitleNavigation();if(m){d=m.getHref();i=m.getTarget();}k.setHref(d);if(i){k.setTarget(i);}}k.setText(l);if(d.length===0){k.setEnabled(false);}k.addEventDelegate({onAfterRendering:function(){t.forwardEllipsis($(k.getDomRef()));},});if(t.getTitleIconUrl&&t.getTitleIconUrl()){var o=new I({src:t.getTitleIconUrl(),});k.setAggregation("icon",o);}r.renderControl(k);if(t.getTitleInfoIconUrl()){var p=new I({src:t.getTitleInfoIconUrl(),}).addStyleClass("sapUshellSearchResultListItem-TitleInfoIcon");r.renderControl(p);}var q=t.getTitleDescription();if(q&&q.trim().length>0){var s=t.getAggregation("_titleLinkDescription");s.setText(q);r.renderControl(s);}var u=t.getAggregation("_titleDelimiter");r.renderControl(u);if(!t.getModel().config._eshClickableObjectType||t.getModel().getDataSource()===t.getDataSource()){var v=t.getAggregation("_typeText");v.setText(t.getType());r.renderControl(v);}else{var w=this.getModel().getProperty("/uiFilter").clone();w.setDataSource(t.getDataSource());var x=t.getModel().searchUrlParser.renderFromParameters(this.getModel().boTopDefault,w,true);var y=t.getAggregation("_typeLink");y.setText(t.getType());y.setHref(x);y.setTooltip(sap.esh.search.ui.resources.i18n.getText("searchInDataSourceTooltip",[t.getDataSource().labelPlural,]));r.renderControl(t.getAggregation("_typeLinkAriaDescription"));r.renderControl(y);}r.write("</div>");t._renderImageForPhone(r);r.write("</div>");},_renderCheckbox:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-CheckboxExpandContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxAlignmentContainer">');var d=t.getAggregation("_selectionCheckBox");var s=t.getProperty("selected");d.setSelected(s);r.renderControl(d);r.write("</div>");r.write("</div>");r.write("</div>");},_renderImageForPhone:function(r){var t=this;if(t.getImageUrl()){r.write('<div class="sapUshellSearchResultListItem-TitleImage');if(this.getImageFormat()==="round"){r.write(" sapUshellSearchResultListItem-ImageContainerRound");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');r.write('<img class="sapUshellSearchResultListItem-Image" src="');r.write(t.getImageUrl());r.write('">');r.write("</div>");}},_renderImageForDocument:function(r){var t=this;if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){var i=this.getImageNavigation();var d=i?i.getHref():"";var k,l;if(d&&d.length>0){k='<a href="'+d+'"';l="</a>";}else{k="<div";l="</div>";}r.write('<div class="sapUshellSearchResultListItem-DocumentThumbnailContainer">');r.write(k+' class="sapUshellSearchResultListItem-DocumentThumbnailBorder">');r.write('<div class="sapUshellSearchResultListItem-DocumentThumbnail-DogEar"></div>');var z=new I({src:h.getIconURI("search"),useIconTooltip:false,});z.addStyleClass("sapUshellSearchResultListItem-DocumentThumbnailZoomIcon");r.renderControl(z);var m=t.getImageUrl();if(m&&m.length>0){r.write('<img class="sapUshellSearchResultListItem-DocumentThumbnail" src="');r.write(t.getImageUrl());r.write('">');}r.write(l);r.write("</div>");}},_cutDescrAttributeOutOfAttributeList:function(){var d=this.getAttributes();for(var i=0;i<d.length;i++){var k=d[i];if(k.longtext){d.splice(i,1);this.setAttributes(d);return k;}}return undefined;},_renderMultiLineDescription:function(r){var t=this;if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){var d=this._cutDescrAttributeOutOfAttributeList();if(d&&d.value&&d.value.length>0){var i;if(this._isTweet(d)){i=t.getAggregation("_multiLineDescriptionTweet");}else{i=t.getAggregation("_multiLineDescriptionText");}i.setText(d.value);if(d.whyfound){i.data("ishighlighted","true",true);}else{i.data("ishighlighted","false",true);}if(d.valueWithoutWhyfound){var k=new j({});k.setText(d.valueWithoutWhyfound);i.data("tooltippedBy",k.getId(),true);i.addEventDelegate({onAfterRendering:function(){var l=$(i.getDomRef());l.attr("aria-describedby",l.attr("data-tooltippedby"));},});t.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",k,true);r.renderControl(k);}r.renderControl(i);}else{r.write('<div class="sapUshellSearchResultListItem-MultiLineDescription"></div>');}}},_renderAttributesContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-AttributesExpandContainer');var d=t.getProperty("expanded");if(d){r.write(" sapUshellSearchResultListItem-AttributesExpanded");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-AttributesAndActions">');t._renderImageForDocument(r);t._renderMultiLineDescription(r);r.write('<ul class="sapUshellSearchResultListItem-Attributes">');var i=t.getAttributes();t._renderImageAttribute(r,i.length===0);t._renderAllAttributes(r,i);r.write('<li class="sapUshellSearchResultListItem-ExpandSpacerAttribute" aria-hidden="true"></li>');r.write("</ul>");t._renderRelatedObjectsToolbar(r);r.write("</div>");r.write("</div>");},_renderAllAttributes:function(r,d){var t=this;if(d.length===0){r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute sapUshellSearchResultListItem-EmptyAttributePlaceholder" aria-hidden="true"></li>');return;}var l;var m;var v;var o;var p,q,s;var u;var w;var x=this.getLayoutCache()||{};this.setLayoutCache(x,true);if(!x.attributes){x.attributes={};}var i=0,k,y=0;var z=4;var A=3;var D=[0,0,0];var E=[0,0,0,0];var F=2;var G=2;var H;var J=t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail";var K=t.getImageUrl()&&!J;if(J){z=A=2;D=E=[0,0];F=G=4;}var M=z*D.length;var N=A*E.length;if(K){M--;N--;D[0]++;E[0]++;}t.destroyAggregation("_attributeLabels");t.destroyAggregation("_attributeValues");t.destroyAggregation("_attributeValuesWithoutWhyfoundHiddenTexts");var O=function(W){return function(){var X=$(this.getDomRef());X.attr("aria-describedby",X.attr("data-tooltippedby"));}.bind(W);};for(;!(F<=0&&G<=0)&&i<d.length;i++){l=d[i];if(J&&y>=4){break;}if(l.isTitle){continue;}if(M<=0&&N<=0&&!l.whyfound){continue;}m=l.name;v=l.value;if(m===undefined||v===undefined){continue;}if(!v||v.trim().length===0){v=n;}if(l.longtext===undefined||l.longtext===null||l.longtext===""){s=false;}else{s=true;}o=l.valueWithoutWhyfound;var _=-1,P=-1,Q={desktop:1,tablet:1,};var R=x.attributes[l.key]||{};x.attributes[l.key]=R;r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute');if(s){H=R.longTextColumnNumber||t._howManyColumnsToUseForLongTextAttribute(o);R.longTextColumnNumber=H;Q=H;r.write(" sapUshellSearchResultListItem-LongtextAttribute");}if(M<=0){if(l.whyfound&&F>0){r.write(" sapUshellSearchResultListItem-WhyFoundAttribute-Desktop");F--;}else{r.write(" sapUshellSearchResultListItem-DisplayNoneAttribute-Desktop");}}if(N<=0){if(l.whyfound&&G>0){r.write(" sapUshellSearchResultListItem-WhyFoundAttribute-Tablet");G--;}else{r.write(" sapUshellSearchResultListItem-DisplayNoneAttribute-Tablet");}}if(s&&K&&D[0]===1){P=0;H=R.longTextColumnNumber.desktop<z?R.longTextColumnNumber.desktop:z-1;D[0]+=H;M-=H;}else{for(k=0;k<D.length;k++){if(D[k]+Q.desktop<=z){D[k]+=Q.desktop;M-=Q.desktop;P=k;break;}}}if(P<0){P=D.length;}if(s&&K&&E[0]===1){_=0;H=R.longTextColumnNumber.tablet<A?R.longTextColumnNumber.tablet:A-1;E[0]+=H;N-=H;}else{for(k=0;k<E.length;k++){if(E[k]+Q.tablet<=A){E[k]+=Q.tablet;N-=Q.tablet;_=k;break;}}}if(_<0){_=E.length;}r.write(" sapUshellSearchResultListItem-OrderTablet-"+_);r.write(" sapUshellSearchResultListItem-OrderDesktop-"+P);r.write('"');if(s){r.write(' data-sap-searchresultitem-attributeweight-desktop="'+Q.desktop+'"');r.write(' data-sap-searchresultitem-attributeweight-tablet="'+Q.tablet+'"');}r.write(">");p=new L({displayOnly:true,});p.setText(m);p.addStyleClass("sapUshellSearchResultListItem-AttributeKey");p.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(p);r.write('<span class="sapUshellSearchResultListItem-AttributeValueContainer">');w=undefined;if(l.iconUrl){w=new I({src:l.iconUrl,});w.addStyleClass("sapUshellSearchResultListItem-AttributeIcon");}if(l.defaultNavigationTarget){q=new a();q.setHref(l.defaultNavigationTarget.getHref());q.setTarget(l.defaultNavigationTarget.getTarget());q.addStyleClass("sapUshellSearchResultListItem-AttributeLink");if(w){q.setAggregation("icon",w);}}else if(this._isTweet(l)){q=new b();}else{q=new S();if(w){q.setAggregation("icon",w);}}q.setText(v);q.addStyleClass("sapUshellSearchResultListItem-AttributeValue");q.addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(l.whyfound){q.data("ishighlighted","true",true);q.addStyleClass("sapUshellSearchResultListItem-AttributeValueHighlighted");}if(s){q.data("islongtext","true",true);}if(o){u=new j({});u.addStyleClass("sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");u.setText(o);q.data("tooltippedBy",u.getId(),true);q.addEventDelegate({onAfterRendering:O(q),});t.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",u,true);r.renderControl(u);}r.renderControl(q);r.write("</span>");r.write("</li>");t.addAggregation("_attributeLabels",p,true);t.addAggregation("_attributeValues",q,true);y++;}if(K){var U=z-D[0];var V=A-E[0];if(U>0||V>0){r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute');r.write(" sapUshellSearchResultListItem-OrderTablet-0 sapUshellSearchResultListItem-OrderDesktop-0");r.write('"');r.write(' data-sap-searchresultitem-attributeweight-desktop="'+U+'"');r.write(' data-sap-searchresultitem-attributeweight-tablet="'+V+'"');r.write("></li>");}}},_isTweet:function(i){var m=this.getModel();return m.config._tweetAttribute===i.key;},_howManyColumnsToUseForLongTextAttribute:function(d){if(d.length<50){return{tablet:1,desktop:1,};}if(d.length<85){return{tablet:2,desktop:2,};}if(d.length<135){return{tablet:3,desktop:3,};}return{tablet:3,desktop:4,};},_renderImageAttribute:function(r,i){var t=this;if(!t.getImageUrl()||(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail")){return;}r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-ImageAttribute');if(i){r.write(" sapUshellSearchResultListItem-LonelyImageAttribute");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainer');if(this.getImageFormat()==="round"){r.write(" sapUshellSearchResultListItem-ImageContainerRound");}r.write('">');if(t.getImageUrl()){r.write('<img class="sapUshellSearchResultListItem-Image');if(this.getImageFormat()==="round"){}r.write('" src="');r.write(t.getImageUrl());r.write('">');}if(this.getImageFormat()!=="round"){r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');}r.write("</div>");r.write("</li>");},_renderRelatedObjectsToolbar:function(r){var t=this;var d=t.getNavigationObjects();if(!d||d.length===0){return;}t._showExpandButton=true;var i=t.getAggregation("_relatedObjectActionsToolbar");i.setProperty("navigationObjects",d);i.setProperty("positionInList",this.getPositionInList());r.renderControl(i);},_renderAccessibilityInformation:function(r){var t=this;var p=t.getProperty("parentListItem");if(p){t._renderAriaDescriptionElementForTitle(r,true,true);t._renderAriaDescriptionElementForAttributes(r,true);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,true);p.addEventDelegate({onAfterRendering:function(){var d=$(p.getDomRef());t._addAriaDescriptionToParentListElement(p,true);d.on("focusin",function(i){var k=$(i.relatedTarget);if(k.hasClass("sapUshellSearchResultListItem")||(k.closest(".sapUshellSearchResultListItemApps").length>0&&!k.hasClass("sapUshellResultListMoreFooter"))){t._renderAriaDescriptionElementForTitle(r,false,false);t._renderAriaDescriptionElementForAttributes(r,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,false);t._addAriaDescriptionToParentListElement(p,false);}else{t._renderAriaDescriptionElementForTitle(r,true,false);t._renderAriaDescriptionElementForAttributes(r,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,false);t._addAriaDescriptionToParentListElement(p,true);}});},onsapspace:function(E){if(E.target===E.currentTarget){t.toggleDetails();}},onsapenter:function(E){if(E.target===E.currentTarget){var d=t.getTitleNavigation();if(d){d.performNavigation();}}},});}},getAccessibilityInfo:function(){var d={};if(sap.ui.core.Control.prototype.getAccessibilityInfo){d=sap.ui.core.Control.prototype.getAccessibilityInfo.apply(this,arguments)||d;}d.description="";return d;},_renderAriaDescriptionElementForTitle:function(r,w,d){var t=this;t._searchResultListPrefix=t._searchResultListPrefix||sap.esh.search.ui.resources.i18n.getText("result_list_announcement_screenreaders");var l=t.getTitle()+", "+t.getType()+".";if(w){l=t._searchResultListPrefix+" "+l;}var i=t.getAggregation("_titleLabeledByText");if(i){i.setText(l);}if(d&&r){r.renderControl(i);}},_renderAriaDescriptionElementForAttributes:function(r,d){var t=this;var i=t.getAggregation("_attributesLabeledByText");var k=$(t.getDomRef()).find(".sapUshellSearchResultListItem-Attributes").find(".sapUshellSearchResultListItem-MainAttribute");var l;if(k.length===0){l=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_no_attributes");}else{l=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_has_attributes");k.each(function(){var m=$(this);if(m.is(":visible")&&m.attr("aria-hidden")!=="true"){var o=m.find(".sapUshellSearchResultListItem-AttributeKey").text();var p=m.find(".sapUshellSearchResultListItem-AttributeValueContainer");var q=p.find(".sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");if(q.length===0){q=p.find(".sapUshellSearchResultListItem-AttributeValue");}var s=q.text();l+=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_attribute_and_value",[o,s]);}});}if(i){i.setText(l);}if(d&&r){r.renderControl(i);}},_renderAriaDescriptionElementForCollapsedOrExpandedState:function(r,d){var t=this;var i=t.getAggregation("_expandStateLabeledByText");var l;var k=t.getAggregation("_expandButton");if(!k){return;}var m=$(k.getDomRef());if(m.css("visibility")!=="hidden"){if(t.isShowingDetails()){l=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_expanded");var o=this.getNavigationObjects();if(o&&o.length>0){l=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_has_links")+l;}}else{l=sap.esh.search.ui.resources.i18n.getText("result_list_item_aria_collapsed");}}i.setText(l);if(d&&r){r.renderControl(i);}},_addAriaDescriptionToParentListElement:function(p,i){var t=this.getAggregation("_titleLabeledByText");if(!t){return;}var d=t.getId();if(i){var k=this.getTotalCountHiddenElement();if(k){d+=" "+k.getId();}}var l=this.getAggregation("_attributesLabeledByText");d+=" "+l.getId();var m=this.getAggregation("_expandStateLabeledByText");d+=" "+m.getId();var o=$(p.getDomRef());o.attr("aria-labelledby",d);},_getExpandAreaObjectInfo:function(){var t=this;var r=$(t.getDomRef());r.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var d=r.find(".sapUshellSearchResultListItem-AttributesExpandContainer");var i=r.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");var k=false;if(i.css("display")==="none"){i.css("display","block");k=true;}var l=d.height();var m=r.find(".sapUshellSearchResultListItem-AttributesAndActions").height();r.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");if(k){i.css("display","");}var o=this._getElementsInExpandArea();var p=200;var q=p/10;var s={resultListItem:r,attributesExpandContainer:d,currentHeight:l,expandedHeight:m,elementsToFadeInOrOut:o,expandAnimationDuration:p,fadeInOrOutAnimationDuration:q,relatedObjectsToolbar:i,};return s;},_getElementsInExpandArea:function(){var t=this;var d=$(t.getDomRef());var i=[];d.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var k=d.find(".sapUshellSearchResultListItem-GenericAttribute:not(.sapUshellSearchResultListItem-ImageAttribute)");if(k.length>0){var l=k.position().top;k.each(function(){if($(this).position().top>l){i.push(this);}});}d.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");return i;},isShowingDetails:function(){var d=this._getExpandAreaObjectInfo();if(d.currentHeight<d.expandedHeight){return false;}return true;},showDetails:function(){var t=this;if(t.isShowingDetails()){return;}var d=this._getExpandAreaObjectInfo();d.relatedObjectsToolbar.css("opacity",0);d.relatedObjectsToolbar.css("display","block");var r=t.getAggregation("_relatedObjectActionsToolbar");if(r){r._layoutToolbarElements();}t.forwardEllipsis($(t.getDomRef()).find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));$(t.getDomRef()).addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var i,s=false;var k=d.attributesExpandContainer.animate({height:d.expandedHeight,},{duration:d.expandAnimationDuration,progress:function(l,p,m){if(!s&&p>0.5){i=d.relatedObjectsToolbar.animate({opacity:1,},m).promise();s=true;jQuery.when(k,i).done(function(){t.setProperty("expanded",true,true);$(this).addClass("sapUshellSearchResultListItem-AttributesExpanded");$(this).css("height","");$(d.elementsToFadeInOrOut).css("opacity","");$(t.getDomRef()).removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var o=h.getIconURI("slim-arrow-up");var q=t.getAggregation("_expandButton");q.setTooltip(sap.esh.search.ui.resources.i18n.getText("hideDetailBtn_tooltip"));q.setIcon(o);q.rerender();d.relatedObjectsToolbar.css("display","");d.relatedObjectsToolbar.css("opacity","");t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);}.bind(this));}},}).promise();$(d.elementsToFadeInOrOut).animate({opacity:1,},d.fadeInOrOutAnimationDuration);},hideDetails:function(){var t=this;var r=$(t.getDomRef());if(!t.isShowingDetails()){return;}var d=this._getExpandAreaObjectInfo();d.relatedObjectsToolbar.css("opacity",1);d.relatedObjectsToolbar.animate({opacity:0,},d.expandAnimationDuration/2);var i=r.find(".sapUshellSearchResultListItem-MainAttribute").outerHeight(true)+r.find(".sapUshellSearchResultListItem-ExpandSpacerAttribute").outerHeight(true);var s=false;var k=d.attributesExpandContainer.animate({height:i,},{duration:d.expandAnimationDuration,progress:function(l,p,m){if(!s&&m<=d.fadeInOrOutAnimationDuration){s=true;var o=$(d.elementsToFadeInOrOut).animate({opacity:0,},d.fadeInOrOutAnimationDuration).promise();jQuery.when(k,o).done(function(){t.setProperty("expanded",false,true);d.attributesExpandContainer.removeClass("sapUshellSearchResultListItem-AttributesExpanded");$(d.elementsToFadeInOrOut).css("opacity","");d.relatedObjectsToolbar.css("opacity","");var q=h.getIconURI("slim-arrow-down");var u=t.getAggregation("_expandButton");u.setTooltip(sap.esh.search.ui.resources.i18n.getText("showDetailBtn_tooltip"));u.setIcon(q);u.rerender();t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);});}},}).promise();},toggleDetails:function(d){var i;var m=this.getModel();if(this.isShowingDetails()){i=m.eventLogger.ITEM_HIDE_DETAILS;this.hideDetails(d);}else{i=m.eventLogger.ITEM_SHOW_DETAILS;this.showDetails(d);}m.eventLogger.logEvent({type:i,itemPosition:this.getPositionInList(),executionId:this.getResultSetId(),});},isSelectionModeEnabled:function(){var t=this;var i=false;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");if(s){i=s.css("opacity")>0;}return i;},enableSelectionMode:function(){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var d=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var i=200;var k=false;s.animate({width:"2rem",},{duration:i,progress:function(l,p){if(!k&&p>0.5){d.css("display","");d.animate({opacity:"1.0",},i/2);k=true;}},});},disableSelectionMode:function(){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var d=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var i=200;d.animate({opacity:"0.0",},i/2,function(){d.css("display","none");});s.animate({width:"0",},i);},toggleSelectionMode:function(d){if(this.isSelectionModeEnabled()){this.disableSelectionMode(d);}else{this.enableSelectionMode(d);}},onAfterRendering:function(){var t=this;var d=$(t.getDomRef());t._showOrHideExpandButton();t._setListItemStatusBasedOnWindowSize();t._renderAriaDescriptionElementForTitle(undefined,false);t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);t.forwardEllipsis(d.find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));c.attachEventHandlersForTooltip(t.getDomRef());},resizeEventHappened:function(){var t=this;var d=$(t.getDomRef());t._showOrHideExpandButton();t._setListItemStatusBasedOnWindowSize();t.getAggregation("_titleLink").rerender();t.forwardEllipsis(d.find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));},_getPhoneSize:function(){return 767;},_resetPrecalculatedValues:function(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;},_setListItemStatusBasedOnWindowSize:function(){var w=window.innerWidth;var p=this.getParentListItem();if(this.getTitleNavigation()&&w<=this._getPhoneSize()){p.setType(g.Active);}else{p.setType(g.Inactive);}},_showOrHideExpandButton:function(){var t=this;var d=$(t.getDomRef());var i=d.find(".sapUshellSearchResultListItem-ExpandButtonContainer");var k=i.css("visibility")!=="hidden";var s=false;var l=t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail";if(!l){var m=d.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");s=m.length>0;}if(!l&&!s){var o=t._getElementsInExpandArea();if(o.length>0){s=true;}}if(k&&!s){i.css("visibility","hidden");i.attr("aria-hidden","true");t.setAriaExpandedState();}else if(!k&&s){i.css("visibility","");i.removeAttr("aria-hidden");t.setAriaExpandedState();}},setAriaExpandedState:function(){var t=this;var d=t.getAggregation("_expandButton");if(!d){return;}var i=$(d.getDomRef());var k=$(t.getDomRef());var l=t.getParentListItem()?$(t.getParentListItem().getDomRef()):k.closest("li");var m=k.find(".sapUshellSearchResultListItem-ExpandButtonContainer");if(m.css("visibility")==="hidden"){i.removeAttr("aria-expanded");l.removeAttr("aria-expanded");}else{var o=t.getProperty("expanded");if(o){i.attr("aria-expanded","true");l.attr("aria-expanded","true");}else{i.attr("aria-expanded","false");l.attr("aria-expanded","false");}}},_registerItemPressHandler:function(){var t=this;var p=t.getParentListItem();if(p){p.attachPress(function(){t._performTitleNavigation();});t._registerItemPressHandler=function(){};}},_performTitleNavigation:function(p){var t=(p&&p.trackingOnly)||false;var d=this.getTitleNavigation();if(d){d.performNavigation({trackingOnly:t,});}},forwardEllipsis:function(o){var k=$(this.getDomRef());k.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");o.each(function(i,d){c.forwardEllipsis4Whyfound(d);});k.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");},});});
