/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/templating/UIFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingExpression","sap/fe/core/templating/PropertyHelper","sap/fe/core/formatters/ValueFormatter","sap/fe/core/templating/FieldControlHelper"],function(U,D,B,a,P,v,F){"use strict";var _={};var b=F.isReadOnlyExpression;var g=P.getAssociatedTextPropertyPath;var h=P.hasValueHelp;var c=P.getAssociatedCurrencyPropertyPath;var d=P.getAssociatedUnitPropertyPath;var e=P.isProperty;var f=P.getAssociatedCurrencyProperty;var j=P.getAssociatedUnitProperty;var k=P.isPathExpression;var n=a.not;var l=a.equal;var m=a.ifElse;var o=a.or;var p=a.and;var q=a.bindingExpression;var r=a.constant;var s=a.compileBinding;var t=a.transformRecursively;var u=a.formatResult;var w=a.annotationExpression;var x=B.UI;var y=D.getContextRelativeTargetObjectPath;var z=D.getPathRelativeLocation;var A=D.enhanceDataModelPath;var C=U.formatWithTypeInformation;var E=U.getBindingWithUnitOrCurrency;var G=U.getDisplayMode;function H(i,X){var Y=Object.keys(i);if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(i);if(X)Z=Z.filter(function($){return Object.getOwnPropertyDescriptor(i,$).enumerable;});Y.push.apply(Y,Z);}return Y;}function I(X){for(var i=1;i<arguments.length;i++){var Y=arguments[i]!=null?arguments[i]:{};if(i%2){H(Object(Y),true).forEach(function(Z){J(X,Z,Y[Z]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(X,Object.getOwnPropertyDescriptors(Y));}else{H(Object(Y)).forEach(function(Z){Object.defineProperty(X,Z,Object.getOwnPropertyDescriptor(Y,Z));});}}return X;}function J(i,X,Y){if(X in i){Object.defineProperty(i,X,{value:Y,enumerable:true,configurable:true,writable:true});}else{i[X]=Y;}return i;}var K=function(q,i){return t(q,"Binding",function(X){var Y=X;if(X.modelName===undefined){var Z=A(i,X.path);Y=L(Z,X);}return Y;});};_.addTextArrangementToBindingExpression=K;var L=function(i,X,Y){var Z,$;var a1=Y===null||Y===void 0?void 0:Y.displayMode;var b1=X;var c1=i.targetObject.type==="PropertyPath"?i.targetObject.$target:i.targetObject;var d1=a1||G(c1,i);var e1=(Z=c1.annotations)===null||Z===void 0?void 0:($=Z.Common)===null||$===void 0?void 0:$.Text;var f1=z(i.contextLocation,i.navigationProperties).map(function(np){return np.name;});X=C(c1,X);if(d1!=="Value"&&e1){switch(d1){case"Description":b1=w(e1,f1);break;case"DescriptionValue":b1=u([w(e1,f1),X],v.formatWithBrackets);break;case"ValueDescription":b1=u([X,w(e1,f1)],v.formatWithBrackets);break;}}return b1;};_.getBindingWithTextArrangement=L;var M=function(q,i){return t(q,"Binding",function(X){var Y=X;if(X.modelName===undefined){var Z=A(i,X.path);Y=C(Z.targetObject,X);}return Y;});};_.formatValueRecursively=M;var N=function(i,X){var Y,Z,$,a1,b1,c1,d1,e1,f1,g1;var h1=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(((Y=i.targetObject)===null||Y===void 0?void 0:Y.$Type)==="com.sap.vocabularies.UI.v1.DataField"||((Z=i.targetObject)===null||Z===void 0?void 0:Z.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"||(($=i.targetObject)===null||$===void 0?void 0:$.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||((a1=i.targetObject)===null||a1===void 0?void 0:a1.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){var i1=i.targetObject.Value||"";return s(r(i1));}if(k(i.targetObject)&&i.targetObject.$target){var j1=i.targetEntityType.resolvePath(i.targetObject.path,true);i.targetObject=j1.target;j1.visitedObjects.forEach(function(m1){if(m1&&m1._type==="NavigationProperty"){i.navigationProperties.push(m1);}});}var k1=q(y(i));var l1;if(((b1=i.targetObject)===null||b1===void 0?void 0:(c1=b1.annotations)===null||c1===void 0?void 0:(d1=c1.Measures)===null||d1===void 0?void 0:d1.Unit)||((e1=i.targetObject)===null||e1===void 0?void 0:(f1=e1.annotations)===null||f1===void 0?void 0:(g1=f1.Measures)===null||g1===void 0?void 0:g1.ISOCurrency)){l1=E(i,k1);if((X===null||X===void 0?void 0:X.measureDisplayMode)==="Hidden"){l1.formatOptions=I({},l1.formatOptions,{showMeasure:false});}}else{l1=L(i,k1,X);}if(h1){return l1;}return s(l1);};_.getTextBinding=N;var O=function(i,X){var Y=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var Z=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var $=arguments.length>4?arguments[4]:undefined;var a1=arguments.length>5?arguments[5]:undefined;if(k(i.targetObject)&&i.targetObject.$target){var b1=i.targetEntityType.resolvePath(i.targetObject.path,true);i.targetObject=b1.target;b1.visitedObjects.forEach(function(i1){if(i1&&i1._type==="NavigationProperty"){i.navigationProperties.push(i1);}});}var c1=i.targetObject;if(e(c1)){var d1,e1;var f1=q(y(i));if((d1=c1.annotations)===null||d1===void 0?void 0:(e1=d1.Communication)===null||e1===void 0?void 0:e1.IsEmailAddress){f1.type="sap.fe.core.type.Email";}else{var g1=j(i.targetObject);var h1=f(i.targetObject);if(!Y&&(g1||h1)){f1=E(i,f1);if(g1&&!h(g1)||h1&&!h(h1)||(X===null||X===void 0?void 0:X.measureDisplayMode)==="Hidden"){if(!f1.formatOptions){f1.formatOptions={};}f1.formatOptions.showMeasure=false;}}else{f1=C(c1,f1);if(f1.type==="sap.ui.model.odata.type.String"){f1.formatOptions={parseKeepsEmptyString:true};}}}if(Z){delete f1.formatOptions;delete f1.constraints;delete f1.type;}if($){f1.parameters=$;}if(a1){f1.targetType="any";}return s(f1);}else{if(c1&&c1.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return s(w(c1.Value));}else{return"";}}};_.getValueBinding=O;var Q=function(i,X){var Y=d(i.targetObject);var Z=c(i.targetObject);if(Y||Z){var $=Y||Z;var a1=A(i,$);return O(a1,X);}return undefined;};_.getUnitBinding=Q;var R=function(i,X){var Y=g(i.targetObject);if(Y){var Z=A(i,Y);var $=O(Z,X,true,true,{$$noPatch:true});return $;}return undefined;};_.getAssociatedTextBinding=R;var S=function(i,X,Y,Z,$){var a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,n1,o1,p1,q1,r1,s1,t1,u1,v1,w1,x1,y1,z1;var A1=k(i)&&i.$target||i;if($&&!((a1=A1.annotations)===null||a1===void 0?void 0:(b1=a1.UI)===null||b1===void 0?void 0:b1.IsImageURL)&&!(A1.type==="Edm.Stream")&&!(((c1=A1.annotations)===null||c1===void 0?void 0:(d1=c1.Communication)===null||d1===void 0?void 0:d1.IsEmailAddress)||((e1=A1.annotations)===null||e1===void 0?void 0:(f1=e1.Communication)===null||f1===void 0?void 0:f1.IsPhoneNumber))){return"LinkWithQuickViewForm";}if(!i||typeof i==="string"){return"Text";}if((g1=A1.annotations)===null||g1===void 0?void 0:(h1=g1.UI)===null||h1===void 0?void 0:h1.IsImageURL){return"Avatar";}if(A1.type==="Edm.Stream"){return"Avatar";}switch(X.$Type){case"com.sap.vocabularies.UI.v1.DataPointType":return"DataPoint";case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(((i1=X.Target)===null||i1===void 0?void 0:(j1=i1.$target)===null||j1===void 0?void 0:j1.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){return"DataPoint";}else if(((k1=X.Target)===null||k1===void 0?void 0:(l1=k1.$target)===null||l1===void 0?void 0:l1.$Type)==="com.sap.vocabularies.Communication.v1.ContactType"){return"Contact";}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return"Button";case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":return"Link";}if(Y===null||Y===void 0?void 0:(m1=Y.targetEntityType)===null||m1===void 0?void 0:(n1=m1.annotations)===null||n1===void 0?void 0:(o1=n1.Common)===null||o1===void 0?void 0:o1.SemanticKey){var B1=Y.targetEntityType.annotations.Common.SemanticKey;var C1=!B1.every(function(I1){var J1;return(I1===null||I1===void 0?void 0:(J1=I1.$target)===null||J1===void 0?void 0:J1.name)!==A1.name;});if(C1&&Z.semanticKeyStyle){var D1,E1,F1;if((D1=Y.targetEntitySet)===null||D1===void 0?void 0:(E1=D1.annotations)===null||E1===void 0?void 0:(F1=E1.Common)===null||F1===void 0?void 0:F1.DraftRoot){return"SemanticKeyWithDraftIndicator";}return Z.semanticKeyStyle==="ObjectIdentifier"?"ObjectIdentifier":"LabelSemanticKey";}}if(X.Criticality){return"ObjectStatus";}if((p1=A1.annotations)===null||p1===void 0?void 0:(q1=p1.Measures)===null||q1===void 0?void 0:q1.ISOCurrency){if(Z.measureDisplayMode==="Hidden"){return"Text";}return"AmountWithCurrency";}if(((r1=A1.annotations)===null||r1===void 0?void 0:(s1=r1.Communication)===null||s1===void 0?void 0:s1.IsEmailAddress)||((t1=A1.annotations)===null||t1===void 0?void 0:(u1=t1.Communication)===null||u1===void 0?void 0:u1.IsPhoneNumber)){return"Link";}if((v1=A1.annotations)===null||v1===void 0?void 0:(w1=v1.UI)===null||w1===void 0?void 0:w1.MultiLineText){return"Text";}var G1=(Y===null||Y===void 0?void 0:(x1=Y.targetEntityType)===null||x1===void 0?void 0:x1.navigationProperties)||[];var H1=false;G1.forEach(function(I1){if(I1.referentialConstraint&&I1.referentialConstraint.length){I1.referentialConstraint.forEach(function(J1){if((J1===null||J1===void 0?void 0:J1.sourceProperty)===A1.name){var K1,L1,M1;if(I1===null||I1===void 0?void 0:(K1=I1.targetType)===null||K1===void 0?void 0:(L1=K1.annotations)===null||L1===void 0?void 0:(M1=L1.UI)===null||M1===void 0?void 0:M1.QuickViewFacets){H1=true;}}});}});if(H1){return"LinkWithQuickViewForm";}if((y1=A1.annotations)===null||y1===void 0?void 0:(z1=y1.Common)===null||z1===void 0?void 0:z1.SemanticObject){return"LinkWrapper";}if(X.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return"Link";}return"Text";};_.getDisplayStyle=S;var T=function(i,X,Y){var Z,$,a1,b1,c1,d1,e1,f1,g1,h1,i1;if(!i||typeof i==="string"){return null;}var j1=k(i)&&i.$target||i;switch(X.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(((Z=X.Target)===null||Z===void 0?void 0:($=Z.$target)===null||$===void 0?void 0:$.$Type)==="com.sap.vocabularies.Communication.v1.ContactType"){return null;}else if(((a1=X.Target)===null||a1===void 0?void 0:(b1=a1.$target)===null||b1===void 0?void 0:b1.Visualization)==="UI.VisualizationType/Rating"){return"RatingIndicator";}break;case"com.sap.vocabularies.UI.v1.DataPointType":if((X===null||X===void 0?void 0:X.Visualization)==="UI.VisualizationType/Rating"){return"RatingIndicator";}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return null;}var k1=j(j1);var l1=f(j1);if(P.hasValueHelp(j1)||k1&&P.hasValueHelp(k1)||l1&&P.hasValueHelp(l1)){if((Y===null||Y===void 0?void 0:Y.measureDisplayMode)==="Hidden"){return"Input";}return"InputWithValueHelp";}if(((c1=j1.annotations)===null||c1===void 0?void 0:(d1=c1.UI)===null||d1===void 0?void 0:(e1=d1.MultiLineText)===null||e1===void 0?void 0:e1.valueOf())&&j1.type==="Edm.String"){return"TextArea";}switch(j1.type){case"Edm.Date":return"DatePicker";case"Edm.Time":case"Edm.TimeOfDay":return"TimePicker";case"Edm.DateTime":case"Edm.DateTimeOffset":return"DateTimePicker";case"Edm.Boolean":return"CheckBox";}if(((f1=j1.annotations)===null||f1===void 0?void 0:(g1=f1.Measures)===null||g1===void 0?void 0:g1.ISOCurrency)||((h1=j1.annotations)===null||h1===void 0?void 0:(i1=h1.Measures)===null||i1===void 0?void 0:i1.Unit)){return"InputWithUnit";}return"Input";};_.getEditStyle=T;var V=function(i,X){var Y,Z,$,a1,b1,c1;var d1=i.targetObject;var e1;if(d1){switch(d1.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataPointType":e1=d1.Value.$target;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if((d1===null||d1===void 0?void 0:(Y=d1.Target)===null||Y===void 0?void 0:(Z=Y.$target)===null||Z===void 0?void 0:Z.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var f1;e1=(f1=d1.Target.$target)===null||f1===void 0?void 0:f1.Value.$target;break;}case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForAction":default:e1=undefined;}}var g1=(X===null||X===void 0?void 0:X.isAnalytics)?x.IsExpanded:r(false);var h1=(X===null||X===void 0?void 0:X.isAnalytics)?l(x.NodeLevel,0):r(false);return s(p.apply(void 0,[n(l(w(d1===null||d1===void 0?void 0:($=d1.annotations)===null||$===void 0?void 0:(a1=$.UI)===null||a1===void 0?void 0:a1.Hidden),true)),m(!!e1,e1&&n(l(w((b1=e1.annotations)===null||b1===void 0?void 0:(c1=b1.UI)===null||c1===void 0?void 0:c1.Hidden),true)),true),o(n(g1),h1)]));};_.getVisibleExpression=V;var W=function(i,X,Y){var Z=k(i)&&i.$target||i;var $=f(Z)||j(Z);if(!$){return s("");}var a1=A(X,i);var b1=Q(a1,Y);var c1=p(n(b($)),n(P.isComputed($)));return s(m(c1,"",b1));};_.getInputDescription=W;return _;},false);
