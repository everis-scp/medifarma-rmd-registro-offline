/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/m/Text","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/ToolbarDesign","sap/ui/core/Icon"],function(T,a,b,c,I){"use strict";return sap.m.Toolbar.extend("sap.esh.search.ui.controls.SearchFilterBar",{constructor:function(o){var t=this;o=jQuery.extend({},{design:c.Info,},o);sap.m.Toolbar.prototype.constructor.apply(t,[o]);t.addStyleClass("sapUshellSearchFilterContextualBar");t.filterFormatter=t.filterFormatter.bind(t);t.filterText=new T("",{text:{parts:["/uiFilter/rootCondition","/facets"],formatter:t.filterFormatter,},tooltip:{parts:["/uiFilter/rootCondition","/facets"],formatter:t.filterFormatter,},}).addStyleClass("sapUshellSearchFilterText");t.filterText.setMaxLines(1);t.filterText.clampText();t.addContent(t.filterText);t.addContent(new b());t.resetButton=new I({src:"sap-icon://clear-filter",tooltip:sap.esh.search.ui.resources.i18n.getText("resetFilterButton_tooltip"),}).addStyleClass("sapUshellSearchFilterResetButton");t.addContent(t.resetButton);},filterFormatter:function(r,f){if(!r||!r.hasFilters()){return"";}r=this.sortConditions(r,f);var d=[];for(var i=0;i<r.conditions.length;++i){var e=r.conditions[i];var l=[];for(var j=0;j<e.conditions.length;++j){var g=e.conditions[j];if(j===0){l.push(g.attributeLabel," (");}else{l.push(", ");}l.push(this._formatLabel(g.valueLabel||g.value,g.operator));}l.push(")");d.push(l.join(""));}return sap.esh.search.ui.resources.i18n.getText("filtered_by",[d.join(", ")]);},_formatLabel:function(l,o){var d;switch(o){case this.getModel().sinaNext.ComparisonOperator.Bw:d=l+"*";break;case this.getModel().sinaNext.ComparisonOperator.Ew:d="*"+l;break;case this.getModel().sinaNext.ComparisonOperator.Co:d="*"+l+"*";break;default:d=l;break;}return d;},sortConditions:function(r,f){if(f.length===0){return r;}var g=function(e){var h=e.conditions[0];if(h.attribute){return h.attribute;}return h.conditions[0].attribute;};var d=function(l,h,v){for(var i=0;i<l.length;++i){var j=l[i];if(j[h]===v){return i;}}};r=r.clone();r.conditions.sort(function(h,j){var k=g(h);var l=d(f,"dimension",k);var m=g(j);var n=d(f,"dimension",m);return l-n;});var s=function(e){var h=g(e);var j=d(f,"dimension",h);if(!j){return;}var k=f[j];if(k.facetType==="hierarchy"){return;}var v=function(l,m){return(d(k.items,"label",l.valueLabel)-d(k.items,"label",m.valueLabel));};e.conditions.sort(v);};for(var i=0;i<r.conditions.length;++i){var e=r.conditions[i];s(e);}return r;},renderer:"sap.m.ToolbarRenderer",onAfterRendering:function(){var t=this;t.resetButton.attachPress(function(){var m=t.getModel();m.eventLogger.logEvent({type:m.eventLogger.CLEAR_ALL_FILTERS,});m.resetFilterConditions(true);});var $=jQuery(".sapUshellSearchFilterText");$.attr("aria-label",sap.esh.search.ui.resources.i18n.getText("filtered_by_aria_label"));},});});
