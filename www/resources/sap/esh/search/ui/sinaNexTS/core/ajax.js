/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var a=(this&&this.__awaiter)||function(t,_,P,g){function c(v){return v instanceof P?v:new P(function(r){r(v);});}return new(P||(P=Promise))(function(r,d){function f(v){try{s(g.next(v));}catch(e){d(e);}}function h(v){try{s(g["throw"](v));}catch(e){d(e);}}function s(e){e.done?r(e.value):c(e.value).then(f,h);}s((g=g.apply(t,_||[])).next());});};var b=(this&&this.__generator)||function(c,d){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:h(0),"throw":h(1),"return":h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this;}),g;function h(n){return function(v){return s([n,v]);};}function s(o){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=o[0]&2?y["return"]:o[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,o[1])).done)return t;if(y=0,t)o=[o[0]&2,t.value];switch(o[0]){case 0:case 1:t=o;break;case 4:_.label++;return{value:o[1],done:false};case 5:_.label++;y=o[1];o=[0];continue;case 7:o=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(o[0]===6||o[0]===2)){_=0;continue;}if(o[0]===3&&(!t||(o[1]>t[0]&&o[1]<t[3]))){_.label=o[1];break;}if(o[0]===6&&_.label<t[1]){_.label=t[1];t=o;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(o);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}o=d.call(c,_);}catch(e){o=[6,e];y=0;}finally{f=t=0;}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true};}};sap.ui.define(["require","exports","./errors"],function(r,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:true});c.Client=c.request=c.addEncodedUrlParameters=c.encodeUrlParameters=c.parseHeaders=c.RecordingMode=void 0;var R;(function(R){R["NONE"]="none";R["RECORD"]="record";R["REPLAY"]="replay";})(R=c.RecordingMode||(c.RecordingMode={}));function p(e){var j={};var l=e.split("\n");for(var i=0;i<l.length;++i){var k=l[i];var m=k.indexOf(":");if(m>=0){var n=k.slice(0,m).toLowerCase();var v=k.slice(m+1);j[n]=v.trim();}}return j;}c.parseHeaders=p;function f(e){var i=[];for(var n in e){var v=e[n];i.push(encodeURIComponent(n)+"="+encodeURIComponent(v+""));}return i.join("&");}c.encodeUrlParameters=f;function g(u,e){if(!e){return u;}var i=f(e);if(i.length>0){u+="?"+i;}return u;}c.addEncodedUrlParameters=g;function h(e){return a(this,void 0,void 0,function(){var i,j,k,l,u,m,n,t,o;return b(this,function(q){switch(q.label){case 0:if(!(typeof window!=="undefined"))return[3,1];return[2,new Promise(function(s,v){var x=new XMLHttpRequest();x.onreadystatechange=function(){if(x.readyState==4&&(x.status==200||x.status==201||x.status==204)){s({data:x.responseText||"{}",headers:p(x.getAllResponseHeaders()),});return;}if(x.readyState==4){v(new d.AjaxError(x,p(x.getAllResponseHeaders())));}};var u=g(e.url,e.parameters);x.open(e.method,u,true);for(var w in e.headers){var y=e.headers[w];x.setRequestHeader(w,y);}x.send(e.data);})];case 1:i=r("node-fetch");j=e.url.startsWith("https")?r("https"):r("http");k=new j.Agent({rejectUnauthorized:false,});l={agent:k,headers:e.headers,method:e.method,};if(typeof e.data!=="undefined"){l.body=e.data;}u=g(e.url,e.parameters);m=function(s){var v={};for(var w in s){var x=s[w];if(x instanceof Array&&x.length===1){v[w]=x[0];}else{v[w]=x;}}return v;};q.label=2;case 2:q.trys.push([2,7,,8]);return[4,i(u,l)];case 3:n=q.sent();if(!n.ok)return[3,5];return[4,n.text()];case 4:t=q.sent();return[2,{data:t||"{}",headers:m(n.headers.raw()),}];case 5:throw new d.AjaxError(n);case 6:return[3,8];case 7:o=q.sent();throw new d.AjaxError(o);case 8:return[2];}});});}c.request=h;var C=(function(){function C(e){var i;this._client=new _(e);this.recordOptions={headers:e.recordingHeaders,mode:(i=e.recordingMode)!==null&&i!==void 0?i:R.NONE,path:e.recordingPath,requestNormalization:e.requestNormalization||this._defaultRequestNormalization,};if(typeof window!=="undefined"&&this.recordOptions.mode!==R.NONE){throw new d.InternalESHClientError("Record/Replay is only supported on Node.js");}this.records={};if(this.recordOptions.mode===R.REPLAY){this.records=r(e.recordingPath);}}C.prototype._encodeObj=function(e){var i=[];for(var j in e){if(Object.prototype.hasOwnProperty.call(e,j)){i.push(encodeURIComponent(j)+"="+encodeURIComponent(e[j]));}}return i.join("&");};C.prototype.getJson=function(u,e){var t=this;if(e){var D="?"+t._encodeObj(e);u=u+D;}if(t.recordOptions.mode==="none"){return t._client.getJson(u);}if(t.recordOptions.mode==="replay"){return t._replay(u,null);}return t._client.getJson(u).then(function(i){return t._record(u,null,i);});};C.prototype.getXML=function(u){return a(this,void 0,void 0,function(){var t;return b(this,function(e){switch(e.label){case 0:t=this;if(t.recordOptions.mode==="none"){return[2,t._client.getXML(u)];}if(!(t.recordOptions.mode==="replay"))return[3,2];return[4,t._replay(u,null)];case 1:return[2,(e.sent()).data];case 2:return[2,t._client.getXML(u).then(function(i){return t._record(u,null,i);})];}});});};C.prototype.postJson=function(u,e){e=JSON.parse(JSON.stringify(e));var t=this;if(t.recordOptions.mode==="none"){return t._client.postJson(u,e);}if(t.recordOptions.mode==="replay"){return t._replay(u,e);}return t._client.postJson(u,e).then(function(i){return t._record(u,e,i);});};C.prototype.mergeJson=function(u,e){e=JSON.parse(JSON.stringify(e));var t=this;if(t.recordOptions.mode==="none"){return t._client.mergeJson(u,e);}if(t.recordOptions.mode==="replay"){return t._replay(u,e);}return t._client.mergeJson(u,e).then(function(i){return t._record(u,e,i);});};C.prototype.request=function(e){return this._client.request(e);};C.prototype._record=function(u,e,i){var t=this;var k=u;var n=t.recordOptions.requestNormalization(e);if(n){k+=JSON.stringify(n);}if(t.records[k]===undefined&&k.indexOf("NotToRecord")===-1){try{t.records[k]=JSON.parse(JSON.stringify(i.data));}catch(j){if(j.name==="SyntaxError"){t.records[k]=i+"";}else{throw j;}}}return t._client.putJson(t.recordOptions.path,t.records).then(function(){return i;});};C.prototype._replay=function(u,e){return a(this,void 0,void 0,function(){var t,k,n,i;return b(this,function(j){t=this;k=u;n=t.recordOptions.requestNormalization(e);if(n){k+=JSON.stringify(n);}i=this.records[k];switch(typeof i){case"object":return[2,{data:JSON.parse(JSON.stringify(i)),}];case"string":return[2,{data:i,}];case"undefined":{throw new d.InternalESHClientError("No recording found for request '"+k+"' in file "+this.recordOptions.path);}default:throw new d.InternalESHClientError("Don't know how to serialize recording data of type "+typeof i);}return[2];});});};C.prototype._defaultRequestNormalization=function(e){if(e===null){return"";}delete e.SessionID;delete e.SessionTimestamp;return e;};return C;}());c.Client=C;var _=(function(){function _(e){var i;this.csrf=e.csrf;this.csrfByPassCache=e.csrfByPassCache||false;this.csrfToken=null;this.csrfFetchRequest=e.csrfFetchRequest||null;this.recordOptions={headers:e.recordingHeaders,mode:(i=e.recordingMode)!==null&&i!==void 0?i:R.NONE,path:e.recordingPath,requestNormalization:e.requestNormalization,};if(typeof window!=="undefined"&&this.recordOptions.mode!==R.NONE){throw new Error("Record/Replay is only supported on Node.js");}}_.getJsonHeaders=function(){return{"Content-Type":"application/json",Accept:"application/json",};};_.getXmlHeaders=function(){return{"Content-Type":"application/xml",Accept:"application/xml",};};_.prototype.parseError=function(k){var l,m,n,o,q,s,t,u;try{var v=void 0;if((l=k===null||k===void 0?void 0:k.xhttp)===null||l===void 0?void 0:l.responseText){v=JSON.parse((m=k.xhttp)===null||m===void 0?void 0:m.responseText);}var w=[];if((n=v===null||v===void 0?void 0:v.error)===null||n===void 0?void 0:n.code){w.push(v.error.code);}if(((o=v===null||v===void 0?void 0:v.Error)===null||o===void 0?void 0:o.Code)&&((q=v===null||v===void 0?void 0:v.Error)===null||q===void 0?void 0:q.Message)){w.push(v.Error.Code+": "+v.Error.Message);}if(v===null||v===void 0?void 0:v.ErrorDetails){for(var i=0;i<v.ErrorDetails.length;++i){var x=v.ErrorDetails[i];w.push(x.Code+": "+x.Message);}}if(v===null||v===void 0?void 0:v.Messages){for(var j=0;j<v.Messages.length;++j){var y=v.Messages[j];w.push(y.Number+": "+y.Text+" ("+y.Type+")");}}if((t=(s=v===null||v===void 0?void 0:v.error)===null||s===void 0?void 0:s.message)===null||t===void 0?void 0:t.value){w.push(v.error.message.value);}if((u=v===null||v===void 0?void 0:v.error)===null||u===void 0?void 0:u.details){w.push(v.error.details);}if(w.length>0){k.previous=new Error(w.join("\n"));}return k;}catch(e){var z=new d.InternalESHClientError("Error while extracting server error");z.previous=e;k.previous=z;return k;}};_.prototype.getJson=function(u){return a(this,void 0,void 0,function(){var e;return b(this,function(i){switch(i.label){case 0:return[4,this.request({headers:_.getJsonHeaders(),method:"GET",url:u,})];case 1:e=i.sent();if(typeof e.data==="string"){e.data=JSON.parse(e.data);}return[2,e];}});});};_.prototype.getXML=function(u){return a(this,void 0,void 0,function(){var e;return b(this,function(i){switch(i.label){case 0:return[4,this.request({headers:_.getXmlHeaders(),method:"GET",url:u,})];case 1:e=i.sent();return[2,e.data];}});});};_.prototype.postJson=function(u,e){return a(this,void 0,void 0,function(){var i;return b(this,function(j){switch(j.label){case 0:return[4,this.request({headers:_.getJsonHeaders(),method:"POST",url:u,data:JSON.stringify(e),})];case 1:i=j.sent();if(typeof i.data==="string"){i.data=JSON.parse(i.data);}return[2,i];}});});};_.prototype.mergeJson=function(u,e){return a(this,void 0,void 0,function(){var i;return b(this,function(j){switch(j.label){case 0:return[4,this.request({headers:_.getJsonHeaders(),method:"MERGE",url:u,data:JSON.stringify(e),})];case 1:i=j.sent();if(typeof i.data==="string"){i.data=JSON.parse(i.data);}return[2,i];}});});};_.prototype.putJson=function(e,i){return a(this,void 0,void 0,function(){var j;return b(this,function(k){j=r("fs");return[2,new Promise(function(l,m){j.writeFile(e,JSON.stringify(i,null,4),"utf8",function(n){if(n){m(n);}else{l();}});})];});});};_.prototype._fetchCsrf=function(){if(this.csrfFetchRequestPromise){return this.csrfFetchRequestPromise;}this.csrfFetchRequest.headers=this.csrfFetchRequest.headers||{};this.csrfFetchRequest.headers["x-csrf-token"]="fetch";this.csrfFetchRequest.parameters=this.csrfFetchRequest.parameters||{};if(this.csrfByPassCache){this.csrfFetchRequest.parameters._=Date.now();}this.csrfFetchRequestPromise=h(this.csrfFetchRequest).then(function(e){this.csrfFetchRequestPromise=null;if(e.headers["set-cookie"]){this.cookies=e.headers["set-cookie"].join("; ");}this.csrfToken=e.headers["x-csrf-token"];return e;}.bind(this));return this.csrfFetchRequestPromise;};_.prototype._requestWithCsrf=function(e,i){return a(this,void 0,void 0,function(){return b(this,function(j){switch(j.label){case 0:if(g(this.csrfFetchRequest.url,this.csrfFetchRequest.parameters)===g(e.url,e.parameters)){return[2,this._fetchCsrf()];}if(!(i&&!this.csrfToken))return[3,2];return[4,this._fetchCsrf()];case 1:j.sent();return[2,this._requestWithCsrf(e,false)];case 2:e.headers=e.headers||{};if(this.cookies){e.headers.Cookie=this.cookies;}e.headers["x-csrf-token"]=this.csrfToken;return[2,h(e).catch(function(k){if(i&&k.responseHeaders["x-csrf-token"]&&k.responseHeaders["x-csrf-token"].toLowerCase()==="required"){return this._fetchCsrf().then(function(){return this._requestWithCsrf(e,false);}.bind(this));}return Promise.reject(k);}.bind(this))];}});});};_.prototype.request=function(e){return a(this,void 0,void 0,function(){var i;return b(this,function(j){switch(j.label){case 0:e.headers=Object.assign({},e.headers,this.recordOptions.headers);j.label=1;case 1:j.trys.push([1,5,,6]);if(!!this.csrf)return[3,3];if(this.cookies){e.headers.Cookie=this.cookies;}return[4,h(e)];case 2:return[2,j.sent()];case 3:if(!this.csrfFetchRequest){this.csrfFetchRequest=e;}return[4,this._requestWithCsrf(e,true)];case 4:return[2,j.sent()];case 5:i=j.sent();throw this.parseError(i);case 6:return[2];}});});};return _;}());});})();
