/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define("sap/zen/dsh/olap/DataProvider",["sap/base/Log","sap/zen/commons/Format","sap/zen/dsh/Axis","sap/zen/commons/CellType","sap/zen/dsh/DimensionType","sap/zen/dsh/DisplayType","sap/zen/dsh/ComparisonOperator","sap/zen/dsh/utils/Utilities","sap/zen/dsh/utils/SyncActionHelper","sap/zen/dsh/utils/ListHelper","sap/zen/dsh/utils/TokenHelper","sap/zen/dsh/utils/ResultSetHelper","sap/zen/dsh/utils/ResourceBundle","sap/zen/commons/SpreadSheet/CellInfo","sap/zen/commons/SpreadSheet/CXpStyle","sap/zen/commons/thirdparty/lodash"],function(L,F,A,C,D,a,c,U,S,d,T,R,e,f,g,_){"use strict";var h=function(O,v,u,i,q,j){var t=this;var Q=null;var r;var k=U.getDialogs();var I=true;function l(o){switch(o){case sap.firefly.ComparisonOperator.EQUAL:return"EQ";case sap.firefly.ComparisonOperator.LESS_THAN:return"LT";case sap.firefly.ComparisonOperator.LESS_EQUAL:return"LE";case sap.firefly.ComparisonOperator.GREATER_THAN:return"GT";case sap.firefly.ComparisonOperator.GREATER_EQUAL:return"GE";case sap.firefly.ComparisonOperator.BETWEEN:return"BT";case sap.firefly.ComparisonOperator.NOT_EQUAL:return"NE";default:throw new Error("Invalid Opertor: "+o.getName());}}function m(s){switch(s){case"EQ":return sap.firefly.ComparisonOperator.EQUAL;case"LT":return sap.firefly.ComparisonOperator.LESS_THAN;case"LE":return sap.firefly.ComparisonOperator.LESS_EQUAL;case"GT":return sap.firefly.ComparisonOperator.GREATER_THAN;case"GE":return sap.firefly.ComparisonOperator.GREATER_EQUAL;case"BT":return sap.firefly.ComparisonOperator.BETWEEN;case"NE":return sap.firefly.ComparisonOperator.NOT_EQUAL;default:throw new Error("Invalid Opertor: "+s);}}var V={};t.OffsetCol=0;t.Messages=[];t.Name=j;t.OffsetRow=0;t.SuppressRepetition=true;t.Chart={chartType:"column",vizProperties:{categoryAxis:{axisLine:{size:1,visible:true},title:{visible:true},axisTick:{visible:true},label:{alignment:"center",visible:true}},categoryAxis2:{axisLine:{size:1,visible:true},title:{visible:true},axisTick:{visible:true},label:{alignment:"center",visible:true}},valueAxis2:{size:1,visible:true},legend:{visible:true},title:{visible:true},axisTick:{visible:true},label:{alignment:"center",visible:true},valueAxis:{axisLine:{size:1,visible:true},title:{visible:true},axisTick:{visible:true},label:{alignment:"Right",visible:true}}}};var p=F.ExcelStyle;q.setRequestCellDocumentID(true);t.produceGraph=function(){t.Graph={nodes:[{key:0,title:"Iron Man",group:1,status:"Error",icon:"sap-icon://key-user-settings",attributes:[{label:"Release date",value:"May 2, 2008"},{label:"Director",value:"Jon Favreau"}]},{"key":1,"title":"Iron Man 2","group":1,"status":"Error","icon":"sap-icon://key-user-settings","attributes":[{"label":"Release date","value":"May 7, 2010"},{"label":"Director","value":"Jon Favreau"}]},{"key":2,"title":"The Incredible Hulk","group":1,"icon":"sap-icon://theater","attributes":[{"label":"Release date","value":"June 13, 2008"},{"label":"Director","value":"Louis Leterrier"}]},{"key":3,"title":"Thor","group":1,"status":"Warning","icon":"sap-icon://wrench","attributes":[{"label":"Release date","value":"May 6, 2011"},{"label":"Director","value":"Kenneth Branagh"}]},{"key":4,"title":"Captain America: The First Avenger","group":1,"status":"Success","icon":"sap-icon://unfavorite","attributes":[{"label":"Release date","value":"July 22, 2011"},{"label":"Director","value":"Joe Johnston"}]},{"key":5,"title":"Marvel's The Avengers","group":1,"status":"Error","icon":"sap-icon://text-color","attributes":[{"label":"Release date","value":"May 4, 2012"},{"label":"Director","value":"Joss Whedon"}]},{"key":6,"title":"Iron Man 3","group":2,"status":"Error","icon":"sap-icon://key-user-settings","attributes":[{"label":"Release date","value":"May 3, 2013"},{"label":"Director","value":"Shane Black"}]},{"key":7,"title":"Thor: The Dark World","group":2,"status":"Warning","icon":"sap-icon://wrench","attributes":[{"label":"Release date","value":"November 8, 2013"},{"label":"Director","value":"Alan Taylor"}]},{"key":8,"title":"Captain America: The Winter Soldier","group":2,"status":"Success","icon":"sap-icon://unfavorite","attributes":[{"label":"Release date","value":"April 4, 2014"},{"label":"Director","value":"Anthony & Joe Russo"}]},{"key":9,"title":"Doctor Strange","group":3,"icon":"sap-icon://activate","attributes":[{"label":"Release date","value":"November 4, 2016"},{"label":"Director","value":"Scott Derrickson"}]},{"key":10,"title":"Avengers: Age of Ultron","group":2,"status":"Error","icon":"sap-icon://text-color","attributes":[{"label":"Release date","value":"May 1, 2015"},{"label":"Director","value":"Joss Whedon"}]},{"key":11,"title":"Ant-Man and the Wasp","group":3,"icon":"sap-icon://chain-link","attributes":[{"label":"Release date","value":"July 6, 2018"},{"label":"Director","value":"Peyton Reed"}]},{"key":12,"title":"Thor: Ragnarok","group":3,"status":"Warning","icon":"sap-icon://wrench","attributes":[{"label":"Release date","value":"November 3, 2017"},{"label":"Director","value":"Taika Waititi"}]},{"key":13,"title":"Ant-Man","group":2,"icon":"sap-icon://chain-link","attributes":[{"label":"Release date","value":"July 17, 2015"},{"label":"Director","value":"Peyton Reed"}]},{"key":14,"title":"Captain America: Civil War","group":3,"status":"Success","icon":"sap-icon://unfavorite","attributes":[{"label":"Release date","value":"May 6, 2016"},{"label":"Director","value":"Anthony & Joe Russo"}]},{"key":15,"title":"Guardians of the Galaxy","group":2,"icon":"sap-icon://shield","attributes":[{"label":"Release date","value":"August 1, 2014"},{"label":"Director","value":"James Gunn"}]},{"key":16,"title":"Spider-Man: Homecoming","group":3,"icon":"sap-icon://tree","attributes":[{"label":"Release date","value":"July 7, 2017"},{"label":"Director","value":"Jon Watts"}]},{"key":17,"title":"Black Panther","group":3,"icon":"sap-icon://circle-task-2","attributes":[{"label":"Release date","value":"February 16, 2018"},{"label":"Director","value":"Ryan Coogler"}]},{"key":18,"title":"Guardians of the Galaxy Vol. 2","icon":"sap-icon://shield","group":3,"attributes":[{"label":"Release date","value":"May 5, 2017"},{"label":"Director","value":"James Gunn"}]},{"key":19,"title":"'Avengers 4'","group":3,"status":"Error","icon":"sap-icon://text-color","attributes":[{"label":"Release date","value":"May 3, 2019"},{"label":"Director","value":"Anthony & Joe Russo"}]},{"key":20,"title":"Avengers: Infinity War","group":3,"status":"Error","icon":"sap-icon://text-color","attributes":[{"label":"Release date","value":"April 27, 2018"},{"label":"Director","value":"Anthony & Joe Russo"}]}],lines:[{"from":0,"to":1},{"from":1,"to":5},{"from":2,"to":5},{"from":3,"to":5},{"from":4,"to":5},{"from":5,"to":6},{"from":5,"to":7},{"from":5,"to":8},{"from":6,"to":10},{"from":7,"to":10},{"from":8,"to":10},{"from":9,"to":12},{"from":10,"to":12},{"from":10,"to":13},{"from":13,"to":11},{"from":10,"to":14},{"from":13,"to":14},{"from":14,"to":16},{"from":14,"to":17},{"from":12,"to":20},{"from":16,"to":20},{"from":17,"to":20},{"from":15,"to":18},{"from":18,"to":20},{"from":5,"to":19},{"from":10,"to":19},{"from":20,"to":19}]};O.checkUpdate();};t.setFormat=function(s){p=s;if(t.Grid){t.Grid.format=p;}O.checkUpdate();};t.setOffsetCol=function(n){t.virtualOffsetCol=n;return t;};t.setOffsetRow=function(n){t.virtualOffsetRow=n;return t;};var w;t.getStructureMembers=function(s){var o=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);var K=o.getDisplayKeyField();return _.map(d.arrayFromList(o.getAllStructureMembers()),function(M){return{Name:M.getFieldValue(K)?M.getFieldValue(K).getValue().getString():M.getName(),TechName:M.getName(),Description:M.getText()};});};function x(b){w=q.getQueryModel().getCurrencyTranslationManager()&&q.getQueryModel().getCurrencyTranslationManager().getCurrencyTranslationDetails();t.AllowsNewLines=false;t.Functions=[];t.HasVariables=false;t.CurrencyTranslation=w&&{Name:w.getCurrencyTranslationName(),Target:w.getCurrencyTranslationTarget()};if(t.Grid){t.Grid.inputEnabled=_.some(t.Grid.Cells,function(o){return o.Input;});t.Grid.input=t.Grid.inputEnabled&&I;t.Grid.DataChanged=O.getPlanningService()?O.getPlanningService().getPlanningContext().hasChangedData():false;if(sap.ushell&&sap.ushell.Container&&O.getPlanningService()){sap.ushell.Container.setDirtyFlag(O.getPlanningService().getPlanningContext().hasChangedData());}}u(i.getUndoManager().getAvailableUndoStepCount()>0);t.QueryTitle=q.getQueryModel().getText()||q.getQueryModel().getDataSource().getName();t.QueryName=q.getQueryModel().getDataSource().getName();t.QueryType=q.getQueryModel().getDataSource().getType().getName();t.SystemName=q.getSystemDescription().getName();t.HasVariables=q.getQueryModel().getVariableContainer().hasVariables();V=_.reduce(d.arrayFromIter(q.getQueryModel().getVariables().getIterator()),function(B,o){B[o.getNameExternal()||o.getName()]=o.getName();return B;},V);if(q.getQueryModel().getCubeInfo()){t.CreatedBy=q.getQueryModel().getCubeInfo().getCreatedBy();t.CreatedOn=(function(){var o=q.getQueryModel().getCubeInfo().getCreatedOn();return o?new Date([o.getYear(),o.getMonthOfYear(),o.getDayOfMonth()].join("-")):new Date();}());t.CreatedOnText=t.QueryDueDateText=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"}).format(t.CreatedOn);t.QueryDueDate=(function(){var o=q.getQueryModel().getCubeInfo().getDueDate();return o?new Date([o.getYear(),o.getMonthOfYear(),o.getDayOfMonth()].join("-")):new Date();}());t.QueryDueDateText=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"}).format(t.QueryDueDate);if(q.getQueryModel().getResultAlignment()){t.ResultAlignmentRows=q.getQueryModel().getResultAlignment().getName();t.ResultAlignmentColumns=q.getQueryModel().getResultAlignment().getName();}t.LastUpdated=(function(){var o=q.getQueryModel().getCubeInfo().getUpdatedOn();return o?new Date([o.getYear(),o.getMonthOfYear(),o.getDayOfMonth()].join("-")):new Date();}());t.LastUpdatedBy=q.getQueryModel().getCubeInfo().getUpdatedBy();t.LastUpdatedText=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"}).format(t.LastUpdated);}t.HasCurrencyTranslation=(function(){var o=q.getQueryModel().getModelCapabilities();return(o.supportsCurrencyTranslation()||o.supportsQueryCurrencyTranslation())&&w&&q.getQueryModel().getCurrencyTranslationEnabledType()!=="NoCurrency";}());Q=q.getQueryModel();var s=Q.getSortingManager();function n(o){if(s.supportsDimensionSorting(o,null)){return o.getResultSetSorting().getDirection().getName();}else{return null;}}t.Dimensions=_.reduce(d.arrayFromList(Q.getDimensions()),function(B,o){var E=o.getAxis();if(o.getDimensionType().getName()===D.MeasureStructure){o.getExternalName=_.constant("MeasureStructure");}else if(o.getDimensionType().getName()===D.SecondaryStructure){o.getExternalName=_.constant("NonMeasureStructure");}B[o.getExternalName()||o.getName()]={Name:o.getExternalName()||o.getName(),TechName:o.getName(),Description:o.getText(),Axis:E.getName(),Type:o.getDimensionType().getName(),HierarchyActive:o.isHierarchyActive(),HasFilter:!!o.getFilter(),SortDirection:n(o),Position:E.getDimensionIndex(o.getName()),LastPosition:E.getDimensionCount()-1,IsStructure:o.getDimensionType().getName()===D.MeasureStructure||o.getDimensionType().getName()===D.SecondaryStructure,IsMeasureStructure:o.getDimensionType().getName()===D.MeasureStructure||o.getDimensionType().getName()===D.SecondaryStructure};if(o.getDimensionType().getName()===D.MeasureStructure||o.getDimensionType().getName()===D.SecondaryStructure){var K=o.getDisplayKeyField();B[o.getExternalName()||o.getName()].Members=_.map(d.arrayFromList(o.getAllStructureMembers()),function(G){return{Name:G.getFieldValue(o.getDisplayKeyField())?G.getFieldValue(K).getValue().getString():G.getName(),TechName:G.getName(),Description:G.getText()};});}return B;},{});t.FreeDimensions=_.sortBy(_.filter(t.Dimensions,{Axis:A.Free}),"Description");t.ColumnsDimensions=_.sortBy(_.filter(t.Dimensions,{Axis:A.Columns}),"Position");t.RowsDimensions=_.sortBy(_.filter(t.Dimensions,{Axis:A.Rows}),"Postion");t.FlatDimensions=_.filter(_.concat(t.RowsDimensions,t.ColumnsDimensions),function(o){return!o.IsMeasureStructure;});t.AllDimensions=_.sortBy(_.concat(t.RowsDimensions,t.ColumnsDimensions,t.FreeDimensions),"Description");if(!t.Chart.catDimension){t.Chart.catDimension=t.FlatDimensions.length?t.FlatDimensions[0].Name:null;}if(!t.Chart.cat2Dimension){t.Chart.cat2Dimension=t.FlatDimensions.length>1?t.FlatDimensions[1].Name:null;}var M=q.getQueryModel().getMeasureDimension()?t.Dimensions[q.getQueryModel().getMeasureDimension().getExternalName()||q.getQueryModel().getMeasureDimension().getName()]:null;if(!t.Chart.valDimension&&M){t.Chart.valDimension=M.Name;}if(!t.Chart.val2Dimension&&M){t.Chart.val2Dimension=M.Name;}t.Chart.vizProperties.title.text=t.QueryTitle||t.QueryName;var z=q.getQueryModel().getMeasureDimension()&&M.Members||[];if(b){t.FlatResultSet=b.FlatResultSet;t.Chart.Measures=b.Measures;t.Chart.Dimensions=b.Dimensions;}else{t.Measures=z;}t.Conditions=_.map(q.getQueryModel().getConditionManager()?d.arrayFromList(q.getQueryModel().getConditionManager()):[],function(o){return{Name:o.getName(),Description:o.getText(),StatusText:e.getText(o.isActive()?"ACTIVE":"INACTIVE"),active:o.isActive()};});t.Exceptions=_.map(q.getQueryModel().getExceptionManager()?d.arrayFromList(q.getQueryModel().getExceptionManager()):[],function(o){return{Name:o.getName(),Description:o.getText(),StatusText:e.getText(o.isActive()?"ACTIVE":"INACTIVE"),active:o.isActive()};});(function(o){t.Chart.Feeds=o.Feeds;t.Chart.Messages=o.Messages;}(R.calculateFeeds(t.Chart.chartType,t.Chart.Dimensions||[],t.Chart.Measures||[],t.Chart)));}x();t.getInfoProviderName=function(){var o=q.getQueryModel().getInfoProvider();return o?o.getName():"";};t.getInfoProviderText=function(){var o=q.getQueryModel().getInfoProvider();return o?o.getText():"";};t.variablePrompt=function(s){var b,n;function z(o,B){b=o;n=B;}sap.firefly.VdDragonflyEntryPoint.createEntryPoint(s||t.QueryTitle,q.getOlapEnv().getVariableProcessor(),{onRenderDone:_.constant(null),onBeforeSubmit:_.constant(null),onOk:function(){var B=d.arrayFromList(q.getOlapEnv().getAllAreaQueryManager());Promise.all(_.map(B,function(o){return S.syncActionToPromise(o.processQueryExecution,o,[]);})).then(function(){b(null);}).catch(function(E){n(E);});},onCancel:function(){b(null);}}).open();return new Promise(z);};t.setInputEnabled=function(b){q.getPlanningManager().setDataEntryEnabled(b);I=b;return t;};(function(){var s=null;t.suppressUnit=function(b){s=b;};t.getSuppressedUnit=function(){return s;};}());t.openAxisDialog=function(){var o=sap.firefly.AldEntryPoint.createEntryPoint(i);var b;function n(s){b=s;}o.openAldDialog(e.getText("QUERY_SETTINGS",[t.QueryTitle]),Q,{onSubmit:function(){b(true);b=null;},onClose:function(){if(b){b(false);}}});return new Promise(n);};t.openCellDialog=function(b,M,n,z){var B=t.Dimensions[b];if(!B||!B.IsStructure){throw new Error("Dimension is not a structure:"+b);}var E=q.getQueryModel().getDimensionByName(B.TechName).getDisplayKeyField();var G=_.find(d.arrayFromList(q.getQueryModel().getDimensionByName(t.Dimensions[b].TechName).getAllStructureMembers()),function(o){var Y=o.getFieldValue(E);var s=Y?Y.getString():o.getName();return s===M;});if(!G){throw new Error("Member "+M+" not found in structure: "+b);}var H;if(n){var J=t.Dimensions[n];if(!J||!J.IsStructure){throw new Error("Dimension is not a structure:"+n);}var K=q.getQueryModel().getDimensionByName(t.Dimensions[n].TechName).getDisplayKeyField();H=_.find(d.arrayFromList(q.getQueryModel().getDimensionByName(t.Dimensions[n].TechName).getAllStructureMembers()),function(o){var Y=o.getFieldValue(K);var s=Y?Y.getString():o.getName();return s===M;});if(!H){throw new Error("Member "+z+" not found in structure: "+n);}}var N;function P(o){N=o;}var W=new Promise(P);var X=sap.firefly.DataCellDialogDragonflyEntryPoint.createEntryPoint(q);X.openDataCellPropertiesDialog({onDataCellOk:function(){var o=N;N=null;return o(true);},onDataCellClose:function(){if(N){N(false);}X.close();},getText:function(s,o){return e.getText(s,o);}},q,G.getName(),H?H.getName():null);return W;};t.openDimDialog=function(s){var E=sap.firefly.DdEntryPoint.createEntryPoint(i);var o=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);var b;E.setI18nProvider({getText:function(z){return e.getText(z.substr(5));},getTextWithPlaceholder:function(z,P){return e.getText(z.substr(5),P);}},null);function n(z){b=z;}E.openDimensionDialog(e.getText("DD_DIMENSION_SETTINGS",[o.getText()]),o,{onSubmit:function(){b(true);},onClose:function(){b(false);}});return new Promise(n);};t.setResultVisibility=function(s,b){Q.getDimensionByName(t.Dimensions[s].TechName).setResultVisibility(sap.firefly.ResultVisibility[b]);return t.getResultSet();};t.setDimensionDisplay=function(s,b){var Q=q.getQueryModel();var n=Q.getDimensionByName(t.Dimensions[s].TechName);var K=n.getDisplayKeyField()||n.getKeyField();var z=n.getTextField();var B=n.getResultSetFields();var E=_.filter(d.arrayFromList(B).map(function(o){return o;}),function(o){return o!==n.getKeyField()&&o!==n.getTextField()&&o!==n.getDisplayKeyField();});B.clear();switch(b){case a.Key:B.add(K);break;case a.Text:B.add(z);break;case a.KeyText:B.add(K);B.add(z);break;case a.TextKey:B.add(z);B.add(K);break;}_.forEach(E,function(o){B.add(o);});return t.getResultSet();};t.isVariableInputEnabled=function(s){var n=V[s];if(!n){return false;}var o=q.getQueryModel().getVariable(n);return!!o&&o.isInputEnabled&&o.isInputEnabled();};t.hasVariableValueHelp=function(s){var o=q.getQueryModel().getVariable(s);return!!o&&o.supportsValueHelp&&o.supportsValueHelp();};t.openVariableSelector=function(s){if(!O.getProperty("/variables/"+s).SupportsValueHelp){throw new Error("No Value help for variable "+s);}if(q.isReinitNeeded()){q.reInitVariablesAfterSubmit(sap.firefly.SyncType.BLOCKING,null,null);}var b=sap.firefly.FdOceanEntryPoint.createEntryPoint(i);var n=q.getQueryModel().getVariable(O.getProperty("/variables/"+s+"/TechName")).getDimension();var z=b.createConfiguration(e.getText("SELECTOR",[n.getText()]));z.setFunctionalValuesEnabled(true);var B;function E(o){B=o;}b.openWithVariable(q.getQueryModel().getVariable(O.getProperty("/variables/"+s+"/TechName")),z,{onFilterDialogOk:function(o){B(o);},onFilterDialogCancel:function(){B(null);}});var G=new Promise(E);return G.then(function(H){if(!H){return null;}return _.map(d.arrayFromList(H),function(o){return{Low:o.getKey(),ComparisonOperator:c.EQUAL,IsExcluding:false,Text:o.getText()||o.getKey()};}).map(T.rangeToToken);});};t.openCurrencyTranslationDialog=function(){var b;function n(o){b=o;}var E=sap.firefly.CtEntryPoint.createEntryPoint(i);E.setI18nProvider({getText:function(s){return e.getText(s.substr(5));},getTextWithPlaceholder:function(s,P){return e.getText(s.substr(5),[P]);}},null);E.openQCTDialog(e.getText("QCT_CURRENCY_TRANSLATION"),q.getQueryModel().getCurrencyTranslationManager(),{onSubmit:function(){b(true);b=null;},onClose:function(){if(b){b(false);}}});return new Promise(n);};t.getFilterOfDim=function(s){var b=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);return _.map(d.arrayFromList(q.getQueryModel().getFilter().getDynamicFilter().getCartesianListByField(b.getKeyField())),function(o){return{ComparisonOperator:l(o.getComparisonOperator()),Text:o.getText(),Low:o.getLow().getString(),High:o.getHigh().getString()};});};t.openSelector=function(s,b,n){var z=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);if(!Q.getFilter().getDynamicFilter().isCartesianProduct()){throw new Error("Filter to complex");}var B;function E(o){B=o;}return Promise.resolve(null).then(function(){if(t.Dimensions[s].HierarchyActive){var G=sap.firefly.FdOceanEntryPoint.createEntryPoint(i);var H=G.createConfiguration(e.getText("SELECTOR",[z.getText()]));H.setFunctionalValuesEnabled(true);G.openWithDimension(z,H,{onFilterDialogOk:function(o){B(o);},onFilterDialogCancel:function(){B(false);}});var J=new Promise(E);return J.then(function(K){if(!K){return null;}var M=d.arrayFromList(K);return _.map(M,function(o){return{Low:o.getKey(),Operator:"EQ",DescriptionLow:o.getKey()};});});}else{return k.then(function(k){return k.Selector.openSelector(O,j,s,t.getFilterOfDim(s));});}}).then(function(o){if(b){return o;}var G=n?n:[j];return Promise.all(_.map(G,function(H){return O.getDataProvider(H).applyFilterToDim(s,o);})).then(function(){return true;});});};t.applyFilterToDim=function(s,b){if(!b){return t;}var o=t.Dimensions[s];if(!o){return t;}var n=q.getQueryModel().getDimensionByName(o.TechName);sap.firefly.QFilterUtil.clearSelectionsInContainerByDimension(t.Dimensions[s].TechName,q.getQueryModel().getFilter().getDynamicFilter());var z=q.getQueryModel().getFilter().getDynamicFilter().addSingleMemberFilterByName.bind(q.getQueryModel().getFilter().getDynamicFilter());var B=q.getConvenienceCommands().addIntervallFilterByStringValues.bind(q.getConvenienceCommands(),n.getName());_.forEach(b,function(E){var G=m(E.ComparisonOperator);if(G!==c.BETWEEN){z(n.getName(),E.Low,m(E.ComparisonOperator));}else{B(E.Low,E.High);}});return t;};t.setAxesLayout=function(o){_.forEach(_.map(t.FlatDimensions,"Name"),function(s){q.getQueryModel().getAxis(sap.firefly.AxisType.FREE).add(q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));});_.forEach(o.rows,function(s){q.getQueryModel().getAxis(sap.firefly.AxisType.ROWS).add(q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));});_.forEach(o.columns,function(s){q.getQueryModel().getAxis(sap.firefly.AxisType.COLUMNS).add(q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));});return t;};t.removeDrilldown=function(s){q.getQueryModel().getAxis(sap.firefly.AxisType.FREE).add(q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));return t.getResultSet();};t.drilldown=function(s,b){var o=q.getQueryModel();if(s){var n=o.getDimensionByName(t.Dimensions[s].TechName);var z=o.getAxesManager().getRowsAxis().getDimensionCount()?n.getAxis():o.getAxesManager().getRowsAxis();var B=!z.getDimensionCount()?0:n.getDimension().getAxis().getDimensionIndex(n.getName())+1;z.insert(B,o.getDimensionByName(t.Dimensions[b].TechName));}else{o.getAxesManager().getRowsAxis().insert(o.getAxesManager().getRowsAxis().getDimensionCount(),o.getDimensionByName(t.Dimensions[b].TechName));}return t.getResultSet();};t.moveUp=function(s){var o=q.getQueryModel();var b=o.getDimensionByName(t.Dimensions[s].TechName);var n=b.getAxis();var z=n.getDimensionIndex(b.getName())-1;n.insert(z,b);return t;};t.moveDown=function(s){var o=q.getQueryModel();var b=o.getDimensionByName(t.Dimensions[s].TechName);var n=b.getAxis();var z=n.getDimensionIndex(b.getName())+1;n.insert(z,b);return t;};t.setDisplayHierarchy=function(s,b,n,o){var z=q.getQueryModel();var B=z.getDimensionByName(t.Dimensions[s].TechName);if(n){B.setHierarchyName(n);if(o){B.setHierarchyVersion(o);}}B.setHierarchyActive(b);return t;};t.getScalingFactor=function(M,b){var n=t.Dimensions.MeasureStructure;if(!n){throw new Error("No measure Structure");}var z=b?t.Dimensions.NonMeasureStructure:null;var B=n.TechName;var E=d.arrayFromList(q.getQueryModel().getDimensionByName(B).getAllStructureMembers());var G=q.getQueryModel().getDimensionByName(B).getDisplayKeyField();var H=(function(){var H=_.find(E,function(o){var P=o.getFieldValue(G);var s=P?P.getString():o.getName();return s===M;});if(!H){throw new Error("Member "+M+" not found in structure: "+B);}return H;}());if(!z){return H.getNumericShift()?-1*H.getNumericShift().getInteger():0;}else{E=d.arrayFromList(q.getQueryModel().getDimensionByName(z.TechName).getAllStructureMembers());G=q.getQueryModel().getDimensionByName(B).getDisplayKeyField();var J=(function(){var H=_.find(E,function(o){var P=o.getFieldValue(G);var s=P?P.getString():o.getName();return s===M;});if(!H){throw new Error("Member "+M+" not found in structure: "+B);}return H;}());var K=d.arrayFromIter(q.getQueryModel().getQueryDataCells().getIterator());var N=_.filter(K,function(o){return o.hasMemberReference(H)&&o.hasMemberReference(J);});if(!N){throw new Error("Invalid Query Cell");}return N.getScalingFactor();}};t.setScalingFactor=function(n,M,b){var z=t.Dimensions.MeasureStructure;if(!z){throw new Error("No measure Structure");}var B=b?t.Dimensions.NonMeasureStructure:null;var E=z.TechName;var G=d.arrayFromList(q.getQueryModel().getDimensionByName(E).getAllStructureMembers());var H=q.getQueryModel().getDimensionByName(E).getDisplayKeyField();var J=(function(){var J=_.find(G,function(o){var W=o.getFieldValue(H);var s=W?W.getString():o.getName();return s===M;});if(!J){throw new Error("Member "+M+" not found in structure: "+E);}return J;}());if(!B){J.setNumericShift(-1*n);return t;}else{G=d.arrayFromList(q.getQueryModel().getDimensionByName(B.TechName).getAllStructureMembers());H=q.getQueryModel().getDimensionByName(E).getDisplayKeyField();var K=(function(){var J=_.find(G,function(o){var W=o.getFieldValue(H);var s=W?W.getString():o.getName();return s===M;});if(!J){throw new Error("Member "+M+" not found in structure: "+E);}return J;}());var N=d.arrayFromIter(q.getQueryModel().getQueryDataCells().getIterator());var P=_.filter(N,function(o){return o.hasMemberReference(J)&&o.hasMemberReference(K);});if(!P){throw new Error("Invalid Query Cell");}return P.setScalingFactor(n);}};t.setFilter=function(b,n){var z=t.Dimensions[b];var M=[];if(typeof n==="string"){M.push(n);}else{M=n;}sap.firefly.QFilterUtil.clearSelectionsInContainerByDimension(t.Dimensions[b].TechName,q.getQueryModel().getFilter().getDynamicFilter());var B=t.Dimensions[b].TechName;var E=z.IsStructure?d.arrayFromList(q.getQueryModel().getDimensionByName(B).getAllStructureMembers()):[];var G=z.IsStructure?q.getQueryModel().getDimensionByName(B).getDisplayKeyField():null;_.forEach(M,function(H){var s=z.IsStructure?(function(){var J=_.find(E,function(o){var K=o.getFieldValue(G);var s=K?K.getString():o.getName();return s===H;});if(!J){throw new Error("Member "+H+" not found in structure: "+B);}return J.getName();}()):H;q.getQueryModel().getFilter().getDynamicFilter().addSingleMemberFilterByName(B,s,sap.firefly.ComparisonOperator.EQUAL);});return t;};t.removeFilter=function(s){sap.firefly.QFilterUtil.clearSelectionsInContainerByDimension(t.Dimensions[s].TechName,q.getQueryModel().getFilter().getDynamicFilter());return t;};t.filterAndDrillDown=function(b,M,n){var z=q.getQueryModel();var B=t.Dimensions[b];var s=B.IsStructure?_.find(B.Members,function(o){return o.Name===M;}).TechName:M;z.getFilter().getDynamicFilter().addSingleMemberFilterByName(t.Dimensions[b].TechName,s,sap.firefly.ComparisonOperator.EQUAL);var E=z.getDimensionByName(t.Dimensions[b].TechName);E.getAxis().add(z.getDimensionByName(t.Dimensions[n].TechName));z.getAxis(sap.firefly.AxisType.FREE).add(E);return t;};t.sort=function(s,b,n,M){var o=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);if(t.Dimensions[s].IsStructure){var z=q.getConvenienceCommands();z.clearSort(null,null);z.sortByMeasure(_.find(t.Dimensions[s].Members,function(B){return B.Name===M;}).TechName,sap.firefly.XSortDirection[b]);}else{o.getResultSetSorting().setDirection(sap.firefly.XSortDirection[b]);if(n){o.getResultSetSorting().setSortType(sap.firefly.SortType[n]);}}return t;};t.toRows=function(s){var o=q.getQueryModel();o.getAxis(sap.firefly.AxisType.ROWS).add(o.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));return t;};t.toColumns=function(s){var o=q.getQueryModel();o.getAxis(sap.firefly.AxisType.COLUMNS).add(o.getQueryModel().getDimensionByName(t.Dimensions[s].TechName));return t;};t.drill=function(s,n){var o=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);var b=r.getAxis(o.getAxisType()).getTupleAt(n).getTupleElementByDimension(o);b.setNextDrillState(b.getDrillState()!==sap.firefly.DrillState.COLLAPSED?sap.firefly.DrillState.COLLAPSED:sap.firefly.DrillState.EXPANDED);return t.getResultSet();};t.exchange=function(s,b){var o=q.getQueryModel();var n=o.getDimensionByName(t.Dimensions[s].TechName);var z=o.getDimensionByName(t.Dimensions[b].TechName);var B=z.getAxis();n.getAxis().insert(n.getDimension().getAxis().getDimensionIndex(t.Dimensions[s].TechName)+1,z);B.add(n);return t;};t.submitVariables=function(){return Promise.resolve(null)||S.syncActionToPromise(q.submitVariables,q,[]).then(function(b){x();if(b&&b.getMessages().length){O.addMessages(d.arrayFromList(b.getMessages()).map(function(o){var s=o.getSeverity().getName();if(s==="Info"){s="Information";}return{Text:o.getText(),Severity:s,Code:o.getCode(),MessageClass:o.getMessageClass(),LongTextUri:o.getMessageClass()?["/sap/opu/odata/iwbep/message_text;o=LOCAL/T100_longtexts(MSGID='",encodeURIComponent(o.getMessageClass()),"',MSGNO='",encodeURIComponent(o.getCode()),",',MESSAGE_V1='',MESSAGE_V2='',MESSAGE_V3='',MESSAGE_V4='')/$value"].join(""):null};}));}v(q);O.checkUpdate();}).catch(function(E){O.addMessages(E.getMessages?E.getMessages():[]);if(!E.getMessages){throw E;}t.Grid=null;O.checkUpdate();});};var y;t.setPlanValue=function(n,s){var o=t.Grid.Cells[n];var b=q.getCursorResultSet().getDataCell(o.DataColumn,o.DataRow);b.setNewValueExternal(s);if(b.getValueException()!==sap.firefly.ValueException.NULL_VALUE){o.DisplayValue=b.getString();if(s===o.DisplayValue){o.valueState="Success";}else{o.valueState="Warning";}}else{o.DisplayValue=s;o.valueState="Success";}O.checkUpdate();return t;};t.transferValue=function(){q.transferNewValues();return t;};t.getResultSet=function(K){if(!K){t.setOffsetCol(0);t.setOffsetRow(0);}if(y){i.getSession().notifyInterruptStep(y,false);}if(q.hasChangedCells()){q.transferNewValues();}q.setOffsetColumns(t.virtualOffsetCol);q.setOffsetRows(t.virtualOffsetRow);q.setMaxRows(O.getLimit().rowLimit);q.setMaxColumns(O.getLimit().colLimit);return S.syncActionToPromise(q.processQueryExecution,q,[]).then(function(b){y=sap.firefly.XInterruptStep.create();i.getSession().notifyInterruptStep(y,true);r=b.getClassicResultSet();var s=(function(){var o=sap.firefly.FioriGridFactory.createFioriGrid(r);if(t.getSuppressedUnit()){o.setSuppressUnit(t.getSuppressedUnit());}_.forEach(O.getSemanticStyles(),function(z){o.addSemanticStyle(z.member,z.semantic);});return o.exportToFireflyGrid(t.SuppressRepetition);}());t.Grid=s.convertToNative();t.Grid.format=p;t.Grid.virtualOffsetCol=t.virtualOffsetCol;t.Grid.virtualOffsetRow=t.virtualOffsetRow;if(!t.Grid.Cells||t.Grid.Cells.length===0){t.Grid.Cells=[{Column:0,Row:0,DisplayValue:e.getText("no_data"),CellType:C.EMPTY}];}t.Grid.fixedRows=s.getIntegerByKey("FixedRows");t.Grid.fixedColumns=s.getIntegerByKey("FixedColumns");var n=r.getAxis(sap.firefly.AxisType.ROWS).getTuplesCountTotal();if(n===-1){n=r.getAxis(sap.firefly.AxisType.ROWS).getTuplesCount();}t.Grid.virtualRows=n;n=r.getAxis(sap.firefly.AxisType.COLUMNS).getTuplesCountTotal();if(n===-1){n=r.getAxis(sap.firefly.AxisType.COLUMNS).getTuplesCount();}t.Grid.virtualColumns=n;x(R.flatten(r,t));if(r.getMessages().length){O.addMessages(d.arrayFromList(r.getMessages()).map(function(o){var z=o.getSeverity().getName();if(z==="Info"){z="Information";}return{Text:o.getText(),Severity:z,Code:o.getCode(),MessageClass:o.getMessageClass(),LongTextUri:o.getMessageClass()?["/sap/opu/odata/iwbep/message_text;o=LOCAL/T100_longtexts(MSGID='",encodeURIComponent(o.getMessageClass()),"',MSGNO='",encodeURIComponent(o.getCode()),",',MESSAGE_V1='',MESSAGE_V2='',MESSAGE_V3='',MESSAGE_V4='')/$value"].join(""):null};}));}O.checkUpdate();O.fireRequestCompleted({infoObject:t.Name});return t;}).catch(function(E){O.addMessages(E.getMessages?E.getMessages():[]);if(!E.getMessages){throw E;}O.checkUpdate(true);O.fireRequestFailed({});return t;});};t.getRRITargets=function(n,b){var s=q.getRriTargetManager();if(!s){return Promise.resolve([]);}s.setResultSetContext(n,b);var z,B;function E(o,G){z=o;B=G;}s.processRriTargetResolution(sap.firefly.SyncType.NON_BLOCKING,{onRriTargetResolution:function(G){if(G.hasErrors()){B(G.getMessages());}else{var H=sap.ushell?sap.ushell.Container.getService("URLParsing"):{isIntentUrl:_.constant(false)};z(_.filter(G.getData().getListFromImplementation().map(function(o){return o.getParameters().getMapFromImplementation();}),function(o){return H.isIntentUrl(o.URL)||!!o.URL.match(/#/);}).map(function(o){o.URL=o.URL.split("#")[1];return o;}));}}});return new Promise(E);};t.refreshLeaveMsg=function(){return t.getResultSet(false);};t.synchronize=function(K){O.clearMessages();return t.getResultSet(K);};t.getColumnSelection=function(n){return R.tupleToObject(r.getColumnsAxis().getTupleAt(n));};t.getRowSelection=function(n){return R.tupleToObject(r.getRowsAxis().getTupleAt(n));};t.getSelection=function(n,b){return _.assign(n>=0&&n<r.getRowsAxis().getTuplesCount()?R.tupleToObject(r.getRowsAxis().getTupleAt(n)):{},b>=0&&b<r.getColumnsAxis().getTuplesCount()?R.tupleToObject(r.getColumnsAxis().getTupleAt(b)):{});};t.setSuppressRepetition=function(b){t.SuppressRepetition=b;};t.getMemberCatalog=function(s,b){var n,o;function z(H,J){n=H;o=J;}var B=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);var E=B.getDisplayKeyField()||B.getKeyField();var G=B.getTextField()||B.getDisplayKeyField();var K=B.getKeyField();B.clearSelectorFilter();B.getSelectorFields().clear();B.getSelectorFields().add(B.getKeyField());B.getSelectorFields().add(B.getDisplayKeyField());B.getSelectorFields().add(B.getTextField()||B.getDisplayKeyField());B.setSelectorFilterOnDisplayKey(true);if(b){B.addSelectorFilterForKey(b,sap.firefly.ComparisonOperator.MATCH);B.addSelectorFilterForText(b,sap.firefly.ComparisonOperator.MATCH);}var P=new Promise(z);B.processValueHelpResultSet(sap.firefly.SyncType.NON_BLOCKING,{onValuehelpExecuted:function(H){return H.hasErrors()?o(S.reject(H)):n(H.getData());}},null);return P.then(function(H){var J=H.getClassicResultSet().getRowsAxis();var M=_.range(J.getTuplesCount()).map(function(N){var W=J.getTupleAt(N);return{key:W.getStringByField(K),displayKey:W.getStringByField(E)||W.getStringByField(K),description:W.getStringByField(G)||W.getStringByField(E)||W.getStringByField(K)};});return{catalog:M};});};t.readHierarchy=function(s,n){var b,o;function z(G,J){b=G;o=J;}var H=q.getValueHelpProvider();var B=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);var E=B.getInitialDrillLevel();B.setSelectorInitialDrillLevel(n);var P=new Promise(z);H.processValueHelp(B,sap.firefly.SyncType.NON_BLOCKING,{onValuehelpExecuted:function(G){return G.hasErrors()?o(S.reject(G.getErrors())):b(G.getData());}},null,null);return P.then(function(G){function J(N){if(!N){return{};}var M=N.getChildren();return{Name:N.getName(),Text:N.getDimensionMember().getText()||N.getDimensionMember(N.getDimension().getHierarchyDisplayKeyField()).getValue().getString(),hierNodes:M?_.map(M.getListFromImplementation(),J):null};}B.setSelectorInitialDrillLevel(E);var K=_.filter(G.getListFromImplementation(),function(N){return!N.getParentNode();});return K.length===1?J(K[0]):{Name:"$Root",Text:e.getText("ARTIFICIAL_ROOT"),hierNodes:_.map(K,J)};});};t.hasVariable=function(s){var n=V[s];if(!n){return false;}var o=q.getQueryModel().getVariable(n);return!!o&&o.isInputEnabled();};t.setVariableValue=function(s,b){var o=q.getQueryModel().getVariable(V[s]);if(!o){return t;}if(!o.isInputEnabled()){throw new Error("Variable not input enabled");}var M=o.getMemberFilter?d.arrayFromList(o.getMemberFilter()):[];if(M.length===1&&b.length===1&&M[0].getComparisonOperator().getName()===c.EQUAL&&M[0].getLow().getString()===b[0].Low){return t;}o.clear();var n=o.getMemberFilter?o.getMemberFilter():null;_.forEach(b,function(z){if(n){var B=n.addNewCartesianElement();var E=sap.firefly.XValueAccess.createWithType(o.getValueType());E.parseString(z.Low);B.getLow().setValue(E.getValue());if(z.High){E=sap.firefly.XValueAccess.createWithType(o.getValueType());E.parseString(z.High);B.getHigh().setValue(E.getValue());}B.setComparisonOperator(sap.firefly.ComparisonOperator[z.Comparison]);B.setSetSign(sap.firefly.SetSign[z.IsExcluding?"EXCLUDING":"INCLUDING"]);var K=o.getDimension().getFirstFieldByType(sap.firefly.PresentationType.KEY_NOT_COMPOUND);if(K){B.setField(K);}}else{o.setValueByStringExt(z.Low,true);}});return t;};t.deserialize=function(s){q.getQueryModel().deserializeExt(sap.firefly.QModelFormat.INA_REPOSITORY,s);};t.serialize=function(){return q.getQueryModel().serializeToContentExt(sap.firefly.QModelFormat.INA_REPOSITORY,null).getString();};t.openCreateFormulaDialog=function(s){return k.then(function(k){return k.Formular.open(O,j,s);});};t.openConditionDialog=function(){return k.then(function(k){return k.Condition;}).then(function(o){return o.open(O,j);});};t.openExceptionDialog=function(){return k.then(function(k){return k.Exception.open(O,j);});};t.openCreateRestrictionDialog=function(s,M){return k.then(function(k){return k.Restriction.open(O,j,s,M);});};t.getResultRequest=function(){return q.getResultsetContainer().getResultSetManager().getDataRequest().convertToNative();};t.getQueryView=function(){return q.getQueryModel().serializeToElement(sap.firefly.QModelFormat.INA_DATA).convertToNative();};t.getMemberDescription=function(s,M){if(t.Dimensions[s].IsStructure){return _.find(t.Dimensions[s].Members,function(o){return o.Name===M;}).Description;}else{var b=_.find(d.arrayFromList(q.getQueryModel().getDimensionByName(s).getAllDimensionMembers()),function(o){return o.getName()===M;});if(!b){L.error("Could not find measure");return"";}return b.getText();}};t.addRestriction=function(o){var b=q.getQueryModel();var n=q.getQueryModel().getMeasureDimension().addNewRestrictedMeasure(["REST_",Date.now()].join("_"),o.Description);var s=n.getFilter();s.addSingleMemberFilterByDimension(q.getQueryModel().getMeasureDimension(),_.find(t.Dimensions[o.Dimension].Members,function(M){return M.Name===o.Keyfigure;}).TechName,sap.firefly.ComparisonOperator.EQUAL);_.forEach(o.Dimensions,function(z){if(z.ConstantSelection){n.addExternalDimensionToIgnore(t.Dimensions[z.Name].TechName);}_.forEach(z.Values,function(B){s.addSingleMemberFilterByDimension(b.getDimensionByName(t.Dimensions[z.Name].TechName,B.Low,sap.firefly.ComparisonOperator[B.ComparisonOperator]),B.Low);});});if(q.getQueryModel().getFilter().getDynamicFilter().getDimensionsUsedInFilter().contains(q.getQueryModel().getMeasureDimension().getName())){q.getQueryModel().getFilter().getDynamicFilter().addSingleMemberFilterByName(q.getQueryModel().getMeasureDimension().getName(),n.getName(),sap.firefly.ComparisonOperator.EQUAL);}return t;};t.addFormula=function(s,b,P,E,n){var M=_.reduce(t.getStructureMembers(s),function(o,z){o[z.Name]=z;return o;},{});return Promise.resolve(null).then(function(){var o=q.getQueryModel().getDimensionByName(t.Dimensions[s].TechName);function z(N){var K=sap.firefly.QFactory.newFormulaConstant(q);K.setString(N.left);return K;}function B(N){var K=sap.firefly.QFactory.newFormulaFunctionWithName(q,N.operator);K.add(G(N.left));K.add(G(N.right));return K;}function G(N){switch(N.operator){case"Variable":return sap.firefly.QFactory.newFormulaMemberWithName(q,M[N.left].TechName);case"Literal":return z(N);case"+":case"-":case"*":case"/":return B(N);default:throw new Error("Inalid opertor:"+N.operator);}}var H=["CALC_",Date.now()].join("");var J=o.addNewFormulaMeasure(H,b);if(E&&E!=="DEFAULT"&&n){J.setAggregationType(sap.firefly.AggregationType[E]);J.addExceptionAggregationDimension(q.getQueryModel().getDimensionByName(t.Dimensions[n].TechName));}J.setNumericShift(0);J.setNumericScale(2);J.setNumericPrecision(31);J.setFormula(G(P));if(q.getQueryModel().getFilter().getDynamicFilter().getDimensionsUsedInFilter().contains(s)){q.getQueryModel().getFilter().getDynamicFilter().addSingleMemberFilterByName(t.Dimensions[s].TechName,H,sap.firefly.ComparisonOperator.EQUAL);}return t;});};t.addException=function(o){return Promise.resolve(null).then(function(){var s=["EXC_",Date.now()].join("");var E=q.getQueryModel().getExceptionManager().newException(s,o.Description);var b=q.getQueryModel().getDimensionByName(t.Dimensions[o.Structure1Key].TechName);var M=t.Dimensions[o.Structure1Key].Members[parseInt(o.measure1,10)];E.setMeasure(b.getStructureMember(M.TechName));var n=E.newThreshold(o.Value,sap.firefly.AlertLevel[o.alertLevel]);n.setOperator(sap.firefly.ComparisonOperator[o.operator]);E.addThreshold(n);q.getQueryModel().getExceptionManager().add(E);return t;});};t.addCondition=function(o){return Promise.resolve(null).then(function(){var s=["COND_",Date.now()].join("");var b=q.getQueryModel().getConditionManager().addNewCondition(s);b.setDescription(o.Description);b.setText(o.Description);var n=q.getQueryModel().getDimensionByName(t.Dimensions[o.Structure1Key].TechName);var E=_.find(t.Dimensions[o.Structure1Key].Members,function(M){return o.measure1===M.Name;}).TechName;if(!E){throw new Error("Invalid measure");}b.setDimensionEvaluationType(sap.firefly.ConditionDimensionEvaluationType.ALL_IN_DRILL_DOWN);var z=b.createThreshold();var B=n.getStructureMember(E);if(!B){throw new Error("Invalid measure");}z.addMeasureCoordinate(B);z.setComparisonOperator(sap.firefly.ConditionComparisonOperator[o.operator]);z.getLow().setString(o.Value);return t;});};t.setExceptionActive=function(n,b){q.getQueryModel().getExceptionManager().getByKey(n).setActive(b);return t.getResultSet();};t.setConditionActive=function(n,b){q.getQueryModel().getConditionManager().getByKey(n).setActive(b);return t.getResultSet();};t.blendWithDataProvider=function(s,o){L.info(s);L.info(o);return null;};t.exportToExcel=function(W){var s=_.reduce(_.groupBy(t.Grid.Cells,"Row"),function(o,b){_.reduce(b,function(n,z){var B=new f();B.setFormattedValue(z.DisplayValue);var E;switch(z.CellType){case C.HEADER:E=g.HEADER;break;case C.TITLE:E=g.GROUP;break;default:E=g.STANDARD;}B.setStyle(E);W.setCell(W.addCell(n),B);return n;},W.createRow(o));return o;},W.addWorksheet(t.QueryName));W.closeWorkSheet(s);return t;};};h.prototype.hasVariable=function(){};h.prototype.setAxesLayout=function(){};h.prototype.openCellDialog=function(){};h.prototype.openAxisDialog=function(){};h.prototype.openCurrencyTranslationDialog=function(){};h.prototype.openConditionDialog=function(){};h.prototype.openExceptionDialog=function(){};h.prototype.openDimDialog=function(){};h.prototype.openSelector=function(){};h.prototype.setFilter=function(){};h.prototype.removeFilter=function(){};h.prototype.filterAndDrillDown=function(){};h.prototype.sort=function(){};h.prototype.toRows=function(){};h.prototype.toColumns=function(){};h.prototype.drill=function(){};h.prototype.exchange=function(){};h.prototype.submitVariables=function(){};h.prototype.setPlanValue=function(){};h.prototype.transferValue=function(){};h.prototype.getResultSet=function(){};h.prototype.getRRITargets=function(){};h.prototype.setExceptionActive=function(){};h.prototype.addCondition=function(){};h.prototype.moveUp=function(){};h.prototype.moveDown=function(){};h.prototype.setConditionActive=function(){};h.prototype.setDisplayHierarchy=function(){};h.prototype.openCreateFormulaDialog=function(){};h.prototype.openCreateRestrictionDialog=function(){};h.prototype.applyFilterToDim=function(){};h.prototype.getFilterOfDim=function(){};h.prototype.synchronize=function(){};h.prototype.setFormat=function(){};h.prototype.getScalingFactor=function(){};h.prototype.setScalingFactor=function(){};h.prototype.suppressUnit=function(){};return h;});
