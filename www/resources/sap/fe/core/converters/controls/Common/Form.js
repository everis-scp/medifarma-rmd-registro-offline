/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["../../helpers/ConfigurableObject","../../helpers/ID","../../helpers/Key","sap/fe/core/converters/annotations/DataField","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper"],function(C,I,K,D,a,S){"use strict";var _={};var g=S.generate;var b=a.getTargetObjectPath;var c=a.getTargetEntitySetPath;var d=D.getSemanticObjectPath;var e=K.KeyHelper;var F=I.FormID;var P=C.Placement;var f=C.insertCustomElements;function o(i,t){var u=Object.keys(i);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(i);if(t)v=v.filter(function(w){return Object.getOwnPropertyDescriptor(i,w).enumerable;});u.push.apply(u,v);}return u;}function h(t){for(var i=1;i<arguments.length;i++){var u=arguments[i]!=null?arguments[i]:{};if(i%2){o(Object(u),true).forEach(function(v){j(t,v,u[v]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(u));}else{o(Object(u)).forEach(function(v){Object.defineProperty(t,v,Object.getOwnPropertyDescriptor(u,v));});}}return t;}function j(i,t,v){if(t in i){Object.defineProperty(i,t,{value:v,enumerable:true,configurable:true,writable:true});}else{i[t]=v;}return i;}var k;(function(k){k["Default"]="Default";k["Annotation"]="Annotation";})(k||(k={}));_.FormElementType=k;function l(){return{textLinesDisplay:0,textLinesEdit:4};}function m(i,t){var u=[];var v=t.getEntityTypeAnnotation(i.Target.value);var w=v.annotation;t=v.converterContext;function x(y){var z,A,B;var E=d(t,y);if(y.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&y.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&((z=y.annotations)===null||z===void 0?void 0:(A=z.UI)===null||A===void 0?void 0:(B=A.Hidden)===null||B===void 0?void 0:B.valueOf())!==true){u.push({key:e.generateKeyFromDataField(y),type:k.Annotation,annotationPath:t.getEntitySetBasedAnnotationPath(y.fullyQualifiedName)+"/",semanticObjectPath:E,formatOptions:l()});}}switch(w===null||w===void 0?void 0:w.term){case"com.sap.vocabularies.UI.v1.FieldGroup":w.Data.forEach(x);break;case"com.sap.vocabularies.UI.v1.Identification":w.forEach(x);break;case"com.sap.vocabularies.UI.v1.DataPoint":u.push({key:"DataPoint::"+(w.qualifier?w.qualifier:""),type:k.Annotation,annotationPath:t.getEntitySetBasedAnnotationPath(w.fullyQualifiedName)+"/"});break;case"com.sap.vocabularies.Communication.v1.Contact":u.push({key:"Contact::"+(w.qualifier?w.qualifier:""),type:k.Annotation,annotationPath:t.getEntitySetBasedAnnotationPath(w.fullyQualifiedName)+"/"});break;default:break;}return u;}function n(i,t){var u=t.getManifestWrapper();var v=u.getFormContainer(i.Target.value);var w={};if(v===null||v===void 0?void 0:v.fields){Object.keys(v===null||v===void 0?void 0:v.fields).forEach(function(x){w[x]={key:x,type:k.Default,template:v.fields[x].template,label:v.fields[x].label,position:v.fields[x].position||{placement:P.After},formatOptions:h({},l(),{},v.fields[x].formatOptions)};});}return w;}_.getFormElementsFromManifest=n;function p(i,t){var u;var v=t.getEntityTypeAnnotation(i.Target.value);var E;if(v.converterContext.getEntitySet()&&v.converterContext.getEntitySet()!==t.getEntitySet()){E=c(v.converterContext.getDataModelObjectPath());}else if(((u=v.converterContext.getDataModelObjectPath().targetObject)===null||u===void 0?void 0:u.containsTarget)===true){E=b(v.converterContext.getDataModelObjectPath(),false);}return{id:g([{Facet:i}]),formElements:f(m(i,t),n(i,t),{formatOptions:"overwrite"}),annotationPath:"/"+i.fullyQualifiedName,entitySet:E};}_.getFormContainer=p;function q(i,t){var u;var v=[];(u=i.Facets)===null||u===void 0?void 0:u.forEach(function(w){if(w.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return;}v.push(p(w,t));});return v;}function r(i){return i.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet";}_.isReferenceFacet=r;function s(i,t){var u,v,w;switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":var x={id:F({Facet:i}),useFormContainerLabels:true,hasFacetsNotPartOfPreview:i.Facets.some(function(z){var A,B,E;return((A=z.annotations)===null||A===void 0?void 0:(B=A.UI)===null||B===void 0?void 0:(E=B.PartOfPreview)===null||E===void 0?void 0:E.valueOf())===false;}),formContainers:q(i,t)};return x;case"com.sap.vocabularies.UI.v1.ReferenceFacet":var y={id:F({Facet:i}),useFormContainerLabels:false,hasFacetsNotPartOfPreview:((u=i.annotations)===null||u===void 0?void 0:(v=u.UI)===null||v===void 0?void 0:(w=v.PartOfPreview)===null||w===void 0?void 0:w.valueOf())===false,formContainers:[p(i,t)]};return y;default:throw new Error("Cannot create form based on ReferenceURLFacet");}}_.createFormDefinition=s;return _;},false);
