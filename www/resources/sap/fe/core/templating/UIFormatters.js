/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingExpression","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/formatters/ValueFormatter"],function(M,B,a,P,D,F,v){"use strict";var _={};var i=F.isDisabledExpression;var b=F.isNonEditableExpression;var c=F.isReadOnlyExpression;var g=D.getPathRelativeLocation;var d=D.isPathUpdatable;var e=D.getTargetEntitySetPath;var f=P.isPathExpression;var h=P.isKey;var j=P.isImmutable;var k=P.isComputed;var l=P.hasValueHelp;var m=P.getAssociatedCurrencyProperty;var n=P.getAssociatedUnitProperty;var U=a.UI;var o=B.or;var p=B.not;var q=B.isTruthy;var r=B.isConstant;var s=B.ifElse;var t=B.formatResult;var u=B.equal;var w=B.constant;var x=B.compileBinding;var y=B.annotationExpression;var z=B.and;var A=B.addTypeInformation;var C=M.getInvolvedDataModelObjects;var E=M.convertMetaModelContext;var G={"Edm.Boolean":{type:"sap.ui.model.odata.type.Boolean"},"Edm.Byte":{type:"sap.ui.model.odata.type.Byte"},"Edm.Date":{type:"sap.ui.model.odata.type.Date"},"Edm.DateTimeOffset":{constraints:{"$Precision":"precision"},type:"sap.ui.model.odata.type.DateTimeOffset"},"Edm.Decimal":{constraints:{"@Org.OData.Validation.V1.Minimum/$Decimal":"minimum","@Org.OData.Validation.V1.Minimum@Org.OData.Validation.V1.Exclusive":"minimumExclusive","@Org.OData.Validation.V1.Maximum/$Decimal":"maximum","@Org.OData.Validation.V1.Maximum@Org.OData.Validation.V1.Exclusive":"maximumExclusive","$Precision":"precision","$Scale":"scale"},type:"sap.ui.model.odata.type.Decimal"},"Edm.Double":{type:"sap.ui.model.odata.type.Double"},"Edm.Guid":{type:"sap.ui.model.odata.type.Guid"},"Edm.Int16":{type:"sap.ui.model.odata.type.Int16"},"Edm.Int32":{type:"sap.ui.model.odata.type.Int32"},"Edm.Int64":{type:"sap.ui.model.odata.type.Int64"},"Edm.SByte":{type:"sap.ui.model.odata.type.SByte"},"Edm.Single":{type:"sap.ui.model.odata.type.Single"},"Edm.Stream":{type:"sap.ui.model.odata.type.Stream"},"Edm.String":{constraints:{"@com.sap.vocabularies.Common.v1.IsDigitSequence":"isDigitSequence","$MaxLength":"maxLength","$Nullable":"nullable"},type:"sap.ui.model.odata.type.String"},"Edm.TimeOfDay":{constraints:{"$Precision":"precision"},type:"sap.ui.model.odata.type.TimeOfDay"}};_.EDM_TYPE_MAPPING=G;var H=function(Y){var Z=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var $=arguments.length>2?arguments[2]:undefined;var a1=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(!Y||typeof Y==="string"){return x(false);}var b1=true;if(Z!==null){b1=s(b(Z),false,U.IsEditable);}var c1=f(Y)&&Y.$target||Y;var d1=d($,Y);var e1=s(o(p(d1),k(c1),h(c1),j(c1),b(c1)),s(o(k(c1),b(c1)),false,U.IsTransientBinding),U.IsEditable);if(a1){return z(e1,b1);}return x(z(e1,b1));};_.getEditableExpression=H;var I=function(Y,Z){var $=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!Y||typeof Y==="string"){return x(true);}var a1=true;if(Z!==null){a1=s(i(Z),false,true);}var b1=f(Y)&&Y.$target||Y;var c1=s(i(b1),false,true);if($){return z(c1,a1);}return x(z(c1,a1));};_.getEnabledExpression=I;var J=function(Y,Z){var $=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a1=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var b1=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;if(!Y||typeof Y==="string"){return"Display";}var c1=f(Y)&&Y.$target||Y;var d1=H(Y,b1,Z,true);var e1=I(Y,b1,true);var f1=m(c1);var g1=f1||n(c1);var h1="Editable";if(g1){h1=s(o(c(g1),k(g1),$),"EditableReadOnly","Editable");}var i1=o(c(c1),c(b1));var j1=s(e1,s(d1,h1,s(z(!r(i1)&&i1,U.IsEditable),"ReadOnly","Display")),s(U.IsEditable,"Disabled","Display"));if(a1){return j1;}return x(j1);};_.getEditMode=J;var K=function(Y){var Z,$,a1,b1;var c1=Y.targetObject;var d1=(Z=c1.annotations)===null||Z===void 0?void 0:($=Z.Measures)===null||$===void 0?void 0:$.ISOCurrency;var e1=d1?d1:(a1=c1.annotations)===null||a1===void 0?void 0:(b1=a1.Measures)===null||b1===void 0?void 0:b1.Unit;if(e1){return x(o(q(y(e1)),p(U.IsTotal)));}else{return x(w(true));}};_.hasValidAnalyticalCurrencyOrUnit=K;var L=function(Y,Z,$){var a1=f(Y)&&Y.$target||Y;var b1=m(a1)||n(a1);if(!b1){return x($);}var c1=z(p(c(b1)),p(k(b1)));return x(s(c1,Z,$));};_.ifUnitEditable=L;var N=function(Y,Z){var $,a1,b1,c1,d1,e1,f1,g1;if(!Y||typeof Y==="string"){return"Value";}var h1=f(Y)&&Y.$target||Y;var i1=Z&&Z.targetEntityType;var j1=($=h1.annotations)===null||$===void 0?void 0:(a1=$.Common)===null||a1===void 0?void 0:a1.Text;var k1=typeof j1!=="string"&&(j1===null||j1===void 0?void 0:(b1=j1.annotations)===null||b1===void 0?void 0:(c1=b1.UI)===null||c1===void 0?void 0:(d1=c1.TextArrangement)===null||d1===void 0?void 0:d1.toString())||(i1===null||i1===void 0?void 0:(e1=i1.annotations)===null||e1===void 0?void 0:(f1=e1.UI)===null||f1===void 0?void 0:(g1=f1.TextArrangement)===null||g1===void 0?void 0:g1.toString());var l1=j1?"DescriptionValue":"Value";if(j1&&k1){if(k1==="UI.TextArrangementType/TextOnly"){l1="Description";}else if(k1==="UI.TextArrangementType/TextLast"){l1="ValueDescription";}else if(k1==="UI.TextArrangementType/TextSeparate"){l1="Value";}else{l1="DescriptionValue";}}return l1;};_.getDisplayMode=N;var O=function(Y,Z,$){var a1=f(Y)&&Y.$target||Y;return l(a1)?x(Z):x(s(u($,"Editable"),"Value",Z));};_.getFieldDisplay=O;var Q=function(Y,Z){var $=Z;if(Y._type==="Property"){var a1=G[Y.type];if(a1){var b1,c1;$.type=a1.type;if(a1.constraints){var d1,e1,f1,g1;$.constraints={};if(a1.constraints.$Scale&&Y.scale!==undefined){$.constraints.scale=Y.scale;}if(a1.constraints.$Precision&&Y.precision!==undefined){$.constraints.precision=Y.precision;}if(a1.constraints.$MaxLength&&Y.maxLength!==undefined){$.constraints.maxLength=Y.maxLength;}if(a1.constraints.$Nullable&&Y.nullable===false){$.constraints.nullable=Y.nullable;}if(a1.constraints["@Org.OData.Validation.V1.Minimum/$Decimal"]&&((d1=Y.annotations)===null||d1===void 0?void 0:(e1=d1.Validation)===null||e1===void 0?void 0:e1.Minimum)!==undefined&&!isNaN(Y.annotations.Validation.Minimum)){$.constraints.minimum="".concat(Y.annotations.Validation.Minimum);}if(a1.constraints["@Org.OData.Validation.V1.Maximum/$Decimal"]&&((f1=Y.annotations)===null||f1===void 0?void 0:(g1=f1.Validation)===null||g1===void 0?void 0:g1.Maximum)!==undefined&&!isNaN(Y.annotations.Validation.Maximum)){$.constraints.maximum="".concat(Y.annotations.Validation.Maximum);}}if(($===null||$===void 0?void 0:(b1=$.type)===null||b1===void 0?void 0:b1.indexOf("sap.ui.model.odata.type.Int"))===0){if(!$.formatOptions){$.formatOptions={};}$.formatOptions=Object.assign($.formatOptions,{parseAsString:false,emptyString:""});}if($.type==="sap.ui.model.odata.type.String"){var h1,i1,j1;if(!$.formatOptions){$.formatOptions={};}$.formatOptions.parseKeepsEmptyString=true;if(((h1=a1.constraints)===null||h1===void 0?void 0:h1["@com.sap.vocabularies.Common.v1.IsDigitSequence"])&&((i1=Y.annotations)===null||i1===void 0?void 0:(j1=i1.Common)===null||j1===void 0?void 0:j1.IsDigitSequence)){$.constraints.isDigitSequence=true;}}if(($===null||$===void 0?void 0:(c1=$.type)===null||c1===void 0?void 0:c1.indexOf("sap.ui.model.odata.type.Double"))===0){if(!$.formatOptions){$.formatOptions={};}$.formatOptions=Object.assign($.formatOptions,{parseAsString:false,emptyString:""});}}}return $;};_.formatWithTypeInformation=Q;var R=function(Y,Z){var $,a1,b1,c1,d1;var e1=Y.targetObject;var f1=($=e1.annotations)===null||$===void 0?void 0:(a1=$.Measures)===null||a1===void 0?void 0:a1.Unit;var g1=g(Y.contextLocation,Y.navigationProperties).map(function(np){return np.name;});Z=Q(e1,Z);if(((b1=f1)===null||b1===void 0?void 0:b1.toString())==="%"){return t([Z],v.formatWithPercentage);}var h1=f1?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";f1=f1?f1:(c1=e1.annotations)===null||c1===void 0?void 0:(d1=c1.Measures)===null||d1===void 0?void 0:d1.ISOCurrency;var i1=f1.$target?Q(f1.$target,y(f1,g1)):y(f1,g1);return A([Z,i1],h1);};_.getBindingWithUnitOrCurrency=R;var S=function(Y){var Z=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";var $=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return x(s(u(Y,"Display"),Z,$));};_.getAlignmentExpression=S;var T=function(Y,Z){if(Z&&Z.context){return E(Z.context);}return null;};T.requiresIContext=true;_.getConverterContext=T;var V=function(Y,Z){if(Z&&Z.context){return C(Z.context);}return null;};V.requiresIContext=true;_.getDataModelObjectPath=V;var W=function(Y){return x(Y);};_.getExpressionBinding=W;var X=function(Y){if(Y){var Z=C(Y);return e(Z);}return null;};_.getTargetEntitySet=X;return _;},false);
